<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Learn pandas | Bowen&#39;s Academic Home</title>
    <link>https://bowenei.gitee.io/learn/pandas/</link>
      <atom:link href="https://bowenei.gitee.io/learn/pandas/index.xml" rel="self" type="application/rss+xml" />
    <description>Learn pandas</description>
    <generator>Wowchemy (https://wowchemy.com)</generator><language>en-us</language><lastBuildDate>Sun, 24 Jan 2021 00:00:00 +0000</lastBuildDate>
    <image>
      <url>https://bowenei.gitee.io/media/icon_huc813daf5dbf7d2b27f0daba22fe1e0fb_68056_512x512_fill_lanczos_center_3.png</url>
      <title>Learn pandas</title>
      <link>https://bowenei.gitee.io/learn/pandas/</link>
    </image>
    
    <item>
      <title>pandas Series 对象</title>
      <link>https://bowenei.gitee.io/learn/pandas/series/</link>
      <pubDate>Fri, 18 Feb 2022 15:01:52 +0800</pubDate>
      <guid>https://bowenei.gitee.io/learn/pandas/series/</guid>
      <description>&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;import pandas as pd
import numpy as np
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;code&gt;Series&lt;/code&gt; 是一个带标签的一维数组，能够保存任何数据类型（整数、字符串、浮点数、Python 对象等）。轴 &lt;code&gt;axis&lt;/code&gt; 标签统称为索引 &lt;code&gt;index&lt;/code&gt;。&lt;/p&gt;
&lt;h2 id=&#34;创建-series-对象&#34;&gt;创建 Series 对象&lt;/h2&gt;
&lt;p&gt;创建 &lt;code&gt;Serires&lt;/code&gt; 对象需要提供 &lt;code&gt;data&lt;/code&gt; 和 &lt;code&gt;index&lt;/code&gt; 两个参数。其中 &lt;code&gt;index&lt;/code&gt; 是需要传入的索引，即轴标签列表。因此，根据数据类型可以分为如下几种情况：&lt;/p&gt;
&lt;h3 id=&#34;ndarray&#34;&gt;ndarray&lt;/h3&gt;
&lt;p&gt;如果 &lt;code&gt;data&lt;/code&gt; 是 &lt;code&gt;ndarray&lt;/code&gt;，则 &lt;code&gt;index&lt;/code&gt; 必须与 &lt;code&gt;data&lt;/code&gt; 的长度相同。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;pd.Series(np.random.randn(5), index=[&#39;a&#39;, &#39;b&#39;, &#39;c&#39;, &#39;d&#39;, &#39;e&#39;])
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;a   -0.840342
b    1.301792
c   -0.542978
d   -0.057463
e   -2.716027
dtype: float64
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;如果没有传递索引，则将创建一个具有值 &lt;code&gt;[0, ..., len(data) - 1]&lt;/code&gt; 的索引。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;pd.Series(np.random.randn(5))
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;0   -0.237221
1   -0.126770
2    0.737682
3   -0.093711
4   -0.632866
dtype: float64
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;dict&#34;&gt;dict&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;pd.Series({&#39;b&#39;: 1, &#39;a&#39;: 0, &#39;c&#39;: 2})
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;b    1
a    0
c    2
dtype: int64
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;标量值&#34;&gt;标量值&lt;/h3&gt;
&lt;p&gt;如果数据是标量值，则必须提供索引。该值将重复以匹配索引的长度。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;pd.Series(5.0, index=[&#39;a&#39;, &#39;b&#39;, &#39;c&#39;, &#39;d&#39;, &#39;e&#39;])
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;a    5.0
b    5.0
c    5.0
d    5.0
e    5.0
dtype: float64
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;series-类似-ndarray&#34;&gt;Series 类似 ndarray&lt;/h2&gt;
&lt;p&gt;&lt;code&gt;Series&lt;/code&gt; 的行为与 &lt;code&gt;ndarray&lt;/code&gt; 非常相似，并且是大多数 &lt;strong&gt;NumPy&lt;/strong&gt; 函数的有效参数。&lt;/p&gt;
&lt;h3 id=&#34;索引和切片&#34;&gt;索引和切片&lt;/h3&gt;
&lt;p&gt;注意：切片等操作也会对索引进行切片。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;s = pd.Series(np.random.randn(5), index=[&amp;quot;a&amp;quot;, &amp;quot;b&amp;quot;, &amp;quot;c&amp;quot;, &amp;quot;d&amp;quot;, &amp;quot;e&amp;quot;])
s
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;a   -0.669858
b   -0.669152
c   -0.228237
d   -2.224927
e    0.038875
dtype: float64
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;s[0]
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;-0.6698575320970594
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;s[:3]
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;a   -0.669858
b   -0.669152
c   -0.228237
dtype: float64
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;矩阵索引&#34;&gt;矩阵索引&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;s[s &amp;gt; s.median()]
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;c   -0.228237
e    0.038875
dtype: float64
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;s[[4, 3, 1]]
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;e    0.038875
d   -2.224927
b   -0.669152
dtype: float64
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;数学运算&#34;&gt;数学运算&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;np.exp(s)
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;a    0.511781
b    0.512143
c    0.795935
d    0.108075
e    1.039641
dtype: float64
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;ndarry-属性&#34;&gt;ndarry 属性&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;s.array
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;PandasArray&amp;gt;
[ -0.6698575320970594,  -0.6691515909398379, -0.22823732871328664,
   -2.224927424376556,  0.03887527676649628]
Length: 5, dtype: float64
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;s.dtype
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;dtype(&#39;float64&#39;)
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;强制类型转换&#34;&gt;强制类型转换&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;s.to_numpy()
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;array([-0.66985753, -0.66915159, -0.22823733, -2.22492742,  0.03887528])
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;series-类似-dict&#34;&gt;Series 类似 dict&lt;/h2&gt;
&lt;p&gt;&lt;code&gt;Series&lt;/code&gt; 就像一个固定大小的 &lt;code&gt;dict&lt;/code&gt;，可以通过索引标签获取和设置值：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;s[&#39;a&#39;]
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;-0.6698575320970594
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;s[&#39;e&#39;] = 12.0
s
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;a    -0.669858
b    -0.669152
c    -0.228237
d    -2.224927
e    12.000000
dtype: float64
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;&#39;e&#39; in s, &#39;f&#39; in s
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;(True, False)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;如果未包含标签，会抛出异常：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;try:
    s[&#39;f&#39;]
except KeyError:
    print(&#39;KeyError&#39;)
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;KeyError
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;使用 &lt;code&gt;get&lt;/code&gt; 方法，缺少的标签将返回 &lt;code&gt;None&lt;/code&gt; 或指定的默认值：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;s.get(&#39;f&#39;)
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;s.get(&#39;f&#39;, np.nan)
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;nan
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;向量化操作和标签对齐&#34;&gt;向量化操作和标签对齐&lt;/h2&gt;
&lt;p&gt;使用原始 &lt;strong&gt;NumPy&lt;/strong&gt; 数组时，通常不需要逐个值循环。在 &lt;strong&gt;pandas&lt;/strong&gt; 中使用 &lt;code&gt;Series&lt;/code&gt; 时也是如此。&lt;code&gt;Series&lt;/code&gt; 也可以传递给大多数需要 &lt;code&gt;ndarray&lt;/code&gt; 的 &lt;strong&gt;NumPy&lt;/strong&gt; 方法。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;s + s
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;a    -1.339715
b    -1.338303
c    -0.456475
d    -4.449855
e    24.000000
dtype: float64
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;s * 2
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;a    -1.339715
b    -1.338303
c    -0.456475
d    -4.449855
e    24.000000
dtype: float64
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;code&gt;Series&lt;/code&gt; 和 &lt;code&gt;ndarray&lt;/code&gt; 之间的一个关键区别是 &lt;code&gt;Series&lt;/code&gt; 之间的操作会根据标签自动对齐数据。因此，您可以编写计算而不考虑所涉及的系列是否具有相同的标签。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;s[1:] + s[:-1]
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;a         NaN
b   -1.338303
c   -0.456475
d   -4.449855
e         NaN
dtype: float64
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;未对齐系列之间的操作结果将包含所涉及的索引的并集。如果在一个系列或另一个系列中找不到标签，则结果将被标记为缺失 &lt;code&gt;NaN&lt;/code&gt;。&lt;/p&gt;
&lt;h2 id=&#34;name-属性&#34;&gt;name 属性&lt;/h2&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;s = pd.Series(np.random.randn(5), name=&amp;quot;something&amp;quot;)
s
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;0    0.042130
1    0.067907
2   -1.121646
3   -1.390116
4   -0.990718
Name: something, dtype: float64
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;s.name
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;&#39;something&#39;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;在许多情况下，&lt;code&gt;Series&lt;/code&gt; 名称将自动分配，特别是在获取 &lt;code&gt;DataFrame&lt;/code&gt; 的一维切片时。详见 &lt;code&gt;DataFrame&lt;/code&gt; 章节。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;s2 = s.rename(&#39;different&#39;)
s2.name
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;&#39;different&#39;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;请注意，&lt;code&gt;s&lt;/code&gt; 和 &lt;code&gt;s2&lt;/code&gt; 指的是不同的对象。&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>pandas Dataframe 对象</title>
      <link>https://bowenei.gitee.io/learn/pandas/dataframe/</link>
      <pubDate>Fri, 18 Feb 2022 16:41:59 +0800</pubDate>
      <guid>https://bowenei.gitee.io/learn/pandas/dataframe/</guid>
      <description>&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;import pandas as pd
import numpy as np
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;code&gt;DataFrame&lt;/code&gt; 是一种二维标记数据结构，具有可能不同类型的列。您可以将其视为电子表格或 SQL 表，或 &lt;code&gt;Series&lt;/code&gt; 对象的字典。它通常是最常用的 &lt;strong&gt;pandas&lt;/strong&gt; 对象。&lt;/p&gt;
&lt;p&gt;除了数据，您还可以选择传递索引（行标签）和列（列标签）参数。如果您传递索引和/或列，则保证结果 &lt;code&gt;DataFrame&lt;/code&gt; 的索引和/或列。因此，&lt;code&gt;Series&lt;/code&gt; 的字典加上特定的索引将丢弃所有与传递的索引不匹配的数据。&lt;/p&gt;
&lt;h2 id=&#34;创建-dataframe-对象&#34;&gt;创建 DataFrame 对象&lt;/h2&gt;
&lt;p&gt;与 &lt;code&gt;Series&lt;/code&gt; 一样，&lt;code&gt;DataFrame&lt;/code&gt; 接受许多不同类型的输入：&lt;/p&gt;
&lt;h3 id=&#34;以-series-或-dict-为值的-dict&#34;&gt;以 Series 或 dict 为值的 dict&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;d = {
    &#39;one&#39;: pd.Series([1.0, 2.0, 3.0], index=[&#39;a&#39;, &#39;b&#39;, &#39;c&#39;]),
    &#39;two&#39;: pd.Series([1.0, 2.0, 3.0, 4.0], index=[&#39;a&#39;, &#39;b&#39;, &#39;c&#39;, &#39;d&#39;]),
}
df = pd.DataFrame(d)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;结果索引将是各种系列的索引的并集。如果有任何嵌套的 &lt;code&gt;dict&lt;/code&gt;，这些将首先转换为 &lt;code&gt;Series&lt;/code&gt;。如果未传递任何列，则这些列将是 &lt;code&gt;dict&lt;/code&gt; 键的有序列表。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;df
&lt;/code&gt;&lt;/pre&gt;
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/style&gt;&lt;/p&gt;
&lt;table border=&#34;1&#34; class=&#34;dataframe&#34;&gt;
  &lt;thead&gt;
    &lt;tr style=&#34;text-align: right;&#34;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;one&lt;/th&gt;
      &lt;th&gt;two&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;a&lt;/th&gt;
      &lt;td&gt;1.0&lt;/td&gt;
      &lt;td&gt;1.0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;b&lt;/th&gt;
      &lt;td&gt;2.0&lt;/td&gt;
      &lt;td&gt;2.0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;c&lt;/th&gt;
      &lt;td&gt;3.0&lt;/td&gt;
      &lt;td&gt;3.0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;d&lt;/th&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;4.0&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;pd.DataFrame(d, index=[&#39;d&#39;, &#39;b&#39;, &#39;a&#39;])
&lt;/code&gt;&lt;/pre&gt;
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/style&gt;&lt;/p&gt;
&lt;table border=&#34;1&#34; class=&#34;dataframe&#34;&gt;
  &lt;thead&gt;
    &lt;tr style=&#34;text-align: right;&#34;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;one&lt;/th&gt;
      &lt;th&gt;two&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;d&lt;/th&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;4.0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;b&lt;/th&gt;
      &lt;td&gt;2.0&lt;/td&gt;
      &lt;td&gt;2.0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;a&lt;/th&gt;
      &lt;td&gt;1.0&lt;/td&gt;
      &lt;td&gt;1.0&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;pd.DataFrame(d, index=[&#39;d&#39;, &#39;b&#39;, &#39;a&#39;], columns=[&#39;two&#39;, &#39;three&#39;])
&lt;/code&gt;&lt;/pre&gt;
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/style&gt;&lt;/p&gt;
&lt;table border=&#34;1&#34; class=&#34;dataframe&#34;&gt;
  &lt;thead&gt;
    &lt;tr style=&#34;text-align: right;&#34;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;two&lt;/th&gt;
      &lt;th&gt;three&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;d&lt;/th&gt;
      &lt;td&gt;4.0&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;b&lt;/th&gt;
      &lt;td&gt;2.0&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;a&lt;/th&gt;
      &lt;td&gt;1.0&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;h3 id=&#34;以-list-或-ndarray-为值的-dict&#34;&gt;以 list 或 ndarray 为值的 dict&lt;/h3&gt;
&lt;p&gt;&lt;code&gt;ndarrays&lt;/code&gt; 必须都是相同的长度。如果传递了索引，它显然也必须与数组的长度相同。如果没有传递索引，则结果将是 &lt;code&gt;range(n)&lt;/code&gt;，其中 &lt;code&gt;n&lt;/code&gt; 是数组长度。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;d = {
    &#39;one&#39;: [1.0, 2.0, 3.0, 4.0],
    &#39;two&#39;: [4.0, 3.0, 2.0, 1.0],
}
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;pd.DataFrame(d)
&lt;/code&gt;&lt;/pre&gt;
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/style&gt;&lt;/p&gt;
&lt;table border=&#34;1&#34; class=&#34;dataframe&#34;&gt;
  &lt;thead&gt;
    &lt;tr style=&#34;text-align: right;&#34;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;one&lt;/th&gt;
      &lt;th&gt;two&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;td&gt;1.0&lt;/td&gt;
      &lt;td&gt;4.0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1&lt;/th&gt;
      &lt;td&gt;2.0&lt;/td&gt;
      &lt;td&gt;3.0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2&lt;/th&gt;
      &lt;td&gt;3.0&lt;/td&gt;
      &lt;td&gt;2.0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;3&lt;/th&gt;
      &lt;td&gt;4.0&lt;/td&gt;
      &lt;td&gt;1.0&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;pd.DataFrame(d, index=[&#39;a&#39;, &#39;b&#39;, &#39;c&#39;, &#39;d&#39;])
&lt;/code&gt;&lt;/pre&gt;
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/style&gt;&lt;/p&gt;
&lt;table border=&#34;1&#34; class=&#34;dataframe&#34;&gt;
  &lt;thead&gt;
    &lt;tr style=&#34;text-align: right;&#34;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;one&lt;/th&gt;
      &lt;th&gt;two&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;a&lt;/th&gt;
      &lt;td&gt;1.0&lt;/td&gt;
      &lt;td&gt;4.0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;b&lt;/th&gt;
      &lt;td&gt;2.0&lt;/td&gt;
      &lt;td&gt;3.0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;c&lt;/th&gt;
      &lt;td&gt;3.0&lt;/td&gt;
      &lt;td&gt;2.0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;d&lt;/th&gt;
      &lt;td&gt;4.0&lt;/td&gt;
      &lt;td&gt;1.0&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;h3 id=&#34;结构化或记录数组&#34;&gt;结构化或记录数组&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;data = np.zeros((2,), dtype=[(&amp;quot;A&amp;quot;, &amp;quot;i4&amp;quot;), (&amp;quot;B&amp;quot;, &amp;quot;f4&amp;quot;), (&amp;quot;C&amp;quot;, &amp;quot;a10&amp;quot;)])
data
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;array([(0, 0., b&#39;&#39;), (0, 0., b&#39;&#39;)],
      dtype=[(&#39;A&#39;, &#39;&amp;lt;i4&#39;), (&#39;B&#39;, &#39;&amp;lt;f4&#39;), (&#39;C&#39;, &#39;S10&#39;)])
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;data[:] = [
    (1, 2.0, &#39;Hello&#39;),
    (2, 3.0, &#39;World&#39;),
]
data
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;array([(1, 2., b&#39;Hello&#39;), (2, 3., b&#39;World&#39;)],
      dtype=[(&#39;A&#39;, &#39;&amp;lt;i4&#39;), (&#39;B&#39;, &#39;&amp;lt;f4&#39;), (&#39;C&#39;, &#39;S10&#39;)])
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;pd.DataFrame(data)
&lt;/code&gt;&lt;/pre&gt;
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/style&gt;&lt;/p&gt;
&lt;table border=&#34;1&#34; class=&#34;dataframe&#34;&gt;
  &lt;thead&gt;
    &lt;tr style=&#34;text-align: right;&#34;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;A&lt;/th&gt;
      &lt;th&gt;B&lt;/th&gt;
      &lt;th&gt;C&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;2.0&lt;/td&gt;
      &lt;td&gt;b&#39;Hello&#39;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1&lt;/th&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;3.0&lt;/td&gt;
      &lt;td&gt;b&#39;World&#39;&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;pd.DataFrame(data, index=[&#39;first&#39;, &#39;second&#39;])
&lt;/code&gt;&lt;/pre&gt;
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/style&gt;&lt;/p&gt;
&lt;table border=&#34;1&#34; class=&#34;dataframe&#34;&gt;
  &lt;thead&gt;
    &lt;tr style=&#34;text-align: right;&#34;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;A&lt;/th&gt;
      &lt;th&gt;B&lt;/th&gt;
      &lt;th&gt;C&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;first&lt;/th&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;2.0&lt;/td&gt;
      &lt;td&gt;b&#39;Hello&#39;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;second&lt;/th&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;3.0&lt;/td&gt;
      &lt;td&gt;b&#39;World&#39;&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;pd.DataFrame(data, columns=[&#39;C&#39;, &#39;A&#39;, &#39;B&#39;])
&lt;/code&gt;&lt;/pre&gt;
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/style&gt;&lt;/p&gt;
&lt;table border=&#34;1&#34; class=&#34;dataframe&#34;&gt;
  &lt;thead&gt;
    &lt;tr style=&#34;text-align: right;&#34;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;C&lt;/th&gt;
      &lt;th&gt;A&lt;/th&gt;
      &lt;th&gt;B&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;td&gt;b&#39;Hello&#39;&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;2.0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1&lt;/th&gt;
      &lt;td&gt;b&#39;World&#39;&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;3.0&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;h3 id=&#34;由-dict-组成的-list&#34;&gt;由 dict 组成的 list&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;data2 = [
    {&#39;a&#39;: 1, &#39;b&#39;: 2},
    {&#39;a&#39;: 5, &#39;b&#39;: 10, &#39;c&#39;: 20},
]
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;pd.DataFrame(data2)
&lt;/code&gt;&lt;/pre&gt;
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/style&gt;&lt;/p&gt;
&lt;table border=&#34;1&#34; class=&#34;dataframe&#34;&gt;
  &lt;thead&gt;
    &lt;tr style=&#34;text-align: right;&#34;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;a&lt;/th&gt;
      &lt;th&gt;b&lt;/th&gt;
      &lt;th&gt;c&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1&lt;/th&gt;
      &lt;td&gt;5&lt;/td&gt;
      &lt;td&gt;10&lt;/td&gt;
      &lt;td&gt;20.0&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;pd.DataFrame(data2, index=[&#39;first&#39;, &#39;second&#39;])
&lt;/code&gt;&lt;/pre&gt;
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/style&gt;&lt;/p&gt;
&lt;table border=&#34;1&#34; class=&#34;dataframe&#34;&gt;
  &lt;thead&gt;
    &lt;tr style=&#34;text-align: right;&#34;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;a&lt;/th&gt;
      &lt;th&gt;b&lt;/th&gt;
      &lt;th&gt;c&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;first&lt;/th&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;second&lt;/th&gt;
      &lt;td&gt;5&lt;/td&gt;
      &lt;td&gt;10&lt;/td&gt;
      &lt;td&gt;20.0&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;pd.DataFrame(data2, columns=[&#39;a&#39;, &#39;b&#39;])
&lt;/code&gt;&lt;/pre&gt;
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/style&gt;&lt;/p&gt;
&lt;table border=&#34;1&#34; class=&#34;dataframe&#34;&gt;
  &lt;thead&gt;
    &lt;tr style=&#34;text-align: right;&#34;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;a&lt;/th&gt;
      &lt;th&gt;b&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1&lt;/th&gt;
      &lt;td&gt;5&lt;/td&gt;
      &lt;td&gt;10&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;h3 id=&#34;以-tuple-为键的-dict&#34;&gt;以 tuple 为键的 dict&lt;/h3&gt;
&lt;p&gt;这样创建出的 &lt;code&gt;DataFrame&lt;/code&gt; 具有多重索引框架。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;df2 = pd.DataFrame(
    {
        (&#39;a&#39;, &#39;b&#39;): {(&#39;A&#39;, &#39;B&#39;): 1, (&#39;A&#39;, &#39;C&#39;): 2},
        (&#39;a&#39;, &#39;a&#39;): {(&#39;A&#39;, &#39;C&#39;): 3, (&#39;A&#39;, &#39;B&#39;): 4},
        (&#39;a&#39;, &#39;c&#39;): {(&#39;A&#39;, &#39;B&#39;): 5, (&#39;A&#39;, &#39;C&#39;): 6},
        (&#39;b&#39;, &#39;a&#39;): {(&#39;A&#39;, &#39;C&#39;): 7, (&#39;A&#39;, &#39;B&#39;): 8},
        (&#39;b&#39;, &#39;b&#39;): {(&#39;A&#39;, &#39;D&#39;): 9, (&#39;A&#39;, &#39;B&#39;): 10},
    }
)
df2
&lt;/code&gt;&lt;/pre&gt;
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead tr th {
    text-align: left;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/style&gt;&lt;/p&gt;
&lt;table border=&#34;1&#34; class=&#34;dataframe&#34;&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th colspan=&#34;3&#34; halign=&#34;left&#34;&gt;a&lt;/th&gt;
      &lt;th colspan=&#34;2&#34; halign=&#34;left&#34;&gt;b&lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;b&lt;/th&gt;
      &lt;th&gt;a&lt;/th&gt;
      &lt;th&gt;c&lt;/th&gt;
      &lt;th&gt;a&lt;/th&gt;
      &lt;th&gt;b&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th rowspan=&#34;3&#34; valign=&#34;top&#34;&gt;A&lt;/th&gt;
      &lt;th&gt;B&lt;/th&gt;
      &lt;td&gt;1.0&lt;/td&gt;
      &lt;td&gt;4.0&lt;/td&gt;
      &lt;td&gt;5.0&lt;/td&gt;
      &lt;td&gt;8.0&lt;/td&gt;
      &lt;td&gt;10.0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;C&lt;/th&gt;
      &lt;td&gt;2.0&lt;/td&gt;
      &lt;td&gt;3.0&lt;/td&gt;
      &lt;td&gt;6.0&lt;/td&gt;
      &lt;td&gt;7.0&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;D&lt;/th&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;9.0&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;p&gt;索引 &lt;code&gt;&#39;a&#39;&lt;/code&gt; 和 &lt;code&gt;&#39;b&#39;&lt;/code&gt; 返回的还是 DataFrame 对象，它是嵌套在 &lt;code&gt;df2&lt;/code&gt; 里面的。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;df2[&#39;a&#39;]
&lt;/code&gt;&lt;/pre&gt;
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/style&gt;&lt;/p&gt;
&lt;table border=&#34;1&#34; class=&#34;dataframe&#34;&gt;
  &lt;thead&gt;
    &lt;tr style=&#34;text-align: right;&#34;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;b&lt;/th&gt;
      &lt;th&gt;a&lt;/th&gt;
      &lt;th&gt;c&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th rowspan=&#34;3&#34; valign=&#34;top&#34;&gt;A&lt;/th&gt;
      &lt;th&gt;B&lt;/th&gt;
      &lt;td&gt;1.0&lt;/td&gt;
      &lt;td&gt;4.0&lt;/td&gt;
      &lt;td&gt;5.0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;C&lt;/th&gt;
      &lt;td&gt;2.0&lt;/td&gt;
      &lt;td&gt;3.0&lt;/td&gt;
      &lt;td&gt;6.0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;D&lt;/th&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;df2[&#39;b&#39;]
&lt;/code&gt;&lt;/pre&gt;
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/style&gt;&lt;/p&gt;
&lt;table border=&#34;1&#34; class=&#34;dataframe&#34;&gt;
  &lt;thead&gt;
    &lt;tr style=&#34;text-align: right;&#34;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;a&lt;/th&gt;
      &lt;th&gt;b&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th rowspan=&#34;3&#34; valign=&#34;top&#34;&gt;A&lt;/th&gt;
      &lt;th&gt;B&lt;/th&gt;
      &lt;td&gt;8.0&lt;/td&gt;
      &lt;td&gt;10.0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;C&lt;/th&gt;
      &lt;td&gt;7.0&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;D&lt;/th&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;9.0&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;h3 id=&#34;namedtuple-序列&#34;&gt;namedtuple 序列&lt;/h3&gt;
&lt;p&gt;&lt;code&gt;namedtuple&lt;/code&gt; 的字段名称决定了 &lt;code&gt;DataFrame&lt;/code&gt; 的列。剩下的命名元组（或元组）被简单地解包，它们的值被输入到 &lt;code&gt;DataFrame&lt;/code&gt; 的行中。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from collections import namedtuple
Point = namedtuple(&#39;Point&#39;, &#39;x y&#39;)
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;pd.DataFrame([Point(0, 0), Point(0, 3), Point(2, 3)])
&lt;/code&gt;&lt;/pre&gt;
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/style&gt;&lt;/p&gt;
&lt;table border=&#34;1&#34; class=&#34;dataframe&#34;&gt;
  &lt;thead&gt;
    &lt;tr style=&#34;text-align: right;&#34;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;x&lt;/th&gt;
      &lt;th&gt;y&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1&lt;/th&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;3&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2&lt;/th&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;3&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;p&gt;如果这些元组中的任何一个比第一个 &lt;code&gt;namedtuple&lt;/code&gt; 短，则相应行中后面的列被标记为缺失值。如果有任何比第一个命名元组长，则会引发 ValueError。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;Point3D = namedtuple(&#39;Point3D&#39;, &#39;x y z&#39;)
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;pd.DataFrame([Point3D(0, 0, 0), Point3D(0, 3, 5), Point(2, 3)])
&lt;/code&gt;&lt;/pre&gt;
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/style&gt;&lt;/p&gt;
&lt;table border=&#34;1&#34; class=&#34;dataframe&#34;&gt;
  &lt;thead&gt;
    &lt;tr style=&#34;text-align: right;&#34;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;x&lt;/th&gt;
      &lt;th&gt;y&lt;/th&gt;
      &lt;th&gt;z&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0.0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1&lt;/th&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;3&lt;/td&gt;
      &lt;td&gt;5.0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2&lt;/th&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;3&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;h3 id=&#34;dataclass-序列&#34;&gt;dataclass 序列&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from dataclasses import make_dataclass
Point = make_dataclass(&#39;Point&#39;, [(&#39;x&#39;, int), (&#39;y&#39;, int)])
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;pd.DataFrame([Point(0, 0), Point(0, 3), Point(2, 3)])
&lt;/code&gt;&lt;/pre&gt;
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/style&gt;&lt;/p&gt;
&lt;table border=&#34;1&#34; class=&#34;dataframe&#34;&gt;
  &lt;thead&gt;
    &lt;tr style=&#34;text-align: right;&#34;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;x&lt;/th&gt;
      &lt;th&gt;y&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1&lt;/th&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;3&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2&lt;/th&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;3&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;h3 id=&#34;备用构造函数&#34;&gt;备用构造函数&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;pd.DataFrame.from_dict(dict([(&amp;quot;A&amp;quot;, [1, 2, 3]), (&amp;quot;B&amp;quot;, [4, 5, 6])]))
&lt;/code&gt;&lt;/pre&gt;
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/style&gt;&lt;/p&gt;
&lt;table border=&#34;1&#34; class=&#34;dataframe&#34;&gt;
  &lt;thead&gt;
    &lt;tr style=&#34;text-align: right;&#34;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;A&lt;/th&gt;
      &lt;th&gt;B&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;4&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1&lt;/th&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;5&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2&lt;/th&gt;
      &lt;td&gt;3&lt;/td&gt;
      &lt;td&gt;6&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;p&gt;如果参数 &lt;code&gt;orient=&#39;index&#39;&lt;/code&gt;，键将是行标签。在这种情况下，您还可以传递所需的列名：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;pd.DataFrame.from_dict(dict([(&amp;quot;A&amp;quot;, [1, 2, 3]), (&amp;quot;B&amp;quot;, [4, 5, 6])]))
&lt;/code&gt;&lt;/pre&gt;
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/style&gt;&lt;/p&gt;
&lt;table border=&#34;1&#34; class=&#34;dataframe&#34;&gt;
  &lt;thead&gt;
    &lt;tr style=&#34;text-align: right;&#34;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;A&lt;/th&gt;
      &lt;th&gt;B&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;4&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1&lt;/th&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;5&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2&lt;/th&gt;
      &lt;td&gt;3&lt;/td&gt;
      &lt;td&gt;6&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;data
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;array([(1, 2., b&#39;Hello&#39;), (2, 3., b&#39;World&#39;)],
      dtype=[(&#39;A&#39;, &#39;&amp;lt;i4&#39;), (&#39;B&#39;, &#39;&amp;lt;f4&#39;), (&#39;C&#39;, &#39;S10&#39;)])
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;pd.DataFrame.from_records(data, index=&#39;C&#39;)
&lt;/code&gt;&lt;/pre&gt;
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/style&gt;&lt;/p&gt;
&lt;table border=&#34;1&#34; class=&#34;dataframe&#34;&gt;
  &lt;thead&gt;
    &lt;tr style=&#34;text-align: right;&#34;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;A&lt;/th&gt;
      &lt;th&gt;B&lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;C&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;b&#39;Hello&#39;&lt;/th&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;2.0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;b&#39;World&#39;&lt;/th&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;3.0&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;h2 id=&#34;dataframe-对象的属性&#34;&gt;DataFrame 对象的属性&lt;/h2&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;df.index
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;Index([&#39;a&#39;, &#39;b&#39;, &#39;c&#39;, &#39;d&#39;], dtype=&#39;object&#39;)
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;df.columns
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;Index([&#39;one&#39;, &#39;two&#39;], dtype=&#39;object&#39;)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;类似 &lt;strong&gt;NumPy&lt;/strong&gt; &lt;code&gt;ndarray&lt;/code&gt;，可以对 &lt;code&gt;DataFrame&lt;/code&gt; 对象进行转置：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;df.T
&lt;/code&gt;&lt;/pre&gt;
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/style&gt;&lt;/p&gt;
&lt;table border=&#34;1&#34; class=&#34;dataframe&#34;&gt;
  &lt;thead&gt;
    &lt;tr style=&#34;text-align: right;&#34;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;a&lt;/th&gt;
      &lt;th&gt;b&lt;/th&gt;
      &lt;th&gt;c&lt;/th&gt;
      &lt;th&gt;d&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;one&lt;/th&gt;
      &lt;td&gt;1.0&lt;/td&gt;
      &lt;td&gt;2.0&lt;/td&gt;
      &lt;td&gt;3.0&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;two&lt;/th&gt;
      &lt;td&gt;1.0&lt;/td&gt;
      &lt;td&gt;2.0&lt;/td&gt;
      &lt;td&gt;3.0&lt;/td&gt;
      &lt;td&gt;4.0&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;p&gt;注意：&lt;code&gt;DataFrame&lt;/code&gt; 并非完全像二维 &lt;strong&gt;NumPy&lt;/strong&gt; &lt;code&gt;ndarray&lt;/code&gt; 那样工作。&lt;/p&gt;
&lt;h2 id=&#34;dataframe-列操作&#34;&gt;DataFrame 列操作&lt;/h2&gt;
&lt;p&gt;可以在语义上认为 &lt;code&gt;DataFrame&lt;/code&gt; 对象是索引 &lt;code&gt;Series&lt;/code&gt; 对象的字典。因此，对 &lt;code&gt;DataFrame&lt;/code&gt; 对象进行列操作和对 &lt;code&gt;dict&lt;/code&gt; 对象进行增删改查等操作类似。&lt;/p&gt;
&lt;h3 id=&#34;选择&#34;&gt;选择&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;df[&#39;one&#39;]
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;a    1.0
b    2.0
c    3.0
d    NaN
Name: one, dtype: float64
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;运算&#34;&gt;运算&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;df[&#39;three&#39;] = df[&#39;one&#39;] * df[&#39;two&#39;]
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;df[&#39;flag&#39;] = df[&#39;one&#39;] &amp;gt; 2
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;df
&lt;/code&gt;&lt;/pre&gt;
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/style&gt;&lt;/p&gt;
&lt;table border=&#34;1&#34; class=&#34;dataframe&#34;&gt;
  &lt;thead&gt;
    &lt;tr style=&#34;text-align: right;&#34;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;one&lt;/th&gt;
      &lt;th&gt;two&lt;/th&gt;
      &lt;th&gt;three&lt;/th&gt;
      &lt;th&gt;flag&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;a&lt;/th&gt;
      &lt;td&gt;1.0&lt;/td&gt;
      &lt;td&gt;1.0&lt;/td&gt;
      &lt;td&gt;1.0&lt;/td&gt;
      &lt;td&gt;False&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;b&lt;/th&gt;
      &lt;td&gt;2.0&lt;/td&gt;
      &lt;td&gt;2.0&lt;/td&gt;
      &lt;td&gt;4.0&lt;/td&gt;
      &lt;td&gt;False&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;c&lt;/th&gt;
      &lt;td&gt;3.0&lt;/td&gt;
      &lt;td&gt;3.0&lt;/td&gt;
      &lt;td&gt;9.0&lt;/td&gt;
      &lt;td&gt;True&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;d&lt;/th&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;4.0&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;False&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;h3 id=&#34;删除&#34;&gt;删除&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;del df[&#39;two&#39;]
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;three = df.pop(&#39;three&#39;)
three
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;a    1.0
b    4.0
c    9.0
d    NaN
Name: three, dtype: float64
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;df
&lt;/code&gt;&lt;/pre&gt;
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/style&gt;&lt;/p&gt;
&lt;table border=&#34;1&#34; class=&#34;dataframe&#34;&gt;
  &lt;thead&gt;
    &lt;tr style=&#34;text-align: right;&#34;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;one&lt;/th&gt;
      &lt;th&gt;flag&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;a&lt;/th&gt;
      &lt;td&gt;1.0&lt;/td&gt;
      &lt;td&gt;False&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;b&lt;/th&gt;
      &lt;td&gt;2.0&lt;/td&gt;
      &lt;td&gt;False&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;c&lt;/th&gt;
      &lt;td&gt;3.0&lt;/td&gt;
      &lt;td&gt;True&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;d&lt;/th&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;False&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;h3 id=&#34;插入&#34;&gt;插入&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;df[&#39;foo&#39;] = &#39;bar&#39;
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;df
&lt;/code&gt;&lt;/pre&gt;
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/style&gt;&lt;/p&gt;
&lt;table border=&#34;1&#34; class=&#34;dataframe&#34;&gt;
  &lt;thead&gt;
    &lt;tr style=&#34;text-align: right;&#34;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;one&lt;/th&gt;
      &lt;th&gt;flag&lt;/th&gt;
      &lt;th&gt;foo&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;a&lt;/th&gt;
      &lt;td&gt;1.0&lt;/td&gt;
      &lt;td&gt;False&lt;/td&gt;
      &lt;td&gt;bar&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;b&lt;/th&gt;
      &lt;td&gt;2.0&lt;/td&gt;
      &lt;td&gt;False&lt;/td&gt;
      &lt;td&gt;bar&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;c&lt;/th&gt;
      &lt;td&gt;3.0&lt;/td&gt;
      &lt;td&gt;True&lt;/td&gt;
      &lt;td&gt;bar&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;d&lt;/th&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;False&lt;/td&gt;
      &lt;td&gt;bar&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;p&gt;当插入一个与 &lt;code&gt;DataFrame&lt;/code&gt; 没有相同索引的 &lt;code&gt;Series&lt;/code&gt; 时，它将符合 &lt;code&gt;DataFrame&lt;/code&gt; 的索引：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;df[&amp;quot;one_trunc&amp;quot;] = df[&amp;quot;one&amp;quot;][:2]
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;df
&lt;/code&gt;&lt;/pre&gt;
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/style&gt;&lt;/p&gt;
&lt;table border=&#34;1&#34; class=&#34;dataframe&#34;&gt;
  &lt;thead&gt;
    &lt;tr style=&#34;text-align: right;&#34;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;one&lt;/th&gt;
      &lt;th&gt;flag&lt;/th&gt;
      &lt;th&gt;foo&lt;/th&gt;
      &lt;th&gt;one_trunc&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;a&lt;/th&gt;
      &lt;td&gt;1.0&lt;/td&gt;
      &lt;td&gt;False&lt;/td&gt;
      &lt;td&gt;bar&lt;/td&gt;
      &lt;td&gt;1.0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;b&lt;/th&gt;
      &lt;td&gt;2.0&lt;/td&gt;
      &lt;td&gt;False&lt;/td&gt;
      &lt;td&gt;bar&lt;/td&gt;
      &lt;td&gt;2.0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;c&lt;/th&gt;
      &lt;td&gt;3.0&lt;/td&gt;
      &lt;td&gt;True&lt;/td&gt;
      &lt;td&gt;bar&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;d&lt;/th&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;False&lt;/td&gt;
      &lt;td&gt;bar&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;p&gt;默认情况下，列在最后插入。插入函数可用于在列中的特定位置插入：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;df.insert(1, &amp;quot;bar&amp;quot;, df[&amp;quot;one&amp;quot;])
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;df
&lt;/code&gt;&lt;/pre&gt;
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/style&gt;&lt;/p&gt;
&lt;table border=&#34;1&#34; class=&#34;dataframe&#34;&gt;
  &lt;thead&gt;
    &lt;tr style=&#34;text-align: right;&#34;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;one&lt;/th&gt;
      &lt;th&gt;bar&lt;/th&gt;
      &lt;th&gt;flag&lt;/th&gt;
      &lt;th&gt;foo&lt;/th&gt;
      &lt;th&gt;one_trunc&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;a&lt;/th&gt;
      &lt;td&gt;1.0&lt;/td&gt;
      &lt;td&gt;1.0&lt;/td&gt;
      &lt;td&gt;False&lt;/td&gt;
      &lt;td&gt;bar&lt;/td&gt;
      &lt;td&gt;1.0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;b&lt;/th&gt;
      &lt;td&gt;2.0&lt;/td&gt;
      &lt;td&gt;2.0&lt;/td&gt;
      &lt;td&gt;False&lt;/td&gt;
      &lt;td&gt;bar&lt;/td&gt;
      &lt;td&gt;2.0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;c&lt;/th&gt;
      &lt;td&gt;3.0&lt;/td&gt;
      &lt;td&gt;3.0&lt;/td&gt;
      &lt;td&gt;True&lt;/td&gt;
      &lt;td&gt;bar&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;d&lt;/th&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;False&lt;/td&gt;
      &lt;td&gt;bar&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;</description>
    </item>
    
    <item>
      <title>pandas 索引和选择</title>
      <link>https://bowenei.gitee.io/learn/pandas/indexing-selection/</link>
      <pubDate>Sat, 19 Feb 2022 11:14:00 +0800</pubDate>
      <guid>https://bowenei.gitee.io/learn/pandas/indexing-selection/</guid>
      <description>&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;import pandas as pd
import numpy as np
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;概述&#34;&gt;概述&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;pandas&lt;/strong&gt; 索引和选择的操作主要是以下五种：&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;操作&lt;/th&gt;
&lt;th&gt;语法&lt;/th&gt;
&lt;th&gt;Result&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;选择列&lt;/td&gt;
&lt;td&gt;&lt;code&gt;df[col]&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;Series&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;通过标签选择行&lt;/td&gt;
&lt;td&gt;&lt;code&gt;df.loc[label]&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;Series&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;通过整数下标选择行&lt;/td&gt;
&lt;td&gt;&lt;code&gt;df.iloc[loc]&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;Series&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;行切片&lt;/td&gt;
&lt;td&gt;&lt;code&gt;df[5:10]&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;DataFrame&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;通过布尔向量切片&lt;/td&gt;
&lt;td&gt;&lt;code&gt;df[bool_vec]&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;DataFrame&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;df = pd.DataFrame(np.random.randn(4, 5), index=[&#39;a&#39;, &#39;b&#39;, &#39;c&#39;, &#39;d&#39;], columns=[&#39;A&#39;, &#39;B&#39;, &#39;C&#39;, &#39;D&#39;, &#39;E&#39;])
df
&lt;/code&gt;&lt;/pre&gt;
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/style&gt;&lt;/p&gt;
&lt;table border=&#34;1&#34; class=&#34;dataframe&#34;&gt;
  &lt;thead&gt;
    &lt;tr style=&#34;text-align: right;&#34;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;A&lt;/th&gt;
      &lt;th&gt;B&lt;/th&gt;
      &lt;th&gt;C&lt;/th&gt;
      &lt;th&gt;D&lt;/th&gt;
      &lt;th&gt;E&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;a&lt;/th&gt;
      &lt;td&gt;2.251822&lt;/td&gt;
      &lt;td&gt;0.508078&lt;/td&gt;
      &lt;td&gt;0.296828&lt;/td&gt;
      &lt;td&gt;-1.223630&lt;/td&gt;
      &lt;td&gt;0.523225&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;b&lt;/th&gt;
      &lt;td&gt;1.169537&lt;/td&gt;
      &lt;td&gt;1.378697&lt;/td&gt;
      &lt;td&gt;0.956192&lt;/td&gt;
      &lt;td&gt;-0.761983&lt;/td&gt;
      &lt;td&gt;1.206156&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;c&lt;/th&gt;
      &lt;td&gt;-1.071012&lt;/td&gt;
      &lt;td&gt;0.117104&lt;/td&gt;
      &lt;td&gt;-1.068820&lt;/td&gt;
      &lt;td&gt;0.443776&lt;/td&gt;
      &lt;td&gt;-1.185699&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;d&lt;/th&gt;
      &lt;td&gt;0.276478&lt;/td&gt;
      &lt;td&gt;0.013506&lt;/td&gt;
      &lt;td&gt;-0.207837&lt;/td&gt;
      &lt;td&gt;-0.295314&lt;/td&gt;
      &lt;td&gt;0.402572&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;df[&#39;B&#39;]
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;a    0.508078
b    1.378697
c    0.117104
d    0.013506
Name: B, dtype: float64
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;df[[&#39;B&#39;, &#39;C&#39;]]
&lt;/code&gt;&lt;/pre&gt;
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/style&gt;&lt;/p&gt;
&lt;table border=&#34;1&#34; class=&#34;dataframe&#34;&gt;
  &lt;thead&gt;
    &lt;tr style=&#34;text-align: right;&#34;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;B&lt;/th&gt;
      &lt;th&gt;C&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;a&lt;/th&gt;
      &lt;td&gt;0.508078&lt;/td&gt;
      &lt;td&gt;0.296828&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;b&lt;/th&gt;
      &lt;td&gt;1.378697&lt;/td&gt;
      &lt;td&gt;0.956192&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;c&lt;/th&gt;
      &lt;td&gt;0.117104&lt;/td&gt;
      &lt;td&gt;-1.068820&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;d&lt;/th&gt;
      &lt;td&gt;0.013506&lt;/td&gt;
      &lt;td&gt;-0.207837&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;df.loc[&#39;d&#39;]
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;A    0.276478
B    0.013506
C   -0.207837
D   -0.295314
E    0.402572
Name: d, dtype: float64
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;df.iloc[0]
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;A    2.251822
B    0.508078
C    0.296828
D   -1.223630
E    0.523225
Name: a, dtype: float64
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;df[:-1]
&lt;/code&gt;&lt;/pre&gt;
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/style&gt;&lt;/p&gt;
&lt;table border=&#34;1&#34; class=&#34;dataframe&#34;&gt;
  &lt;thead&gt;
    &lt;tr style=&#34;text-align: right;&#34;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;A&lt;/th&gt;
      &lt;th&gt;B&lt;/th&gt;
      &lt;th&gt;C&lt;/th&gt;
      &lt;th&gt;D&lt;/th&gt;
      &lt;th&gt;E&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;a&lt;/th&gt;
      &lt;td&gt;2.251822&lt;/td&gt;
      &lt;td&gt;0.508078&lt;/td&gt;
      &lt;td&gt;0.296828&lt;/td&gt;
      &lt;td&gt;-1.223630&lt;/td&gt;
      &lt;td&gt;0.523225&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;b&lt;/th&gt;
      &lt;td&gt;1.169537&lt;/td&gt;
      &lt;td&gt;1.378697&lt;/td&gt;
      &lt;td&gt;0.956192&lt;/td&gt;
      &lt;td&gt;-0.761983&lt;/td&gt;
      &lt;td&gt;1.206156&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;c&lt;/th&gt;
      &lt;td&gt;-1.071012&lt;/td&gt;
      &lt;td&gt;0.117104&lt;/td&gt;
      &lt;td&gt;-1.068820&lt;/td&gt;
      &lt;td&gt;0.443776&lt;/td&gt;
      &lt;td&gt;-1.185699&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;df[:2] &amp;gt; 0
&lt;/code&gt;&lt;/pre&gt;
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/style&gt;&lt;/p&gt;
&lt;table border=&#34;1&#34; class=&#34;dataframe&#34;&gt;
  &lt;thead&gt;
    &lt;tr style=&#34;text-align: right;&#34;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;A&lt;/th&gt;
      &lt;th&gt;B&lt;/th&gt;
      &lt;th&gt;C&lt;/th&gt;
      &lt;th&gt;D&lt;/th&gt;
      &lt;th&gt;E&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;a&lt;/th&gt;
      &lt;td&gt;True&lt;/td&gt;
      &lt;td&gt;True&lt;/td&gt;
      &lt;td&gt;True&lt;/td&gt;
      &lt;td&gt;False&lt;/td&gt;
      &lt;td&gt;True&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;b&lt;/th&gt;
      &lt;td&gt;True&lt;/td&gt;
      &lt;td&gt;True&lt;/td&gt;
      &lt;td&gt;True&lt;/td&gt;
      &lt;td&gt;False&lt;/td&gt;
      &lt;td&gt;True&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;df[df &amp;lt; 0] = 0
df
&lt;/code&gt;&lt;/pre&gt;
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/style&gt;&lt;/p&gt;
&lt;table border=&#34;1&#34; class=&#34;dataframe&#34;&gt;
  &lt;thead&gt;
    &lt;tr style=&#34;text-align: right;&#34;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;A&lt;/th&gt;
      &lt;th&gt;B&lt;/th&gt;
      &lt;th&gt;C&lt;/th&gt;
      &lt;th&gt;D&lt;/th&gt;
      &lt;th&gt;E&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;a&lt;/th&gt;
      &lt;td&gt;2.251822&lt;/td&gt;
      &lt;td&gt;0.508078&lt;/td&gt;
      &lt;td&gt;0.296828&lt;/td&gt;
      &lt;td&gt;0.000000&lt;/td&gt;
      &lt;td&gt;0.523225&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;b&lt;/th&gt;
      &lt;td&gt;1.169537&lt;/td&gt;
      &lt;td&gt;1.378697&lt;/td&gt;
      &lt;td&gt;0.956192&lt;/td&gt;
      &lt;td&gt;0.000000&lt;/td&gt;
      &lt;td&gt;1.206156&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;c&lt;/th&gt;
      &lt;td&gt;0.000000&lt;/td&gt;
      &lt;td&gt;0.117104&lt;/td&gt;
      &lt;td&gt;0.000000&lt;/td&gt;
      &lt;td&gt;0.443776&lt;/td&gt;
      &lt;td&gt;0.000000&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;d&lt;/th&gt;
      &lt;td&gt;0.276478&lt;/td&gt;
      &lt;td&gt;0.013506&lt;/td&gt;
      &lt;td&gt;0.000000&lt;/td&gt;
      &lt;td&gt;0.000000&lt;/td&gt;
      &lt;td&gt;0.402572&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;h2 id=&#34;使用--进行索引&#34;&gt;使用 [] 进行索引&lt;/h2&gt;
&lt;p&gt;使用 &lt;code&gt;[]&lt;/code&gt; 进行索引，实际上就是选择低维切片。对于 Series 对象和 DataFrame 对象，&lt;code&gt;[]&lt;/code&gt; 返回的类型不同。&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;对象类型&lt;/th&gt;
&lt;th&gt;调用方法&lt;/th&gt;
&lt;th&gt;返回值类型&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;Series&lt;/td&gt;
&lt;td&gt;&lt;code&gt;series[label]&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;标量值&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;DataFrame&lt;/td&gt;
&lt;td&gt;&lt;code&gt;frame[colname]&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;对应 &lt;code&gt;colname&lt;/code&gt; 的 &lt;code&gt;Series&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;dates = pd.date_range(&#39;1/1/2000&#39;, periods=8)
df = pd.DataFrame(np.random.randn(8, 4),
                  index=dates, columns=[&#39;A&#39;, &#39;B&#39;, &#39;C&#39;, &#39;D&#39;])
df
&lt;/code&gt;&lt;/pre&gt;
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/style&gt;&lt;/p&gt;
&lt;table border=&#34;1&#34; class=&#34;dataframe&#34;&gt;
  &lt;thead&gt;
    &lt;tr style=&#34;text-align: right;&#34;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;A&lt;/th&gt;
      &lt;th&gt;B&lt;/th&gt;
      &lt;th&gt;C&lt;/th&gt;
      &lt;th&gt;D&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;2000-01-01&lt;/th&gt;
      &lt;td&gt;-0.245083&lt;/td&gt;
      &lt;td&gt;-1.422116&lt;/td&gt;
      &lt;td&gt;0.607832&lt;/td&gt;
      &lt;td&gt;1.303857&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2000-01-02&lt;/th&gt;
      &lt;td&gt;0.596950&lt;/td&gt;
      &lt;td&gt;-0.232929&lt;/td&gt;
      &lt;td&gt;-1.116721&lt;/td&gt;
      &lt;td&gt;-1.387045&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2000-01-03&lt;/th&gt;
      &lt;td&gt;-0.096937&lt;/td&gt;
      &lt;td&gt;-1.016238&lt;/td&gt;
      &lt;td&gt;0.547761&lt;/td&gt;
      &lt;td&gt;-0.629623&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2000-01-04&lt;/th&gt;
      &lt;td&gt;-0.538159&lt;/td&gt;
      &lt;td&gt;1.512869&lt;/td&gt;
      &lt;td&gt;0.694778&lt;/td&gt;
      &lt;td&gt;0.561185&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2000-01-05&lt;/th&gt;
      &lt;td&gt;-1.338459&lt;/td&gt;
      &lt;td&gt;1.352126&lt;/td&gt;
      &lt;td&gt;1.203392&lt;/td&gt;
      &lt;td&gt;-0.431008&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2000-01-06&lt;/th&gt;
      &lt;td&gt;-0.525117&lt;/td&gt;
      &lt;td&gt;0.735395&lt;/td&gt;
      &lt;td&gt;0.562011&lt;/td&gt;
      &lt;td&gt;-0.133187&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2000-01-07&lt;/th&gt;
      &lt;td&gt;-0.076509&lt;/td&gt;
      &lt;td&gt;0.542937&lt;/td&gt;
      &lt;td&gt;0.047262&lt;/td&gt;
      &lt;td&gt;0.512984&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2000-01-08&lt;/th&gt;
      &lt;td&gt;-1.047306&lt;/td&gt;
      &lt;td&gt;0.812662&lt;/td&gt;
      &lt;td&gt;1.716307&lt;/td&gt;
      &lt;td&gt;-0.060350&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;s = df[&#39;A&#39;]
s
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;2000-01-01   -0.245083
2000-01-02    0.596950
2000-01-03   -0.096937
2000-01-04   -0.538159
2000-01-05   -1.338459
2000-01-06   -0.525117
2000-01-07   -0.076509
2000-01-08   -1.047306
Freq: D, Name: A, dtype: float64
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;s[dates[5]]
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;-0.5251169095699432
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;交换 &lt;code&gt;A&lt;/code&gt; 和 &lt;code&gt;B&lt;/code&gt; 两列：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;df[[&#39;B&#39;, &#39;A&#39;]] = df[[&#39;A&#39;, &#39;B&#39;]]
df
&lt;/code&gt;&lt;/pre&gt;
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/style&gt;&lt;/p&gt;
&lt;table border=&#34;1&#34; class=&#34;dataframe&#34;&gt;
  &lt;thead&gt;
    &lt;tr style=&#34;text-align: right;&#34;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;A&lt;/th&gt;
      &lt;th&gt;B&lt;/th&gt;
      &lt;th&gt;C&lt;/th&gt;
      &lt;th&gt;D&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;2000-01-01&lt;/th&gt;
      &lt;td&gt;-1.422116&lt;/td&gt;
      &lt;td&gt;-0.245083&lt;/td&gt;
      &lt;td&gt;0.607832&lt;/td&gt;
      &lt;td&gt;1.303857&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2000-01-02&lt;/th&gt;
      &lt;td&gt;-0.232929&lt;/td&gt;
      &lt;td&gt;0.596950&lt;/td&gt;
      &lt;td&gt;-1.116721&lt;/td&gt;
      &lt;td&gt;-1.387045&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2000-01-03&lt;/th&gt;
      &lt;td&gt;-1.016238&lt;/td&gt;
      &lt;td&gt;-0.096937&lt;/td&gt;
      &lt;td&gt;0.547761&lt;/td&gt;
      &lt;td&gt;-0.629623&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2000-01-04&lt;/th&gt;
      &lt;td&gt;1.512869&lt;/td&gt;
      &lt;td&gt;-0.538159&lt;/td&gt;
      &lt;td&gt;0.694778&lt;/td&gt;
      &lt;td&gt;0.561185&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2000-01-05&lt;/th&gt;
      &lt;td&gt;1.352126&lt;/td&gt;
      &lt;td&gt;-1.338459&lt;/td&gt;
      &lt;td&gt;1.203392&lt;/td&gt;
      &lt;td&gt;-0.431008&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2000-01-06&lt;/th&gt;
      &lt;td&gt;0.735395&lt;/td&gt;
      &lt;td&gt;-0.525117&lt;/td&gt;
      &lt;td&gt;0.562011&lt;/td&gt;
      &lt;td&gt;-0.133187&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2000-01-07&lt;/th&gt;
      &lt;td&gt;0.542937&lt;/td&gt;
      &lt;td&gt;-0.076509&lt;/td&gt;
      &lt;td&gt;0.047262&lt;/td&gt;
      &lt;td&gt;0.512984&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2000-01-08&lt;/th&gt;
      &lt;td&gt;0.812662&lt;/td&gt;
      &lt;td&gt;-1.047306&lt;/td&gt;
      &lt;td&gt;1.716307&lt;/td&gt;
      &lt;td&gt;-0.060350&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;p&gt;注意，如果使用了 &lt;code&gt;loc&lt;/code&gt; 或者 &lt;code&gt;iloc&lt;/code&gt;，&lt;strong&gt;pandas&lt;/strong&gt; 会先对齐所有 &lt;code&gt;axes&lt;/code&gt;。这不会修改 &lt;code&gt;df&lt;/code&gt;，因为列对齐在赋值之前。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;df.loc[:, [&#39;B&#39;, &#39;A&#39;]] = df[[&#39;A&#39;, &#39;B&#39;]]
df
&lt;/code&gt;&lt;/pre&gt;
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/style&gt;&lt;/p&gt;
&lt;table border=&#34;1&#34; class=&#34;dataframe&#34;&gt;
  &lt;thead&gt;
    &lt;tr style=&#34;text-align: right;&#34;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;A&lt;/th&gt;
      &lt;th&gt;B&lt;/th&gt;
      &lt;th&gt;C&lt;/th&gt;
      &lt;th&gt;D&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;2000-01-01&lt;/th&gt;
      &lt;td&gt;-1.422116&lt;/td&gt;
      &lt;td&gt;-0.245083&lt;/td&gt;
      &lt;td&gt;0.607832&lt;/td&gt;
      &lt;td&gt;1.303857&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2000-01-02&lt;/th&gt;
      &lt;td&gt;-0.232929&lt;/td&gt;
      &lt;td&gt;0.596950&lt;/td&gt;
      &lt;td&gt;-1.116721&lt;/td&gt;
      &lt;td&gt;-1.387045&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2000-01-03&lt;/th&gt;
      &lt;td&gt;-1.016238&lt;/td&gt;
      &lt;td&gt;-0.096937&lt;/td&gt;
      &lt;td&gt;0.547761&lt;/td&gt;
      &lt;td&gt;-0.629623&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2000-01-04&lt;/th&gt;
      &lt;td&gt;1.512869&lt;/td&gt;
      &lt;td&gt;-0.538159&lt;/td&gt;
      &lt;td&gt;0.694778&lt;/td&gt;
      &lt;td&gt;0.561185&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2000-01-05&lt;/th&gt;
      &lt;td&gt;1.352126&lt;/td&gt;
      &lt;td&gt;-1.338459&lt;/td&gt;
      &lt;td&gt;1.203392&lt;/td&gt;
      &lt;td&gt;-0.431008&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2000-01-06&lt;/th&gt;
      &lt;td&gt;0.735395&lt;/td&gt;
      &lt;td&gt;-0.525117&lt;/td&gt;
      &lt;td&gt;0.562011&lt;/td&gt;
      &lt;td&gt;-0.133187&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2000-01-07&lt;/th&gt;
      &lt;td&gt;0.542937&lt;/td&gt;
      &lt;td&gt;-0.076509&lt;/td&gt;
      &lt;td&gt;0.047262&lt;/td&gt;
      &lt;td&gt;0.512984&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2000-01-08&lt;/th&gt;
      &lt;td&gt;0.812662&lt;/td&gt;
      &lt;td&gt;-1.047306&lt;/td&gt;
      &lt;td&gt;1.716307&lt;/td&gt;
      &lt;td&gt;-0.060350&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;p&gt;可以强转成 &lt;code&gt;ndarray&lt;/code&gt; 数组来实现这一操作：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;df.loc[:, [&#39;B&#39;, &#39;A&#39;]] = df[[&#39;A&#39;, &#39;B&#39;]].to_numpy()
df
&lt;/code&gt;&lt;/pre&gt;
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/style&gt;&lt;/p&gt;
&lt;table border=&#34;1&#34; class=&#34;dataframe&#34;&gt;
  &lt;thead&gt;
    &lt;tr style=&#34;text-align: right;&#34;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;A&lt;/th&gt;
      &lt;th&gt;B&lt;/th&gt;
      &lt;th&gt;C&lt;/th&gt;
      &lt;th&gt;D&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;2000-01-01&lt;/th&gt;
      &lt;td&gt;-0.245083&lt;/td&gt;
      &lt;td&gt;-1.422116&lt;/td&gt;
      &lt;td&gt;0.607832&lt;/td&gt;
      &lt;td&gt;1.303857&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2000-01-02&lt;/th&gt;
      &lt;td&gt;0.596950&lt;/td&gt;
      &lt;td&gt;-0.232929&lt;/td&gt;
      &lt;td&gt;-1.116721&lt;/td&gt;
      &lt;td&gt;-1.387045&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2000-01-03&lt;/th&gt;
      &lt;td&gt;-0.096937&lt;/td&gt;
      &lt;td&gt;-1.016238&lt;/td&gt;
      &lt;td&gt;0.547761&lt;/td&gt;
      &lt;td&gt;-0.629623&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2000-01-04&lt;/th&gt;
      &lt;td&gt;-0.538159&lt;/td&gt;
      &lt;td&gt;1.512869&lt;/td&gt;
      &lt;td&gt;0.694778&lt;/td&gt;
      &lt;td&gt;0.561185&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2000-01-05&lt;/th&gt;
      &lt;td&gt;-1.338459&lt;/td&gt;
      &lt;td&gt;1.352126&lt;/td&gt;
      &lt;td&gt;1.203392&lt;/td&gt;
      &lt;td&gt;-0.431008&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2000-01-06&lt;/th&gt;
      &lt;td&gt;-0.525117&lt;/td&gt;
      &lt;td&gt;0.735395&lt;/td&gt;
      &lt;td&gt;0.562011&lt;/td&gt;
      &lt;td&gt;-0.133187&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2000-01-07&lt;/th&gt;
      &lt;td&gt;-0.076509&lt;/td&gt;
      &lt;td&gt;0.542937&lt;/td&gt;
      &lt;td&gt;0.047262&lt;/td&gt;
      &lt;td&gt;0.512984&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2000-01-08&lt;/th&gt;
      &lt;td&gt;-1.047306&lt;/td&gt;
      &lt;td&gt;0.812662&lt;/td&gt;
      &lt;td&gt;1.716307&lt;/td&gt;
      &lt;td&gt;-0.060350&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;h3 id=&#34;切片&#34;&gt;切片&lt;/h3&gt;
&lt;p&gt;切片的规则和 &lt;strong&gt;Python&lt;/strong&gt; 以及 &lt;strong&gt;NumPy&lt;/strong&gt; 中的切片规则，一样。这里用 &lt;code&gt;[]&lt;/code&gt; 运算符说明切片的语义。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;s = pd.Series(np.random.randn(7), index=list(&#39;abcdefg&#39;))
s
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;a   -0.430408
b    1.192773
c    0.110207
d    0.252352
e   -0.126190
f    0.684152
g   -0.330652
dtype: float64
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;s[:5]
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;a   -0.430408
b    1.192773
c    0.110207
d    0.252352
e   -0.126190
dtype: float64
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;s[::2]
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;a   -0.430408
c    0.110207
e   -0.126190
g   -0.330652
dtype: float64
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;s[::-1]
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;g   -0.330652
f    0.684152
e   -0.126190
d    0.252352
c    0.110207
b    1.192773
a   -0.430408
dtype: float64
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;s2 = s.copy()
s2[:3] = 0
s2
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;a    0.000000
b    0.000000
c    0.000000
d    0.252352
e   -0.126190
f    0.684152
g   -0.330652
dtype: float64
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;df = pd.DataFrame(np.random.randn(3, 4), index=list(&#39;abc&#39;), columns=list(&#39;ABCD&#39;))
df
&lt;/code&gt;&lt;/pre&gt;
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/style&gt;&lt;/p&gt;
&lt;table border=&#34;1&#34; class=&#34;dataframe&#34;&gt;
  &lt;thead&gt;
    &lt;tr style=&#34;text-align: right;&#34;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;A&lt;/th&gt;
      &lt;th&gt;B&lt;/th&gt;
      &lt;th&gt;C&lt;/th&gt;
      &lt;th&gt;D&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;a&lt;/th&gt;
      &lt;td&gt;0.967130&lt;/td&gt;
      &lt;td&gt;0.642469&lt;/td&gt;
      &lt;td&gt;-0.327055&lt;/td&gt;
      &lt;td&gt;-0.760568&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;b&lt;/th&gt;
      &lt;td&gt;0.435906&lt;/td&gt;
      &lt;td&gt;-0.498920&lt;/td&gt;
      &lt;td&gt;0.411437&lt;/td&gt;
      &lt;td&gt;-1.726552&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;c&lt;/th&gt;
      &lt;td&gt;0.793539&lt;/td&gt;
      &lt;td&gt;-0.507760&lt;/td&gt;
      &lt;td&gt;0.167797&lt;/td&gt;
      &lt;td&gt;-1.432030&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;df[:2]
&lt;/code&gt;&lt;/pre&gt;
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/style&gt;&lt;/p&gt;
&lt;table border=&#34;1&#34; class=&#34;dataframe&#34;&gt;
  &lt;thead&gt;
    &lt;tr style=&#34;text-align: right;&#34;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;A&lt;/th&gt;
      &lt;th&gt;B&lt;/th&gt;
      &lt;th&gt;C&lt;/th&gt;
      &lt;th&gt;D&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;a&lt;/th&gt;
      &lt;td&gt;0.967130&lt;/td&gt;
      &lt;td&gt;0.642469&lt;/td&gt;
      &lt;td&gt;-0.327055&lt;/td&gt;
      &lt;td&gt;-0.760568&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;b&lt;/th&gt;
      &lt;td&gt;0.435906&lt;/td&gt;
      &lt;td&gt;-0.498920&lt;/td&gt;
      &lt;td&gt;0.411437&lt;/td&gt;
      &lt;td&gt;-1.726552&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;df[::-1]
&lt;/code&gt;&lt;/pre&gt;
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/style&gt;&lt;/p&gt;
&lt;table border=&#34;1&#34; class=&#34;dataframe&#34;&gt;
  &lt;thead&gt;
    &lt;tr style=&#34;text-align: right;&#34;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;A&lt;/th&gt;
      &lt;th&gt;B&lt;/th&gt;
      &lt;th&gt;C&lt;/th&gt;
      &lt;th&gt;D&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;c&lt;/th&gt;
      &lt;td&gt;0.793539&lt;/td&gt;
      &lt;td&gt;-0.507760&lt;/td&gt;
      &lt;td&gt;0.167797&lt;/td&gt;
      &lt;td&gt;-1.432030&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;b&lt;/th&gt;
      &lt;td&gt;0.435906&lt;/td&gt;
      &lt;td&gt;-0.498920&lt;/td&gt;
      &lt;td&gt;0.411437&lt;/td&gt;
      &lt;td&gt;-1.726552&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;a&lt;/th&gt;
      &lt;td&gt;0.967130&lt;/td&gt;
      &lt;td&gt;0.642469&lt;/td&gt;
      &lt;td&gt;-0.327055&lt;/td&gt;
      &lt;td&gt;-0.760568&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;h2 id=&#34;通过属性索引&#34;&gt;通过属性索引&lt;/h2&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;sa = pd.Series([1, 2, 3], index=list(&#39;abc&#39;))
dfa = df.copy()
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;sa
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;a    1
b    2
c    3
dtype: int64
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;sa.b
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;2
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;dfa
&lt;/code&gt;&lt;/pre&gt;
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/style&gt;&lt;/p&gt;
&lt;table border=&#34;1&#34; class=&#34;dataframe&#34;&gt;
  &lt;thead&gt;
    &lt;tr style=&#34;text-align: right;&#34;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;A&lt;/th&gt;
      &lt;th&gt;B&lt;/th&gt;
      &lt;th&gt;C&lt;/th&gt;
      &lt;th&gt;D&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;a&lt;/th&gt;
      &lt;td&gt;0.967130&lt;/td&gt;
      &lt;td&gt;0.642469&lt;/td&gt;
      &lt;td&gt;-0.327055&lt;/td&gt;
      &lt;td&gt;-0.760568&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;b&lt;/th&gt;
      &lt;td&gt;0.435906&lt;/td&gt;
      &lt;td&gt;-0.498920&lt;/td&gt;
      &lt;td&gt;0.411437&lt;/td&gt;
      &lt;td&gt;-1.726552&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;c&lt;/th&gt;
      &lt;td&gt;0.793539&lt;/td&gt;
      &lt;td&gt;-0.507760&lt;/td&gt;
      &lt;td&gt;0.167797&lt;/td&gt;
      &lt;td&gt;-1.432030&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;dfa.A
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;a    0.967130
b    0.435906
c    0.793539
Name: A, dtype: float64
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;dfa.A = list(range(len(dfa.index)))
dfa
&lt;/code&gt;&lt;/pre&gt;
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/style&gt;&lt;/p&gt;
&lt;table border=&#34;1&#34; class=&#34;dataframe&#34;&gt;
  &lt;thead&gt;
    &lt;tr style=&#34;text-align: right;&#34;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;A&lt;/th&gt;
      &lt;th&gt;B&lt;/th&gt;
      &lt;th&gt;C&lt;/th&gt;
      &lt;th&gt;D&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;a&lt;/th&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0.642469&lt;/td&gt;
      &lt;td&gt;-0.327055&lt;/td&gt;
      &lt;td&gt;-0.760568&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;b&lt;/th&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;-0.498920&lt;/td&gt;
      &lt;td&gt;0.411437&lt;/td&gt;
      &lt;td&gt;-1.726552&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;c&lt;/th&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;-0.507760&lt;/td&gt;
      &lt;td&gt;0.167797&lt;/td&gt;
      &lt;td&gt;-1.432030&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;p&gt;采用访问属性的方法必须确保该属性存在。如果要创建新的一列，仍然需要通过 &lt;code&gt;[]&lt;/code&gt;。否则，会出现 &lt;code&gt;UserWanring&lt;/code&gt; 的警告。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;dfa[&#39;E&#39;] = list(range(len(dfa.index)))
dfa
&lt;/code&gt;&lt;/pre&gt;
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/style&gt;&lt;/p&gt;
&lt;table border=&#34;1&#34; class=&#34;dataframe&#34;&gt;
  &lt;thead&gt;
    &lt;tr style=&#34;text-align: right;&#34;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;A&lt;/th&gt;
      &lt;th&gt;B&lt;/th&gt;
      &lt;th&gt;C&lt;/th&gt;
      &lt;th&gt;D&lt;/th&gt;
      &lt;th&gt;E&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;a&lt;/th&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0.642469&lt;/td&gt;
      &lt;td&gt;-0.327055&lt;/td&gt;
      &lt;td&gt;-0.760568&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;b&lt;/th&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;-0.498920&lt;/td&gt;
      &lt;td&gt;0.411437&lt;/td&gt;
      &lt;td&gt;-1.726552&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;c&lt;/th&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;-0.507760&lt;/td&gt;
      &lt;td&gt;0.167797&lt;/td&gt;
      &lt;td&gt;-1.432030&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;h2 id=&#34;通过标签索引&#34;&gt;通过标签索引&lt;/h2&gt;
&lt;p&gt;使用 &lt;code&gt;loc&lt;/code&gt; 方法可以使用标签对行进行索引。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;s1 = pd.Series(np.random.randn(6), index=list(&#39;abcdef&#39;))
s1
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;a   -1.373748
b    0.505333
c    0.929577
d    0.336673
e    1.074367
f   -1.375100
dtype: float64
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;s1.loc[&#39;b&#39;]
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;0.5053325199102856
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;标签支持冒号表达式，进行切片运算。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;s1.loc[&#39;c&#39;:]
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;c    0.929577
d    0.336673
e    1.074367
f   -1.375100
dtype: float64
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;df1 = pd.DataFrame(np.random.randn(6, 4), index=list(&#39;abcdef&#39;), columns=list(&#39;ABCD&#39;))
df1
&lt;/code&gt;&lt;/pre&gt;
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/style&gt;&lt;/p&gt;
&lt;table border=&#34;1&#34; class=&#34;dataframe&#34;&gt;
  &lt;thead&gt;
    &lt;tr style=&#34;text-align: right;&#34;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;A&lt;/th&gt;
      &lt;th&gt;B&lt;/th&gt;
      &lt;th&gt;C&lt;/th&gt;
      &lt;th&gt;D&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;a&lt;/th&gt;
      &lt;td&gt;-0.100191&lt;/td&gt;
      &lt;td&gt;-0.129401&lt;/td&gt;
      &lt;td&gt;0.976985&lt;/td&gt;
      &lt;td&gt;1.839616&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;b&lt;/th&gt;
      &lt;td&gt;1.158153&lt;/td&gt;
      &lt;td&gt;0.662432&lt;/td&gt;
      &lt;td&gt;1.278219&lt;/td&gt;
      &lt;td&gt;-0.159460&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;c&lt;/th&gt;
      &lt;td&gt;0.650541&lt;/td&gt;
      &lt;td&gt;-0.073285&lt;/td&gt;
      &lt;td&gt;-1.377789&lt;/td&gt;
      &lt;td&gt;0.122472&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;d&lt;/th&gt;
      &lt;td&gt;0.442271&lt;/td&gt;
      &lt;td&gt;0.452595&lt;/td&gt;
      &lt;td&gt;-1.274344&lt;/td&gt;
      &lt;td&gt;-0.494543&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;e&lt;/th&gt;
      &lt;td&gt;0.536770&lt;/td&gt;
      &lt;td&gt;-0.597499&lt;/td&gt;
      &lt;td&gt;0.897752&lt;/td&gt;
      &lt;td&gt;1.104886&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;f&lt;/th&gt;
      &lt;td&gt;1.488848&lt;/td&gt;
      &lt;td&gt;1.195444&lt;/td&gt;
      &lt;td&gt;1.394976&lt;/td&gt;
      &lt;td&gt;1.760736&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;p&gt;DataFrame 对象可以行列同时索引。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;df1.loc[[&#39;a&#39;, &#39;b&#39;, &#39;d&#39;], [&#39;A&#39;, &#39;C&#39;]]
&lt;/code&gt;&lt;/pre&gt;
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/style&gt;&lt;/p&gt;
&lt;table border=&#34;1&#34; class=&#34;dataframe&#34;&gt;
  &lt;thead&gt;
    &lt;tr style=&#34;text-align: right;&#34;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;A&lt;/th&gt;
      &lt;th&gt;C&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;a&lt;/th&gt;
      &lt;td&gt;-0.100191&lt;/td&gt;
      &lt;td&gt;0.976985&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;b&lt;/th&gt;
      &lt;td&gt;1.158153&lt;/td&gt;
      &lt;td&gt;1.278219&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;d&lt;/th&gt;
      &lt;td&gt;0.442271&lt;/td&gt;
      &lt;td&gt;-1.274344&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;df1.loc[&#39;d&#39;:, &#39;A&#39;:&#39;C&#39;]
&lt;/code&gt;&lt;/pre&gt;
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/style&gt;&lt;/p&gt;
&lt;table border=&#34;1&#34; class=&#34;dataframe&#34;&gt;
  &lt;thead&gt;
    &lt;tr style=&#34;text-align: right;&#34;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;A&lt;/th&gt;
      &lt;th&gt;B&lt;/th&gt;
      &lt;th&gt;C&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;d&lt;/th&gt;
      &lt;td&gt;0.442271&lt;/td&gt;
      &lt;td&gt;0.452595&lt;/td&gt;
      &lt;td&gt;-1.274344&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;e&lt;/th&gt;
      &lt;td&gt;0.536770&lt;/td&gt;
      &lt;td&gt;-0.597499&lt;/td&gt;
      &lt;td&gt;0.897752&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;f&lt;/th&gt;
      &lt;td&gt;1.488848&lt;/td&gt;
      &lt;td&gt;1.195444&lt;/td&gt;
      &lt;td&gt;1.394976&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;p&gt;注意：下面的切片不是下标切片，而是标签切片。因此，&lt;code&gt;3:5&lt;/code&gt; 表示标签 &lt;code&gt;3&lt;/code&gt; 和 &lt;code&gt;5&lt;/code&gt; 之间的所有标签。&lt;code&gt;3&lt;/code&gt; 和 &lt;code&gt;5&lt;/code&gt; 之间还有一个标签 &lt;code&gt;2&lt;/code&gt;，因此返回结果为：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;s = pd.Series(list(&#39;abcdef&#39;), index=[0, 3, 2, 5, 4, 2])
s.loc[3:5]
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;3    b
2    c
5    d
dtype: object
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;通过下标位置索引&#34;&gt;通过下标位置索引&lt;/h2&gt;
&lt;p&gt;使用 &lt;code&gt;iloc&lt;/code&gt; 方法可以通过下标位置进行索引。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;s2 = pd.Series(np.random.randn(5), index=list(range(0, 10, 2)))
s2
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;0   -0.235442
2    1.504205
4    0.917704
6   -0.268698
8    0.045323
dtype: float64
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;s2.iloc[:3]
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;0   -0.235442
2    1.504205
4    0.917704
dtype: float64
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;s2.iloc[-1]
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;0.04532252934053265
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;df2 = pd.DataFrame(np.random.randn(6, 4),
                   index=list(range(0, 12, 2)),
                   columns=list(range(0, 8, 2)))
df2
&lt;/code&gt;&lt;/pre&gt;
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/style&gt;&lt;/p&gt;
&lt;table border=&#34;1&#34; class=&#34;dataframe&#34;&gt;
  &lt;thead&gt;
    &lt;tr style=&#34;text-align: right;&#34;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;th&gt;2&lt;/th&gt;
      &lt;th&gt;4&lt;/th&gt;
      &lt;th&gt;6&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;td&gt;0.342468&lt;/td&gt;
      &lt;td&gt;0.198276&lt;/td&gt;
      &lt;td&gt;-1.195844&lt;/td&gt;
      &lt;td&gt;0.451696&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2&lt;/th&gt;
      &lt;td&gt;-0.025717&lt;/td&gt;
      &lt;td&gt;0.077352&lt;/td&gt;
      &lt;td&gt;-0.123052&lt;/td&gt;
      &lt;td&gt;1.313708&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;4&lt;/th&gt;
      &lt;td&gt;-0.137973&lt;/td&gt;
      &lt;td&gt;0.373148&lt;/td&gt;
      &lt;td&gt;-0.220029&lt;/td&gt;
      &lt;td&gt;-0.683300&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;6&lt;/th&gt;
      &lt;td&gt;-0.554065&lt;/td&gt;
      &lt;td&gt;-0.518741&lt;/td&gt;
      &lt;td&gt;-0.839679&lt;/td&gt;
      &lt;td&gt;-0.599059&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;8&lt;/th&gt;
      &lt;td&gt;-0.585208&lt;/td&gt;
      &lt;td&gt;1.001620&lt;/td&gt;
      &lt;td&gt;0.162317&lt;/td&gt;
      &lt;td&gt;-1.386377&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;10&lt;/th&gt;
      &lt;td&gt;-0.229306&lt;/td&gt;
      &lt;td&gt;1.202411&lt;/td&gt;
      &lt;td&gt;-0.456811&lt;/td&gt;
      &lt;td&gt;0.110556&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;p&gt;DataFrame 对象可以行列同时索引。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;df2.iloc[:3]
&lt;/code&gt;&lt;/pre&gt;
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/style&gt;&lt;/p&gt;
&lt;table border=&#34;1&#34; class=&#34;dataframe&#34;&gt;
  &lt;thead&gt;
    &lt;tr style=&#34;text-align: right;&#34;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;th&gt;2&lt;/th&gt;
      &lt;th&gt;4&lt;/th&gt;
      &lt;th&gt;6&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;td&gt;0.342468&lt;/td&gt;
      &lt;td&gt;0.198276&lt;/td&gt;
      &lt;td&gt;-1.195844&lt;/td&gt;
      &lt;td&gt;0.451696&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2&lt;/th&gt;
      &lt;td&gt;-0.025717&lt;/td&gt;
      &lt;td&gt;0.077352&lt;/td&gt;
      &lt;td&gt;-0.123052&lt;/td&gt;
      &lt;td&gt;1.313708&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;4&lt;/th&gt;
      &lt;td&gt;-0.137973&lt;/td&gt;
      &lt;td&gt;0.373148&lt;/td&gt;
      &lt;td&gt;-0.220029&lt;/td&gt;
      &lt;td&gt;-0.683300&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;df2.iloc[1:5, 2:4]
&lt;/code&gt;&lt;/pre&gt;
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/style&gt;&lt;/p&gt;
&lt;table border=&#34;1&#34; class=&#34;dataframe&#34;&gt;
  &lt;thead&gt;
    &lt;tr style=&#34;text-align: right;&#34;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;4&lt;/th&gt;
      &lt;th&gt;6&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;2&lt;/th&gt;
      &lt;td&gt;-0.123052&lt;/td&gt;
      &lt;td&gt;1.313708&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;4&lt;/th&gt;
      &lt;td&gt;-0.220029&lt;/td&gt;
      &lt;td&gt;-0.683300&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;6&lt;/th&gt;
      &lt;td&gt;-0.839679&lt;/td&gt;
      &lt;td&gt;-0.599059&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;8&lt;/th&gt;
      &lt;td&gt;0.162317&lt;/td&gt;
      &lt;td&gt;-1.386377&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;df2.iloc[[1, 3, 5], [1, 3]]
&lt;/code&gt;&lt;/pre&gt;
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/style&gt;&lt;/p&gt;
&lt;table border=&#34;1&#34; class=&#34;dataframe&#34;&gt;
  &lt;thead&gt;
    &lt;tr style=&#34;text-align: right;&#34;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;2&lt;/th&gt;
      &lt;th&gt;6&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;2&lt;/th&gt;
      &lt;td&gt;0.077352&lt;/td&gt;
      &lt;td&gt;1.313708&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;6&lt;/th&gt;
      &lt;td&gt;-0.518741&lt;/td&gt;
      &lt;td&gt;-0.599059&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;10&lt;/th&gt;
      &lt;td&gt;1.202411&lt;/td&gt;
      &lt;td&gt;0.110556&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;df2.iloc[1:3, :]
&lt;/code&gt;&lt;/pre&gt;
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/style&gt;&lt;/p&gt;
&lt;table border=&#34;1&#34; class=&#34;dataframe&#34;&gt;
  &lt;thead&gt;
    &lt;tr style=&#34;text-align: right;&#34;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;th&gt;2&lt;/th&gt;
      &lt;th&gt;4&lt;/th&gt;
      &lt;th&gt;6&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;2&lt;/th&gt;
      &lt;td&gt;-0.025717&lt;/td&gt;
      &lt;td&gt;0.077352&lt;/td&gt;
      &lt;td&gt;-0.123052&lt;/td&gt;
      &lt;td&gt;1.313708&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;4&lt;/th&gt;
      &lt;td&gt;-0.137973&lt;/td&gt;
      &lt;td&gt;0.373148&lt;/td&gt;
      &lt;td&gt;-0.220029&lt;/td&gt;
      &lt;td&gt;-0.683300&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;p&gt;可以超出索引范围，但是可能会返回空 DataFrame。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;df2.iloc[:, 4:]
&lt;/code&gt;&lt;/pre&gt;
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/style&gt;&lt;/p&gt;
&lt;table border=&#34;1&#34; class=&#34;dataframe&#34;&gt;
  &lt;thead&gt;
    &lt;tr style=&#34;text-align: right;&#34;&gt;
      &lt;th&gt;&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2&lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;4&lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;6&lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;8&lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;10&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;h2 id=&#34;选择接受可调用对象&#34;&gt;选择接受可调用对象&lt;/h2&gt;
&lt;p&gt;&lt;code&gt;[]&lt;/code&gt;、&lt;code&gt;loc&lt;/code&gt; 和 &lt;code&gt;iloc&lt;/code&gt; 都接受可调用对象进行索引。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;df1 = pd.DataFrame(np.random.randn(6, 4),
                   index=list(&#39;abcdef&#39;),
                   columns=list(&#39;ABCD&#39;))
df1
&lt;/code&gt;&lt;/pre&gt;
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/style&gt;&lt;/p&gt;
&lt;table border=&#34;1&#34; class=&#34;dataframe&#34;&gt;
  &lt;thead&gt;
    &lt;tr style=&#34;text-align: right;&#34;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;A&lt;/th&gt;
      &lt;th&gt;B&lt;/th&gt;
      &lt;th&gt;C&lt;/th&gt;
      &lt;th&gt;D&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;a&lt;/th&gt;
      &lt;td&gt;1.444943&lt;/td&gt;
      &lt;td&gt;-0.907930&lt;/td&gt;
      &lt;td&gt;1.038214&lt;/td&gt;
      &lt;td&gt;-2.246870&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;b&lt;/th&gt;
      &lt;td&gt;-1.602533&lt;/td&gt;
      &lt;td&gt;-1.085308&lt;/td&gt;
      &lt;td&gt;-1.039485&lt;/td&gt;
      &lt;td&gt;0.574455&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;c&lt;/th&gt;
      &lt;td&gt;-0.705120&lt;/td&gt;
      &lt;td&gt;0.563562&lt;/td&gt;
      &lt;td&gt;1.281975&lt;/td&gt;
      &lt;td&gt;1.127445&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;d&lt;/th&gt;
      &lt;td&gt;-1.860152&lt;/td&gt;
      &lt;td&gt;-1.679263&lt;/td&gt;
      &lt;td&gt;-1.071518&lt;/td&gt;
      &lt;td&gt;0.127717&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;e&lt;/th&gt;
      &lt;td&gt;0.472768&lt;/td&gt;
      &lt;td&gt;-0.563109&lt;/td&gt;
      &lt;td&gt;-0.331930&lt;/td&gt;
      &lt;td&gt;-1.279404&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;f&lt;/th&gt;
      &lt;td&gt;0.759632&lt;/td&gt;
      &lt;td&gt;0.306537&lt;/td&gt;
      &lt;td&gt;-0.342015&lt;/td&gt;
      &lt;td&gt;-1.121230&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;df1.loc[lambda df: df[&#39;A&#39;] &amp;gt; 0, :]
&lt;/code&gt;&lt;/pre&gt;
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/style&gt;&lt;/p&gt;
&lt;table border=&#34;1&#34; class=&#34;dataframe&#34;&gt;
  &lt;thead&gt;
    &lt;tr style=&#34;text-align: right;&#34;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;A&lt;/th&gt;
      &lt;th&gt;B&lt;/th&gt;
      &lt;th&gt;C&lt;/th&gt;
      &lt;th&gt;D&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;a&lt;/th&gt;
      &lt;td&gt;1.444943&lt;/td&gt;
      &lt;td&gt;-0.907930&lt;/td&gt;
      &lt;td&gt;1.038214&lt;/td&gt;
      &lt;td&gt;-2.246870&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;e&lt;/th&gt;
      &lt;td&gt;0.472768&lt;/td&gt;
      &lt;td&gt;-0.563109&lt;/td&gt;
      &lt;td&gt;-0.331930&lt;/td&gt;
      &lt;td&gt;-1.279404&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;f&lt;/th&gt;
      &lt;td&gt;0.759632&lt;/td&gt;
      &lt;td&gt;0.306537&lt;/td&gt;
      &lt;td&gt;-0.342015&lt;/td&gt;
      &lt;td&gt;-1.121230&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;df1.loc[:, lambda df: [&#39;A&#39;, &#39;B&#39;]]
&lt;/code&gt;&lt;/pre&gt;
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/style&gt;&lt;/p&gt;
&lt;table border=&#34;1&#34; class=&#34;dataframe&#34;&gt;
  &lt;thead&gt;
    &lt;tr style=&#34;text-align: right;&#34;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;A&lt;/th&gt;
      &lt;th&gt;B&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;a&lt;/th&gt;
      &lt;td&gt;1.444943&lt;/td&gt;
      &lt;td&gt;-0.907930&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;b&lt;/th&gt;
      &lt;td&gt;-1.602533&lt;/td&gt;
      &lt;td&gt;-1.085308&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;c&lt;/th&gt;
      &lt;td&gt;-0.705120&lt;/td&gt;
      &lt;td&gt;0.563562&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;d&lt;/th&gt;
      &lt;td&gt;-1.860152&lt;/td&gt;
      &lt;td&gt;-1.679263&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;e&lt;/th&gt;
      &lt;td&gt;0.472768&lt;/td&gt;
      &lt;td&gt;-0.563109&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;f&lt;/th&gt;
      &lt;td&gt;0.759632&lt;/td&gt;
      &lt;td&gt;0.306537&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;df1.iloc[:, lambda df: [0, 1]]
&lt;/code&gt;&lt;/pre&gt;
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/style&gt;&lt;/p&gt;
&lt;table border=&#34;1&#34; class=&#34;dataframe&#34;&gt;
  &lt;thead&gt;
    &lt;tr style=&#34;text-align: right;&#34;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;A&lt;/th&gt;
      &lt;th&gt;B&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;a&lt;/th&gt;
      &lt;td&gt;1.444943&lt;/td&gt;
      &lt;td&gt;-0.907930&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;b&lt;/th&gt;
      &lt;td&gt;-1.602533&lt;/td&gt;
      &lt;td&gt;-1.085308&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;c&lt;/th&gt;
      &lt;td&gt;-0.705120&lt;/td&gt;
      &lt;td&gt;0.563562&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;d&lt;/th&gt;
      &lt;td&gt;-1.860152&lt;/td&gt;
      &lt;td&gt;-1.679263&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;e&lt;/th&gt;
      &lt;td&gt;0.472768&lt;/td&gt;
      &lt;td&gt;-0.563109&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;f&lt;/th&gt;
      &lt;td&gt;0.759632&lt;/td&gt;
      &lt;td&gt;0.306537&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;df1[lambda df: df.columns[0]]
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;a    1.444943
b   -1.602533
c   -0.705120
d   -1.860152
e    0.472768
f    0.759632
Name: A, dtype: float64
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;df1[&#39;A&#39;].loc[lambda s: s &amp;gt; 0]
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;a    1.444943
e    0.472768
f    0.759632
Name: A, dtype: float64
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;快速访问&#34;&gt;快速访问&lt;/h2&gt;
&lt;p&gt;由于使用 &lt;code&gt;[]&lt;/code&gt; 进行索引必须处理很多情况（单标签访问、切片、布尔索引等），因此它需要一些开销才能确定您的要求。如果您只想访问一个标量值，最快的方法是使用 &lt;code&gt;at&lt;/code&gt; 和 &lt;code&gt;iat&lt;/code&gt; 方法，它们在所有数据结构上都实现了。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;s = pd.Series(np.random.randint(0, 7, size=(7,)), index=list(&#39;abcdefg&#39;))
s
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;a    1
b    4
c    5
d    6
e    0
f    3
g    3
dtype: int32
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;s.iat[5]
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;3
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;s.at[&#39;a&#39;]
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;1
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;df = pd.DataFrame(np.random.randint(0, 7, size=(3, 4)), index=list(&#39;abc&#39;), columns=list(&#39;ABCD&#39;))
df
&lt;/code&gt;&lt;/pre&gt;
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/style&gt;&lt;/p&gt;
&lt;table border=&#34;1&#34; class=&#34;dataframe&#34;&gt;
  &lt;thead&gt;
    &lt;tr style=&#34;text-align: right;&#34;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;A&lt;/th&gt;
      &lt;th&gt;B&lt;/th&gt;
      &lt;th&gt;C&lt;/th&gt;
      &lt;th&gt;D&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;a&lt;/th&gt;
      &lt;td&gt;3&lt;/td&gt;
      &lt;td&gt;5&lt;/td&gt;
      &lt;td&gt;4&lt;/td&gt;
      &lt;td&gt;4&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;b&lt;/th&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;c&lt;/th&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;3&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;df.iat[0, 1]
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;5
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;df.at[&#39;b&#39;, &#39;A&#39;]
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;0
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;布尔索引&#34;&gt;布尔索引&lt;/h2&gt;
&lt;p&gt;Series 对象的布尔索引和 &lt;strong&gt;Python&lt;/strong&gt; 以及 &lt;strong&gt;NumPy&lt;/strong&gt; 类似。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;s = pd.Series(range(-3, 4))
s
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;0   -3
1   -2
2   -1
3    0
4    1
5    2
6    3
dtype: int64
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;s[s &amp;gt; 0]
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;4    1
5    2
6    3
dtype: int64
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;s[(s &amp;lt; -1) | (s &amp;gt; 0.5)]
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;0   -3
1   -2
4    1
5    2
6    3
dtype: int64
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;s[~(s &amp;lt; 0)]
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;3    0
4    1
5    2
6    3
dtype: int64
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;df = pd.DataFrame(np.random.randn(7, 4),
                  index=pd.date_range(&#39;2022/02/22&#39;, periods=7),
                  columns=list(&#39;ABCD&#39;))
df
&lt;/code&gt;&lt;/pre&gt;
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/style&gt;&lt;/p&gt;
&lt;table border=&#34;1&#34; class=&#34;dataframe&#34;&gt;
  &lt;thead&gt;
    &lt;tr style=&#34;text-align: right;&#34;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;A&lt;/th&gt;
      &lt;th&gt;B&lt;/th&gt;
      &lt;th&gt;C&lt;/th&gt;
      &lt;th&gt;D&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;2022-02-22&lt;/th&gt;
      &lt;td&gt;-1.322987&lt;/td&gt;
      &lt;td&gt;1.022325&lt;/td&gt;
      &lt;td&gt;0.304516&lt;/td&gt;
      &lt;td&gt;-0.281856&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2022-02-23&lt;/th&gt;
      &lt;td&gt;-0.767053&lt;/td&gt;
      &lt;td&gt;0.644011&lt;/td&gt;
      &lt;td&gt;2.058071&lt;/td&gt;
      &lt;td&gt;-0.342653&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2022-02-24&lt;/th&gt;
      &lt;td&gt;0.065301&lt;/td&gt;
      &lt;td&gt;2.530895&lt;/td&gt;
      &lt;td&gt;1.091807&lt;/td&gt;
      &lt;td&gt;1.865210&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2022-02-25&lt;/th&gt;
      &lt;td&gt;-2.094778&lt;/td&gt;
      &lt;td&gt;-0.714121&lt;/td&gt;
      &lt;td&gt;0.319254&lt;/td&gt;
      &lt;td&gt;-1.102402&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2022-02-26&lt;/th&gt;
      &lt;td&gt;1.543428&lt;/td&gt;
      &lt;td&gt;-1.073784&lt;/td&gt;
      &lt;td&gt;-0.585543&lt;/td&gt;
      &lt;td&gt;-1.479911&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2022-02-27&lt;/th&gt;
      &lt;td&gt;-0.045216&lt;/td&gt;
      &lt;td&gt;-1.291289&lt;/td&gt;
      &lt;td&gt;0.145565&lt;/td&gt;
      &lt;td&gt;0.124343&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2022-02-28&lt;/th&gt;
      &lt;td&gt;-1.352934&lt;/td&gt;
      &lt;td&gt;-1.934588&lt;/td&gt;
      &lt;td&gt;0.214902&lt;/td&gt;
      &lt;td&gt;-0.942982&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;df[df[&#39;A&#39;] &amp;gt; 0]
&lt;/code&gt;&lt;/pre&gt;
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/style&gt;&lt;/p&gt;
&lt;table border=&#34;1&#34; class=&#34;dataframe&#34;&gt;
  &lt;thead&gt;
    &lt;tr style=&#34;text-align: right;&#34;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;A&lt;/th&gt;
      &lt;th&gt;B&lt;/th&gt;
      &lt;th&gt;C&lt;/th&gt;
      &lt;th&gt;D&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;2022-02-24&lt;/th&gt;
      &lt;td&gt;0.065301&lt;/td&gt;
      &lt;td&gt;2.530895&lt;/td&gt;
      &lt;td&gt;1.091807&lt;/td&gt;
      &lt;td&gt;1.865210&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2022-02-26&lt;/th&gt;
      &lt;td&gt;1.543428&lt;/td&gt;
      &lt;td&gt;-1.073784&lt;/td&gt;
      &lt;td&gt;-0.585543&lt;/td&gt;
      &lt;td&gt;-1.479911&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;</description>
    </item>
    
    <item>
      <title>pandas 基本运算</title>
      <link>https://bowenei.gitee.io/learn/pandas/arithmetic/</link>
      <pubDate>Fri, 04 Mar 2022 11:07:16 +0800</pubDate>
      <guid>https://bowenei.gitee.io/learn/pandas/arithmetic/</guid>
      <description>&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;import pandas as pd
import numpy as np
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;算术运算&#34;&gt;算术运算&lt;/h2&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;df1 = pd.DataFrame(np.random.randn(10, 4), columns=[&amp;quot;A&amp;quot;, &amp;quot;B&amp;quot;, &amp;quot;C&amp;quot;, &amp;quot;D&amp;quot;])
df1
&lt;/code&gt;&lt;/pre&gt;
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/style&gt;&lt;/p&gt;
&lt;table border=&#34;1&#34; class=&#34;dataframe&#34;&gt;
  &lt;thead&gt;
    &lt;tr style=&#34;text-align: right;&#34;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;A&lt;/th&gt;
      &lt;th&gt;B&lt;/th&gt;
      &lt;th&gt;C&lt;/th&gt;
      &lt;th&gt;D&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;td&gt;-0.039197&lt;/td&gt;
      &lt;td&gt;-1.345397&lt;/td&gt;
      &lt;td&gt;1.231152&lt;/td&gt;
      &lt;td&gt;-1.209577&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1&lt;/th&gt;
      &lt;td&gt;-0.146425&lt;/td&gt;
      &lt;td&gt;-0.126034&lt;/td&gt;
      &lt;td&gt;0.049097&lt;/td&gt;
      &lt;td&gt;-0.239117&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2&lt;/th&gt;
      &lt;td&gt;-0.736525&lt;/td&gt;
      &lt;td&gt;0.855204&lt;/td&gt;
      &lt;td&gt;1.039200&lt;/td&gt;
      &lt;td&gt;-1.544436&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;3&lt;/th&gt;
      &lt;td&gt;-0.644882&lt;/td&gt;
      &lt;td&gt;-0.139244&lt;/td&gt;
      &lt;td&gt;-1.548867&lt;/td&gt;
      &lt;td&gt;-1.893190&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;4&lt;/th&gt;
      &lt;td&gt;0.763529&lt;/td&gt;
      &lt;td&gt;0.350332&lt;/td&gt;
      &lt;td&gt;-1.290519&lt;/td&gt;
      &lt;td&gt;-0.030608&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;5&lt;/th&gt;
      &lt;td&gt;0.523727&lt;/td&gt;
      &lt;td&gt;1.005206&lt;/td&gt;
      &lt;td&gt;-0.268476&lt;/td&gt;
      &lt;td&gt;-0.352177&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;6&lt;/th&gt;
      &lt;td&gt;1.667456&lt;/td&gt;
      &lt;td&gt;-0.197137&lt;/td&gt;
      &lt;td&gt;1.710659&lt;/td&gt;
      &lt;td&gt;0.412051&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;7&lt;/th&gt;
      &lt;td&gt;-1.872084&lt;/td&gt;
      &lt;td&gt;-1.234837&lt;/td&gt;
      &lt;td&gt;1.196401&lt;/td&gt;
      &lt;td&gt;-0.333764&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;8&lt;/th&gt;
      &lt;td&gt;0.390396&lt;/td&gt;
      &lt;td&gt;2.459068&lt;/td&gt;
      &lt;td&gt;-0.255654&lt;/td&gt;
      &lt;td&gt;-2.184972&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;9&lt;/th&gt;
      &lt;td&gt;2.191920&lt;/td&gt;
      &lt;td&gt;0.195064&lt;/td&gt;
      &lt;td&gt;-0.233379&lt;/td&gt;
      &lt;td&gt;1.106590&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;df2 = pd.DataFrame(np.random.randn(7, 3), columns=[&amp;quot;A&amp;quot;, &amp;quot;B&amp;quot;, &amp;quot;C&amp;quot;])
df2
&lt;/code&gt;&lt;/pre&gt;
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/style&gt;&lt;/p&gt;
&lt;table border=&#34;1&#34; class=&#34;dataframe&#34;&gt;
  &lt;thead&gt;
    &lt;tr style=&#34;text-align: right;&#34;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;A&lt;/th&gt;
      &lt;th&gt;B&lt;/th&gt;
      &lt;th&gt;C&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;td&gt;-0.879968&lt;/td&gt;
      &lt;td&gt;-0.381367&lt;/td&gt;
      &lt;td&gt;1.288975&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1&lt;/th&gt;
      &lt;td&gt;-0.088425&lt;/td&gt;
      &lt;td&gt;0.211976&lt;/td&gt;
      &lt;td&gt;0.194757&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2&lt;/th&gt;
      &lt;td&gt;0.980227&lt;/td&gt;
      &lt;td&gt;-0.040865&lt;/td&gt;
      &lt;td&gt;0.656159&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;3&lt;/th&gt;
      &lt;td&gt;0.987874&lt;/td&gt;
      &lt;td&gt;-0.978989&lt;/td&gt;
      &lt;td&gt;-0.742291&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;4&lt;/th&gt;
      &lt;td&gt;0.859827&lt;/td&gt;
      &lt;td&gt;-0.987786&lt;/td&gt;
      &lt;td&gt;2.217203&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;5&lt;/th&gt;
      &lt;td&gt;-1.377002&lt;/td&gt;
      &lt;td&gt;-0.866408&lt;/td&gt;
      &lt;td&gt;-0.615638&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;6&lt;/th&gt;
      &lt;td&gt;-0.754354&lt;/td&gt;
      &lt;td&gt;0.127508&lt;/td&gt;
      &lt;td&gt;-0.240242&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;df1 * 5 + 2
&lt;/code&gt;&lt;/pre&gt;
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/style&gt;&lt;/p&gt;
&lt;table border=&#34;1&#34; class=&#34;dataframe&#34;&gt;
  &lt;thead&gt;
    &lt;tr style=&#34;text-align: right;&#34;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;A&lt;/th&gt;
      &lt;th&gt;B&lt;/th&gt;
      &lt;th&gt;C&lt;/th&gt;
      &lt;th&gt;D&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;td&gt;1.804017&lt;/td&gt;
      &lt;td&gt;-4.726986&lt;/td&gt;
      &lt;td&gt;8.155758&lt;/td&gt;
      &lt;td&gt;-4.047884&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1&lt;/th&gt;
      &lt;td&gt;1.267876&lt;/td&gt;
      &lt;td&gt;1.369828&lt;/td&gt;
      &lt;td&gt;2.245483&lt;/td&gt;
      &lt;td&gt;0.804413&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2&lt;/th&gt;
      &lt;td&gt;-1.682623&lt;/td&gt;
      &lt;td&gt;6.276020&lt;/td&gt;
      &lt;td&gt;7.195998&lt;/td&gt;
      &lt;td&gt;-5.722179&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;3&lt;/th&gt;
      &lt;td&gt;-1.224408&lt;/td&gt;
      &lt;td&gt;1.303778&lt;/td&gt;
      &lt;td&gt;-5.744335&lt;/td&gt;
      &lt;td&gt;-7.465951&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;4&lt;/th&gt;
      &lt;td&gt;5.817644&lt;/td&gt;
      &lt;td&gt;3.751659&lt;/td&gt;
      &lt;td&gt;-4.452595&lt;/td&gt;
      &lt;td&gt;1.846959&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;5&lt;/th&gt;
      &lt;td&gt;4.618635&lt;/td&gt;
      &lt;td&gt;7.026031&lt;/td&gt;
      &lt;td&gt;0.657621&lt;/td&gt;
      &lt;td&gt;0.239117&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;6&lt;/th&gt;
      &lt;td&gt;10.337280&lt;/td&gt;
      &lt;td&gt;1.014315&lt;/td&gt;
      &lt;td&gt;10.553293&lt;/td&gt;
      &lt;td&gt;4.060255&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;7&lt;/th&gt;
      &lt;td&gt;-7.360419&lt;/td&gt;
      &lt;td&gt;-4.174187&lt;/td&gt;
      &lt;td&gt;7.982006&lt;/td&gt;
      &lt;td&gt;0.331182&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;8&lt;/th&gt;
      &lt;td&gt;3.951981&lt;/td&gt;
      &lt;td&gt;14.295340&lt;/td&gt;
      &lt;td&gt;0.721729&lt;/td&gt;
      &lt;td&gt;-8.924858&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;9&lt;/th&gt;
      &lt;td&gt;12.959601&lt;/td&gt;
      &lt;td&gt;2.975322&lt;/td&gt;
      &lt;td&gt;0.833105&lt;/td&gt;
      &lt;td&gt;7.532952&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;1 / df1
&lt;/code&gt;&lt;/pre&gt;
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/style&gt;&lt;/p&gt;
&lt;table border=&#34;1&#34; class=&#34;dataframe&#34;&gt;
  &lt;thead&gt;
    &lt;tr style=&#34;text-align: right;&#34;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;A&lt;/th&gt;
      &lt;th&gt;B&lt;/th&gt;
      &lt;th&gt;C&lt;/th&gt;
      &lt;th&gt;D&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;td&gt;-25.512380&lt;/td&gt;
      &lt;td&gt;-0.743275&lt;/td&gt;
      &lt;td&gt;0.812248&lt;/td&gt;
      &lt;td&gt;-0.826735&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1&lt;/th&gt;
      &lt;td&gt;-6.829445&lt;/td&gt;
      &lt;td&gt;-7.934342&lt;/td&gt;
      &lt;td&gt;20.368024&lt;/td&gt;
      &lt;td&gt;-4.182045&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2&lt;/th&gt;
      &lt;td&gt;-1.357728&lt;/td&gt;
      &lt;td&gt;1.169312&lt;/td&gt;
      &lt;td&gt;0.962279&lt;/td&gt;
      &lt;td&gt;-0.647486&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;3&lt;/th&gt;
      &lt;td&gt;-1.550672&lt;/td&gt;
      &lt;td&gt;-7.181613&lt;/td&gt;
      &lt;td&gt;-0.645633&lt;/td&gt;
      &lt;td&gt;-0.528209&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;4&lt;/th&gt;
      &lt;td&gt;1.309708&lt;/td&gt;
      &lt;td&gt;2.854436&lt;/td&gt;
      &lt;td&gt;-0.774882&lt;/td&gt;
      &lt;td&gt;-32.671034&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;5&lt;/th&gt;
      &lt;td&gt;1.909392&lt;/td&gt;
      &lt;td&gt;0.994821&lt;/td&gt;
      &lt;td&gt;-3.724730&lt;/td&gt;
      &lt;td&gt;-2.839484&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;6&lt;/th&gt;
      &lt;td&gt;0.599716&lt;/td&gt;
      &lt;td&gt;-5.072613&lt;/td&gt;
      &lt;td&gt;0.584570&lt;/td&gt;
      &lt;td&gt;2.426885&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;7&lt;/th&gt;
      &lt;td&gt;-0.534164&lt;/td&gt;
      &lt;td&gt;-0.809823&lt;/td&gt;
      &lt;td&gt;0.835840&lt;/td&gt;
      &lt;td&gt;-2.996133&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;8&lt;/th&gt;
      &lt;td&gt;2.561500&lt;/td&gt;
      &lt;td&gt;0.406658&lt;/td&gt;
      &lt;td&gt;-3.911533&lt;/td&gt;
      &lt;td&gt;-0.457672&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;9&lt;/th&gt;
      &lt;td&gt;0.456221&lt;/td&gt;
      &lt;td&gt;5.126510&lt;/td&gt;
      &lt;td&gt;-4.284876&lt;/td&gt;
      &lt;td&gt;0.903677&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;df1 ** 4
&lt;/code&gt;&lt;/pre&gt;
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/style&gt;&lt;/p&gt;
&lt;table border=&#34;1&#34; class=&#34;dataframe&#34;&gt;
  &lt;thead&gt;
    &lt;tr style=&#34;text-align: right;&#34;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;A&lt;/th&gt;
      &lt;th&gt;B&lt;/th&gt;
      &lt;th&gt;C&lt;/th&gt;
      &lt;th&gt;D&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;td&gt;0.000002&lt;/td&gt;
      &lt;td&gt;3.276439&lt;/td&gt;
      &lt;td&gt;2.297451&lt;/td&gt;
      &lt;td&gt;2.140591e+00&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1&lt;/th&gt;
      &lt;td&gt;0.000460&lt;/td&gt;
      &lt;td&gt;0.000252&lt;/td&gt;
      &lt;td&gt;0.000006&lt;/td&gt;
      &lt;td&gt;3.269227e-03&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2&lt;/th&gt;
      &lt;td&gt;0.294272&lt;/td&gt;
      &lt;td&gt;0.534908&lt;/td&gt;
      &lt;td&gt;1.166261&lt;/td&gt;
      &lt;td&gt;5.689568e+00&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;3&lt;/th&gt;
      &lt;td&gt;0.172950&lt;/td&gt;
      &lt;td&gt;0.000376&lt;/td&gt;
      &lt;td&gt;5.755149&lt;/td&gt;
      &lt;td&gt;1.284627e+01&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;4&lt;/th&gt;
      &lt;td&gt;0.339861&lt;/td&gt;
      &lt;td&gt;0.015063&lt;/td&gt;
      &lt;td&gt;2.773688&lt;/td&gt;
      &lt;td&gt;8.777048e-07&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;5&lt;/th&gt;
      &lt;td&gt;0.075235&lt;/td&gt;
      &lt;td&gt;1.020988&lt;/td&gt;
      &lt;td&gt;0.005195&lt;/td&gt;
      &lt;td&gt;1.538303e-02&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;6&lt;/th&gt;
      &lt;td&gt;7.730677&lt;/td&gt;
      &lt;td&gt;0.001510&lt;/td&gt;
      &lt;td&gt;8.563543&lt;/td&gt;
      &lt;td&gt;2.882727e-02&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;7&lt;/th&gt;
      &lt;td&gt;12.282908&lt;/td&gt;
      &lt;td&gt;2.325086&lt;/td&gt;
      &lt;td&gt;2.048836&lt;/td&gt;
      &lt;td&gt;1.240955e-02&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;8&lt;/th&gt;
      &lt;td&gt;0.023229&lt;/td&gt;
      &lt;td&gt;36.566391&lt;/td&gt;
      &lt;td&gt;0.004272&lt;/td&gt;
      &lt;td&gt;2.279204e+01&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;9&lt;/th&gt;
      &lt;td&gt;23.083358&lt;/td&gt;
      &lt;td&gt;0.001448&lt;/td&gt;
      &lt;td&gt;0.002967&lt;/td&gt;
      &lt;td&gt;1.499503e+00&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;h2 id=&#34;布尔运算&#34;&gt;布尔运算&lt;/h2&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;df1 = pd.DataFrame({&amp;quot;a&amp;quot;: [1, 0, 1], &amp;quot;b&amp;quot;: [0, 1, 1]}, dtype=bool)
df1
&lt;/code&gt;&lt;/pre&gt;
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/style&gt;&lt;/p&gt;
&lt;table border=&#34;1&#34; class=&#34;dataframe&#34;&gt;
  &lt;thead&gt;
    &lt;tr style=&#34;text-align: right;&#34;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;a&lt;/th&gt;
      &lt;th&gt;b&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;td&gt;True&lt;/td&gt;
      &lt;td&gt;False&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1&lt;/th&gt;
      &lt;td&gt;False&lt;/td&gt;
      &lt;td&gt;True&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2&lt;/th&gt;
      &lt;td&gt;True&lt;/td&gt;
      &lt;td&gt;True&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;df2 = pd.DataFrame({&amp;quot;a&amp;quot;: [0, 1, 1], &amp;quot;b&amp;quot;: [1, 1, 0]}, dtype=bool)
df2
&lt;/code&gt;&lt;/pre&gt;
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/style&gt;&lt;/p&gt;
&lt;table border=&#34;1&#34; class=&#34;dataframe&#34;&gt;
  &lt;thead&gt;
    &lt;tr style=&#34;text-align: right;&#34;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;a&lt;/th&gt;
      &lt;th&gt;b&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;td&gt;False&lt;/td&gt;
      &lt;td&gt;True&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1&lt;/th&gt;
      &lt;td&gt;True&lt;/td&gt;
      &lt;td&gt;True&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2&lt;/th&gt;
      &lt;td&gt;True&lt;/td&gt;
      &lt;td&gt;False&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;df1 &amp;amp; df2
&lt;/code&gt;&lt;/pre&gt;
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/style&gt;&lt;/p&gt;
&lt;table border=&#34;1&#34; class=&#34;dataframe&#34;&gt;
  &lt;thead&gt;
    &lt;tr style=&#34;text-align: right;&#34;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;a&lt;/th&gt;
      &lt;th&gt;b&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;td&gt;False&lt;/td&gt;
      &lt;td&gt;False&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1&lt;/th&gt;
      &lt;td&gt;False&lt;/td&gt;
      &lt;td&gt;True&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2&lt;/th&gt;
      &lt;td&gt;True&lt;/td&gt;
      &lt;td&gt;False&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;df1 | df2
&lt;/code&gt;&lt;/pre&gt;
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/style&gt;&lt;/p&gt;
&lt;table border=&#34;1&#34; class=&#34;dataframe&#34;&gt;
  &lt;thead&gt;
    &lt;tr style=&#34;text-align: right;&#34;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;a&lt;/th&gt;
      &lt;th&gt;b&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;td&gt;True&lt;/td&gt;
      &lt;td&gt;True&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1&lt;/th&gt;
      &lt;td&gt;True&lt;/td&gt;
      &lt;td&gt;True&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2&lt;/th&gt;
      &lt;td&gt;True&lt;/td&gt;
      &lt;td&gt;True&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;df1 ^ df2
&lt;/code&gt;&lt;/pre&gt;
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/style&gt;&lt;/p&gt;
&lt;table border=&#34;1&#34; class=&#34;dataframe&#34;&gt;
  &lt;thead&gt;
    &lt;tr style=&#34;text-align: right;&#34;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;a&lt;/th&gt;
      &lt;th&gt;b&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;td&gt;True&lt;/td&gt;
      &lt;td&gt;True&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1&lt;/th&gt;
      &lt;td&gt;True&lt;/td&gt;
      &lt;td&gt;False&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2&lt;/th&gt;
      &lt;td&gt;False&lt;/td&gt;
      &lt;td&gt;True&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;-df1
&lt;/code&gt;&lt;/pre&gt;
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/style&gt;&lt;/p&gt;
&lt;table border=&#34;1&#34; class=&#34;dataframe&#34;&gt;
  &lt;thead&gt;
    &lt;tr style=&#34;text-align: right;&#34;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;a&lt;/th&gt;
      &lt;th&gt;b&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;td&gt;False&lt;/td&gt;
      &lt;td&gt;True&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1&lt;/th&gt;
      &lt;td&gt;True&lt;/td&gt;
      &lt;td&gt;False&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2&lt;/th&gt;
      &lt;td&gt;False&lt;/td&gt;
      &lt;td&gt;False&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;</description>
    </item>
    
    <item>
      <title>pandas 数据对齐</title>
      <link>https://bowenei.gitee.io/learn/pandas/data-alignment/</link>
      <pubDate>Sat, 19 Feb 2022 11:17:40 +0800</pubDate>
      <guid>https://bowenei.gitee.io/learn/pandas/data-alignment/</guid>
      <description>&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;import pandas as pd
import numpy as np
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;广播机制&#34;&gt;广播机制&lt;/h2&gt;
&lt;p&gt;DataFrame 对象之间的数据对齐在列和索引（行标签）上自动对齐。同样，结果对象将得到列和行标签的并集。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;df1 = pd.DataFrame(np.random.randn(10, 4), columns=[&amp;quot;A&amp;quot;, &amp;quot;B&amp;quot;, &amp;quot;C&amp;quot;, &amp;quot;D&amp;quot;])
df1
&lt;/code&gt;&lt;/pre&gt;
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/style&gt;&lt;/p&gt;
&lt;table border=&#34;1&#34; class=&#34;dataframe&#34;&gt;
  &lt;thead&gt;
    &lt;tr style=&#34;text-align: right;&#34;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;A&lt;/th&gt;
      &lt;th&gt;B&lt;/th&gt;
      &lt;th&gt;C&lt;/th&gt;
      &lt;th&gt;D&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;td&gt;-0.205518&lt;/td&gt;
      &lt;td&gt;-1.079244&lt;/td&gt;
      &lt;td&gt;0.466754&lt;/td&gt;
      &lt;td&gt;0.697197&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1&lt;/th&gt;
      &lt;td&gt;0.373488&lt;/td&gt;
      &lt;td&gt;-0.704131&lt;/td&gt;
      &lt;td&gt;-0.562608&lt;/td&gt;
      &lt;td&gt;-0.747020&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2&lt;/th&gt;
      &lt;td&gt;0.727782&lt;/td&gt;
      &lt;td&gt;1.176981&lt;/td&gt;
      &lt;td&gt;1.748998&lt;/td&gt;
      &lt;td&gt;-2.381428&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;3&lt;/th&gt;
      &lt;td&gt;0.693188&lt;/td&gt;
      &lt;td&gt;-0.236861&lt;/td&gt;
      &lt;td&gt;-0.045300&lt;/td&gt;
      &lt;td&gt;1.116772&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;4&lt;/th&gt;
      &lt;td&gt;0.679781&lt;/td&gt;
      &lt;td&gt;-0.113023&lt;/td&gt;
      &lt;td&gt;-0.237897&lt;/td&gt;
      &lt;td&gt;0.991700&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;5&lt;/th&gt;
      &lt;td&gt;0.301815&lt;/td&gt;
      &lt;td&gt;-0.736582&lt;/td&gt;
      &lt;td&gt;-0.327876&lt;/td&gt;
      &lt;td&gt;1.240366&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;6&lt;/th&gt;
      &lt;td&gt;-0.362792&lt;/td&gt;
      &lt;td&gt;0.409796&lt;/td&gt;
      &lt;td&gt;-0.559092&lt;/td&gt;
      &lt;td&gt;1.486711&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;7&lt;/th&gt;
      &lt;td&gt;1.158763&lt;/td&gt;
      &lt;td&gt;2.898433&lt;/td&gt;
      &lt;td&gt;-1.066979&lt;/td&gt;
      &lt;td&gt;1.109399&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;8&lt;/th&gt;
      &lt;td&gt;1.801811&lt;/td&gt;
      &lt;td&gt;-0.150998&lt;/td&gt;
      &lt;td&gt;0.256121&lt;/td&gt;
      &lt;td&gt;0.626933&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;9&lt;/th&gt;
      &lt;td&gt;0.248901&lt;/td&gt;
      &lt;td&gt;-0.846965&lt;/td&gt;
      &lt;td&gt;0.728085&lt;/td&gt;
      &lt;td&gt;-0.302709&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;df2 = pd.DataFrame(np.random.randn(7, 3), columns=[&amp;quot;A&amp;quot;, &amp;quot;B&amp;quot;, &amp;quot;C&amp;quot;])
df2
&lt;/code&gt;&lt;/pre&gt;
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/style&gt;&lt;/p&gt;
&lt;table border=&#34;1&#34; class=&#34;dataframe&#34;&gt;
  &lt;thead&gt;
    &lt;tr style=&#34;text-align: right;&#34;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;A&lt;/th&gt;
      &lt;th&gt;B&lt;/th&gt;
      &lt;th&gt;C&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;td&gt;0.656296&lt;/td&gt;
      &lt;td&gt;0.948401&lt;/td&gt;
      &lt;td&gt;1.203846&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1&lt;/th&gt;
      &lt;td&gt;0.576805&lt;/td&gt;
      &lt;td&gt;2.193866&lt;/td&gt;
      &lt;td&gt;-1.295344&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2&lt;/th&gt;
      &lt;td&gt;0.107251&lt;/td&gt;
      &lt;td&gt;-1.394675&lt;/td&gt;
      &lt;td&gt;1.322735&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;3&lt;/th&gt;
      &lt;td&gt;0.278274&lt;/td&gt;
      &lt;td&gt;-0.398505&lt;/td&gt;
      &lt;td&gt;-0.894721&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;4&lt;/th&gt;
      &lt;td&gt;0.798450&lt;/td&gt;
      &lt;td&gt;-0.817746&lt;/td&gt;
      &lt;td&gt;1.933429&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;5&lt;/th&gt;
      &lt;td&gt;-0.856174&lt;/td&gt;
      &lt;td&gt;0.212137&lt;/td&gt;
      &lt;td&gt;-0.323455&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;6&lt;/th&gt;
      &lt;td&gt;-0.148207&lt;/td&gt;
      &lt;td&gt;2.293063&lt;/td&gt;
      &lt;td&gt;0.164304&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;df1 + df2
&lt;/code&gt;&lt;/pre&gt;
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/style&gt;&lt;/p&gt;
&lt;table border=&#34;1&#34; class=&#34;dataframe&#34;&gt;
  &lt;thead&gt;
    &lt;tr style=&#34;text-align: right;&#34;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;A&lt;/th&gt;
      &lt;th&gt;B&lt;/th&gt;
      &lt;th&gt;C&lt;/th&gt;
      &lt;th&gt;D&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;td&gt;0.450778&lt;/td&gt;
      &lt;td&gt;-0.130843&lt;/td&gt;
      &lt;td&gt;1.670600&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1&lt;/th&gt;
      &lt;td&gt;0.950293&lt;/td&gt;
      &lt;td&gt;1.489735&lt;/td&gt;
      &lt;td&gt;-1.857952&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2&lt;/th&gt;
      &lt;td&gt;0.835033&lt;/td&gt;
      &lt;td&gt;-0.217694&lt;/td&gt;
      &lt;td&gt;3.071733&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;3&lt;/th&gt;
      &lt;td&gt;0.971461&lt;/td&gt;
      &lt;td&gt;-0.635366&lt;/td&gt;
      &lt;td&gt;-0.940020&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;4&lt;/th&gt;
      &lt;td&gt;1.478231&lt;/td&gt;
      &lt;td&gt;-0.930769&lt;/td&gt;
      &lt;td&gt;1.695532&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;5&lt;/th&gt;
      &lt;td&gt;-0.554358&lt;/td&gt;
      &lt;td&gt;-0.524445&lt;/td&gt;
      &lt;td&gt;-0.651331&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;6&lt;/th&gt;
      &lt;td&gt;-0.510998&lt;/td&gt;
      &lt;td&gt;2.702860&lt;/td&gt;
      &lt;td&gt;-0.394789&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;7&lt;/th&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;8&lt;/th&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;9&lt;/th&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;p&gt;在 DataFrame 和 Series 之间执行操作时，默认行为是对齐 DataFrame 列上的 Series 索引，从而按行广播。例如：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;df1 - df1.iloc[0]
&lt;/code&gt;&lt;/pre&gt;
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/style&gt;&lt;/p&gt;
&lt;table border=&#34;1&#34; class=&#34;dataframe&#34;&gt;
  &lt;thead&gt;
    &lt;tr style=&#34;text-align: right;&#34;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;A&lt;/th&gt;
      &lt;th&gt;B&lt;/th&gt;
      &lt;th&gt;C&lt;/th&gt;
      &lt;th&gt;D&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;td&gt;0.000000&lt;/td&gt;
      &lt;td&gt;0.000000&lt;/td&gt;
      &lt;td&gt;0.000000&lt;/td&gt;
      &lt;td&gt;0.000000&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1&lt;/th&gt;
      &lt;td&gt;0.579007&lt;/td&gt;
      &lt;td&gt;0.375113&lt;/td&gt;
      &lt;td&gt;-1.029362&lt;/td&gt;
      &lt;td&gt;-1.444217&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2&lt;/th&gt;
      &lt;td&gt;0.933301&lt;/td&gt;
      &lt;td&gt;2.256226&lt;/td&gt;
      &lt;td&gt;1.282244&lt;/td&gt;
      &lt;td&gt;-3.078625&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;3&lt;/th&gt;
      &lt;td&gt;0.898706&lt;/td&gt;
      &lt;td&gt;0.842383&lt;/td&gt;
      &lt;td&gt;-0.512054&lt;/td&gt;
      &lt;td&gt;0.419576&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;4&lt;/th&gt;
      &lt;td&gt;0.885300&lt;/td&gt;
      &lt;td&gt;0.966221&lt;/td&gt;
      &lt;td&gt;-0.704651&lt;/td&gt;
      &lt;td&gt;0.294503&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;5&lt;/th&gt;
      &lt;td&gt;0.507334&lt;/td&gt;
      &lt;td&gt;0.342662&lt;/td&gt;
      &lt;td&gt;-0.794630&lt;/td&gt;
      &lt;td&gt;0.543169&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;6&lt;/th&gt;
      &lt;td&gt;-0.157273&lt;/td&gt;
      &lt;td&gt;1.489041&lt;/td&gt;
      &lt;td&gt;-1.025846&lt;/td&gt;
      &lt;td&gt;0.789514&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;7&lt;/th&gt;
      &lt;td&gt;1.364281&lt;/td&gt;
      &lt;td&gt;3.977677&lt;/td&gt;
      &lt;td&gt;-1.533733&lt;/td&gt;
      &lt;td&gt;0.412202&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;8&lt;/th&gt;
      &lt;td&gt;2.007330&lt;/td&gt;
      &lt;td&gt;0.928246&lt;/td&gt;
      &lt;td&gt;-0.210632&lt;/td&gt;
      &lt;td&gt;-0.070263&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;9&lt;/th&gt;
      &lt;td&gt;0.454420&lt;/td&gt;
      &lt;td&gt;0.232279&lt;/td&gt;
      &lt;td&gt;0.261331&lt;/td&gt;
      &lt;td&gt;-0.999906&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;</description>
    </item>
    
    <item>
      <title>pandas 合并与连接</title>
      <link>https://bowenei.gitee.io/learn/pandas/concat/</link>
      <pubDate>Sat, 19 Feb 2022 11:18:56 +0800</pubDate>
      <guid>https://bowenei.gitee.io/learn/pandas/concat/</guid>
      <description>&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;import pandas as pd
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;concat-合并多个-dataframe-和-series&#34;&gt;concat: 合并多个 DataFrame 和 Series&lt;/h2&gt;
&lt;h3 id=&#34;垂直合并&#34;&gt;垂直合并&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;df1 = pd.DataFrame({&#39;Name&#39;: [&#39;Sam&#39;, &#39;Emma&#39;], &#39;Age&#39;: [14, 15]})
df2 = pd.DataFrame({&#39;Name&#39;: [&#39;Karen&#39;, &#39;Rahul&#39;], &#39;Age&#39;: [10, 13]})
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;df1
&lt;/code&gt;&lt;/pre&gt;
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/style&gt;&lt;/p&gt;
&lt;table border=&#34;1&#34; class=&#34;dataframe&#34;&gt;
  &lt;thead&gt;
    &lt;tr style=&#34;text-align: right;&#34;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;Name&lt;/th&gt;
      &lt;th&gt;Age&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;td&gt;Sam&lt;/td&gt;
      &lt;td&gt;14&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1&lt;/th&gt;
      &lt;td&gt;Emma&lt;/td&gt;
      &lt;td&gt;15&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;df2
&lt;/code&gt;&lt;/pre&gt;
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/style&gt;&lt;/p&gt;
&lt;table border=&#34;1&#34; class=&#34;dataframe&#34;&gt;
  &lt;thead&gt;
    &lt;tr style=&#34;text-align: right;&#34;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;Name&lt;/th&gt;
      &lt;th&gt;Age&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;td&gt;Karen&lt;/td&gt;
      &lt;td&gt;10&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1&lt;/th&gt;
      &lt;td&gt;Rahul&lt;/td&gt;
      &lt;td&gt;13&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;p&gt;垂直合并即按列合并，一般需要 DataFrame 的 column 完全一致。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;pd.concat([df1, df2])
&lt;/code&gt;&lt;/pre&gt;
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/style&gt;&lt;/p&gt;
&lt;table border=&#34;1&#34; class=&#34;dataframe&#34;&gt;
  &lt;thead&gt;
    &lt;tr style=&#34;text-align: right;&#34;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;Name&lt;/th&gt;
      &lt;th&gt;Age&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;td&gt;Sam&lt;/td&gt;
      &lt;td&gt;14&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1&lt;/th&gt;
      &lt;td&gt;Emma&lt;/td&gt;
      &lt;td&gt;15&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;td&gt;Karen&lt;/td&gt;
      &lt;td&gt;10&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1&lt;/th&gt;
      &lt;td&gt;Rahul&lt;/td&gt;
      &lt;td&gt;13&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;p&gt;不过，上面的结果仍然保留了这些 DataFrame 原来的索引。我们可以重置索引：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;pd.concat([df1, df2]).reset_index(drop=True)
&lt;/code&gt;&lt;/pre&gt;
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/style&gt;&lt;/p&gt;
&lt;table border=&#34;1&#34; class=&#34;dataframe&#34;&gt;
  &lt;thead&gt;
    &lt;tr style=&#34;text-align: right;&#34;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;Name&lt;/th&gt;
      &lt;th&gt;Age&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;td&gt;Sam&lt;/td&gt;
      &lt;td&gt;14&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1&lt;/th&gt;
      &lt;td&gt;Emma&lt;/td&gt;
      &lt;td&gt;15&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2&lt;/th&gt;
      &lt;td&gt;Karen&lt;/td&gt;
      &lt;td&gt;10&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;3&lt;/th&gt;
      &lt;td&gt;Rahul&lt;/td&gt;
      &lt;td&gt;13&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;h3 id=&#34;水平合并&#34;&gt;水平合并&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;df1 = pd.DataFrame({&#39;Name&#39;: [&#39;Sam&#39;, &#39;Emma&#39;], &#39;Age&#39;: [14, 15]})
df2 = pd.DataFrame({&#39;Math&#39;: [&#39;B&#39;, &#39;A+&#39;], &#39;Science&#39;: [&#39;A&#39;, &#39;B+&#39;]})
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;df1
&lt;/code&gt;&lt;/pre&gt;
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/style&gt;&lt;/p&gt;
&lt;table border=&#34;1&#34; class=&#34;dataframe&#34;&gt;
  &lt;thead&gt;
    &lt;tr style=&#34;text-align: right;&#34;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;Name&lt;/th&gt;
      &lt;th&gt;Age&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;td&gt;Sam&lt;/td&gt;
      &lt;td&gt;14&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1&lt;/th&gt;
      &lt;td&gt;Emma&lt;/td&gt;
      &lt;td&gt;15&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;df2
&lt;/code&gt;&lt;/pre&gt;
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/style&gt;&lt;/p&gt;
&lt;table border=&#34;1&#34; class=&#34;dataframe&#34;&gt;
  &lt;thead&gt;
    &lt;tr style=&#34;text-align: right;&#34;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;Math&lt;/th&gt;
      &lt;th&gt;Science&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;td&gt;B&lt;/td&gt;
      &lt;td&gt;A&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1&lt;/th&gt;
      &lt;td&gt;A+&lt;/td&gt;
      &lt;td&gt;B+&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;p&gt;设置 &lt;code&gt;axis=1&lt;/code&gt; 即可实现水平合并，即按行合并，一般要求 DataFrame 的 index 完全一致。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;pd.concat([df1, df2], axis=1)
&lt;/code&gt;&lt;/pre&gt;
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/style&gt;&lt;/p&gt;
&lt;table border=&#34;1&#34; class=&#34;dataframe&#34;&gt;
  &lt;thead&gt;
    &lt;tr style=&#34;text-align: right;&#34;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;Name&lt;/th&gt;
      &lt;th&gt;Age&lt;/th&gt;
      &lt;th&gt;Math&lt;/th&gt;
      &lt;th&gt;Science&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;td&gt;Sam&lt;/td&gt;
      &lt;td&gt;14&lt;/td&gt;
      &lt;td&gt;B&lt;/td&gt;
      &lt;td&gt;A&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1&lt;/th&gt;
      &lt;td&gt;Emma&lt;/td&gt;
      &lt;td&gt;15&lt;/td&gt;
      &lt;td&gt;A+&lt;/td&gt;
      &lt;td&gt;B+&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;h3 id=&#34;设置合并模式&#34;&gt;设置合并模式&lt;/h3&gt;
&lt;p&gt;如果 index 或者 column 不一致，则可以设置连接 &lt;code&gt;join&lt;/code&gt; 的方式。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;outer&lt;/code&gt;：类似于关系代数的外连接运算，没有的内容补 NaN 值。该选项为默认值。&lt;/li&gt;
&lt;li&gt;&lt;code&gt;inner&lt;/code&gt;：类似于关系代数的自然连接运算，先求笛卡尔积中对应相等的元组，再去掉其中重复的属性值。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;注：与关系代数不同的是，&lt;strong&gt;pandas&lt;/strong&gt; 对 DataFrame 的连接可以在 index 和 column 上都可以进行。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;df1 = pd.DataFrame(
    {
        &amp;quot;A&amp;quot;: [&amp;quot;A0&amp;quot;, &amp;quot;A1&amp;quot;, &amp;quot;A2&amp;quot;, &amp;quot;A3&amp;quot;],
        &amp;quot;B&amp;quot;: [&amp;quot;B0&amp;quot;, &amp;quot;B1&amp;quot;, &amp;quot;B2&amp;quot;, &amp;quot;B3&amp;quot;],
        &amp;quot;C&amp;quot;: [&amp;quot;C0&amp;quot;, &amp;quot;C1&amp;quot;, &amp;quot;C2&amp;quot;, &amp;quot;C3&amp;quot;],
        &amp;quot;D&amp;quot;: [&amp;quot;D0&amp;quot;, &amp;quot;D1&amp;quot;, &amp;quot;D2&amp;quot;, &amp;quot;D3&amp;quot;],
    },
    index=[0, 1, 2, 3],
)
df1
&lt;/code&gt;&lt;/pre&gt;
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/style&gt;&lt;/p&gt;
&lt;table border=&#34;1&#34; class=&#34;dataframe&#34;&gt;
  &lt;thead&gt;
    &lt;tr style=&#34;text-align: right;&#34;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;A&lt;/th&gt;
      &lt;th&gt;B&lt;/th&gt;
      &lt;th&gt;C&lt;/th&gt;
      &lt;th&gt;D&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;td&gt;A0&lt;/td&gt;
      &lt;td&gt;B0&lt;/td&gt;
      &lt;td&gt;C0&lt;/td&gt;
      &lt;td&gt;D0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1&lt;/th&gt;
      &lt;td&gt;A1&lt;/td&gt;
      &lt;td&gt;B1&lt;/td&gt;
      &lt;td&gt;C1&lt;/td&gt;
      &lt;td&gt;D1&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2&lt;/th&gt;
      &lt;td&gt;A2&lt;/td&gt;
      &lt;td&gt;B2&lt;/td&gt;
      &lt;td&gt;C2&lt;/td&gt;
      &lt;td&gt;D2&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;3&lt;/th&gt;
      &lt;td&gt;A3&lt;/td&gt;
      &lt;td&gt;B3&lt;/td&gt;
      &lt;td&gt;C3&lt;/td&gt;
      &lt;td&gt;D3&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;df2 = pd.DataFrame(
    {
        &amp;quot;B&amp;quot;: [&amp;quot;B2&amp;quot;, &amp;quot;B3&amp;quot;, &amp;quot;B6&amp;quot;, &amp;quot;B7&amp;quot;],
        &amp;quot;D&amp;quot;: [&amp;quot;D2&amp;quot;, &amp;quot;D3&amp;quot;, &amp;quot;D6&amp;quot;, &amp;quot;D7&amp;quot;],
        &amp;quot;F&amp;quot;: [&amp;quot;F2&amp;quot;, &amp;quot;F3&amp;quot;, &amp;quot;F6&amp;quot;, &amp;quot;F7&amp;quot;],
    },
    index=[2, 3, 6, 7],
)
df2
&lt;/code&gt;&lt;/pre&gt;
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/style&gt;&lt;/p&gt;
&lt;table border=&#34;1&#34; class=&#34;dataframe&#34;&gt;
  &lt;thead&gt;
    &lt;tr style=&#34;text-align: right;&#34;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;B&lt;/th&gt;
      &lt;th&gt;D&lt;/th&gt;
      &lt;th&gt;F&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;2&lt;/th&gt;
      &lt;td&gt;B2&lt;/td&gt;
      &lt;td&gt;D2&lt;/td&gt;
      &lt;td&gt;F2&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;3&lt;/th&gt;
      &lt;td&gt;B3&lt;/td&gt;
      &lt;td&gt;D3&lt;/td&gt;
      &lt;td&gt;F3&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;6&lt;/th&gt;
      &lt;td&gt;B6&lt;/td&gt;
      &lt;td&gt;D6&lt;/td&gt;
      &lt;td&gt;F6&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;7&lt;/th&gt;
      &lt;td&gt;B7&lt;/td&gt;
      &lt;td&gt;D7&lt;/td&gt;
      &lt;td&gt;F7&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;pd.concat([df1, df2], axis=1, join=&#39;outer&#39;)
&lt;/code&gt;&lt;/pre&gt;
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/style&gt;&lt;/p&gt;
&lt;table border=&#34;1&#34; class=&#34;dataframe&#34;&gt;
  &lt;thead&gt;
    &lt;tr style=&#34;text-align: right;&#34;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;A&lt;/th&gt;
      &lt;th&gt;B&lt;/th&gt;
      &lt;th&gt;C&lt;/th&gt;
      &lt;th&gt;D&lt;/th&gt;
      &lt;th&gt;B&lt;/th&gt;
      &lt;th&gt;D&lt;/th&gt;
      &lt;th&gt;F&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;td&gt;A0&lt;/td&gt;
      &lt;td&gt;B0&lt;/td&gt;
      &lt;td&gt;C0&lt;/td&gt;
      &lt;td&gt;D0&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1&lt;/th&gt;
      &lt;td&gt;A1&lt;/td&gt;
      &lt;td&gt;B1&lt;/td&gt;
      &lt;td&gt;C1&lt;/td&gt;
      &lt;td&gt;D1&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2&lt;/th&gt;
      &lt;td&gt;A2&lt;/td&gt;
      &lt;td&gt;B2&lt;/td&gt;
      &lt;td&gt;C2&lt;/td&gt;
      &lt;td&gt;D2&lt;/td&gt;
      &lt;td&gt;B2&lt;/td&gt;
      &lt;td&gt;D2&lt;/td&gt;
      &lt;td&gt;F2&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;3&lt;/th&gt;
      &lt;td&gt;A3&lt;/td&gt;
      &lt;td&gt;B3&lt;/td&gt;
      &lt;td&gt;C3&lt;/td&gt;
      &lt;td&gt;D3&lt;/td&gt;
      &lt;td&gt;B3&lt;/td&gt;
      &lt;td&gt;D3&lt;/td&gt;
      &lt;td&gt;F3&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;6&lt;/th&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;B6&lt;/td&gt;
      &lt;td&gt;D6&lt;/td&gt;
      &lt;td&gt;F6&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;7&lt;/th&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;B7&lt;/td&gt;
      &lt;td&gt;D7&lt;/td&gt;
      &lt;td&gt;F7&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;pd.concat([df1, df2], axis=1, join=&#39;inner&#39;)
&lt;/code&gt;&lt;/pre&gt;
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/style&gt;&lt;/p&gt;
&lt;table border=&#34;1&#34; class=&#34;dataframe&#34;&gt;
  &lt;thead&gt;
    &lt;tr style=&#34;text-align: right;&#34;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;A&lt;/th&gt;
      &lt;th&gt;B&lt;/th&gt;
      &lt;th&gt;C&lt;/th&gt;
      &lt;th&gt;D&lt;/th&gt;
      &lt;th&gt;B&lt;/th&gt;
      &lt;th&gt;D&lt;/th&gt;
      &lt;th&gt;F&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;2&lt;/th&gt;
      &lt;td&gt;A2&lt;/td&gt;
      &lt;td&gt;B2&lt;/td&gt;
      &lt;td&gt;C2&lt;/td&gt;
      &lt;td&gt;D2&lt;/td&gt;
      &lt;td&gt;B2&lt;/td&gt;
      &lt;td&gt;D2&lt;/td&gt;
      &lt;td&gt;F2&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;3&lt;/th&gt;
      &lt;td&gt;A3&lt;/td&gt;
      &lt;td&gt;B3&lt;/td&gt;
      &lt;td&gt;C3&lt;/td&gt;
      &lt;td&gt;D3&lt;/td&gt;
      &lt;td&gt;B3&lt;/td&gt;
      &lt;td&gt;D3&lt;/td&gt;
      &lt;td&gt;F3&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;pd.concat([df1, df2], axis=0, join=&#39;outer&#39;)
&lt;/code&gt;&lt;/pre&gt;
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/style&gt;&lt;/p&gt;
&lt;table border=&#34;1&#34; class=&#34;dataframe&#34;&gt;
  &lt;thead&gt;
    &lt;tr style=&#34;text-align: right;&#34;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;A&lt;/th&gt;
      &lt;th&gt;B&lt;/th&gt;
      &lt;th&gt;C&lt;/th&gt;
      &lt;th&gt;D&lt;/th&gt;
      &lt;th&gt;F&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;td&gt;A0&lt;/td&gt;
      &lt;td&gt;B0&lt;/td&gt;
      &lt;td&gt;C0&lt;/td&gt;
      &lt;td&gt;D0&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1&lt;/th&gt;
      &lt;td&gt;A1&lt;/td&gt;
      &lt;td&gt;B1&lt;/td&gt;
      &lt;td&gt;C1&lt;/td&gt;
      &lt;td&gt;D1&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2&lt;/th&gt;
      &lt;td&gt;A2&lt;/td&gt;
      &lt;td&gt;B2&lt;/td&gt;
      &lt;td&gt;C2&lt;/td&gt;
      &lt;td&gt;D2&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;3&lt;/th&gt;
      &lt;td&gt;A3&lt;/td&gt;
      &lt;td&gt;B3&lt;/td&gt;
      &lt;td&gt;C3&lt;/td&gt;
      &lt;td&gt;D3&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2&lt;/th&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;B2&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;D2&lt;/td&gt;
      &lt;td&gt;F2&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;3&lt;/th&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;B3&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;D3&lt;/td&gt;
      &lt;td&gt;F3&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;6&lt;/th&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;B6&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;D6&lt;/td&gt;
      &lt;td&gt;F6&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;7&lt;/th&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;B7&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;D7&lt;/td&gt;
      &lt;td&gt;F7&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;pd.concat([df1, df2], axis=0, join=&#39;inner&#39;)
&lt;/code&gt;&lt;/pre&gt;
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/style&gt;&lt;/p&gt;
&lt;table border=&#34;1&#34; class=&#34;dataframe&#34;&gt;
  &lt;thead&gt;
    &lt;tr style=&#34;text-align: right;&#34;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;B&lt;/th&gt;
      &lt;th&gt;D&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;td&gt;B0&lt;/td&gt;
      &lt;td&gt;D0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1&lt;/th&gt;
      &lt;td&gt;B1&lt;/td&gt;
      &lt;td&gt;D1&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2&lt;/th&gt;
      &lt;td&gt;B2&lt;/td&gt;
      &lt;td&gt;D2&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;3&lt;/th&gt;
      &lt;td&gt;B3&lt;/td&gt;
      &lt;td&gt;D3&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2&lt;/th&gt;
      &lt;td&gt;B2&lt;/td&gt;
      &lt;td&gt;D2&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;3&lt;/th&gt;
      &lt;td&gt;B3&lt;/td&gt;
      &lt;td&gt;D3&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;6&lt;/th&gt;
      &lt;td&gt;B6&lt;/td&gt;
      &lt;td&gt;D6&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;7&lt;/th&gt;
      &lt;td&gt;B7&lt;/td&gt;
      &lt;td&gt;D7&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;p&gt;可以设置忽略 index，index 将按照顺序递增。这样就和关系代数中的连接运算完全一致了。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;pd.concat([df1, df2], ignore_index=True)
&lt;/code&gt;&lt;/pre&gt;
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/style&gt;&lt;/p&gt;
&lt;table border=&#34;1&#34; class=&#34;dataframe&#34;&gt;
  &lt;thead&gt;
    &lt;tr style=&#34;text-align: right;&#34;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;A&lt;/th&gt;
      &lt;th&gt;B&lt;/th&gt;
      &lt;th&gt;C&lt;/th&gt;
      &lt;th&gt;D&lt;/th&gt;
      &lt;th&gt;F&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;td&gt;A0&lt;/td&gt;
      &lt;td&gt;B0&lt;/td&gt;
      &lt;td&gt;C0&lt;/td&gt;
      &lt;td&gt;D0&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1&lt;/th&gt;
      &lt;td&gt;A1&lt;/td&gt;
      &lt;td&gt;B1&lt;/td&gt;
      &lt;td&gt;C1&lt;/td&gt;
      &lt;td&gt;D1&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2&lt;/th&gt;
      &lt;td&gt;A2&lt;/td&gt;
      &lt;td&gt;B2&lt;/td&gt;
      &lt;td&gt;C2&lt;/td&gt;
      &lt;td&gt;D2&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;3&lt;/th&gt;
      &lt;td&gt;A3&lt;/td&gt;
      &lt;td&gt;B3&lt;/td&gt;
      &lt;td&gt;C3&lt;/td&gt;
      &lt;td&gt;D3&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;4&lt;/th&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;B2&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;D2&lt;/td&gt;
      &lt;td&gt;F2&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;5&lt;/th&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;B3&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;D3&lt;/td&gt;
      &lt;td&gt;F3&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;6&lt;/th&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;B6&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;D6&lt;/td&gt;
      &lt;td&gt;F6&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;7&lt;/th&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;B7&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;D7&lt;/td&gt;
      &lt;td&gt;F7&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;h3 id=&#34;dataframe-和-series-可以直接合并&#34;&gt;DataFrame 和 Series 可以直接合并&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;s = pd.Series([&amp;quot;X0&amp;quot;, &amp;quot;X1&amp;quot;, &amp;quot;X2&amp;quot;, &amp;quot;X3&amp;quot;], name=&amp;quot;X&amp;quot;)
s
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;0    X0
1    X1
2    X2
3    X3
Name: X, dtype: object
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;pd.concat([df1, s], axis=1)
&lt;/code&gt;&lt;/pre&gt;
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/style&gt;&lt;/p&gt;
&lt;table border=&#34;1&#34; class=&#34;dataframe&#34;&gt;
  &lt;thead&gt;
    &lt;tr style=&#34;text-align: right;&#34;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;A&lt;/th&gt;
      &lt;th&gt;B&lt;/th&gt;
      &lt;th&gt;C&lt;/th&gt;
      &lt;th&gt;D&lt;/th&gt;
      &lt;th&gt;X&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;td&gt;A0&lt;/td&gt;
      &lt;td&gt;B0&lt;/td&gt;
      &lt;td&gt;C0&lt;/td&gt;
      &lt;td&gt;D0&lt;/td&gt;
      &lt;td&gt;X0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1&lt;/th&gt;
      &lt;td&gt;A1&lt;/td&gt;
      &lt;td&gt;B1&lt;/td&gt;
      &lt;td&gt;C1&lt;/td&gt;
      &lt;td&gt;D1&lt;/td&gt;
      &lt;td&gt;X1&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2&lt;/th&gt;
      &lt;td&gt;A2&lt;/td&gt;
      &lt;td&gt;B2&lt;/td&gt;
      &lt;td&gt;C2&lt;/td&gt;
      &lt;td&gt;D2&lt;/td&gt;
      &lt;td&gt;X2&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;3&lt;/th&gt;
      &lt;td&gt;A3&lt;/td&gt;
      &lt;td&gt;B3&lt;/td&gt;
      &lt;td&gt;C3&lt;/td&gt;
      &lt;td&gt;D3&lt;/td&gt;
      &lt;td&gt;X3&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;h2 id=&#34;merge-功能更强大的数据库连接操作&#34;&gt;merge: 功能更强大的数据库连接操作&lt;/h2&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;left = pd.DataFrame(
    {
        &amp;quot;key&amp;quot;: [&amp;quot;K0&amp;quot;, &amp;quot;K1&amp;quot;, &amp;quot;K2&amp;quot;, &amp;quot;K3&amp;quot;],
        &amp;quot;A&amp;quot;: [&amp;quot;A0&amp;quot;, &amp;quot;A1&amp;quot;, &amp;quot;A2&amp;quot;, &amp;quot;A3&amp;quot;],
        &amp;quot;B&amp;quot;: [&amp;quot;B0&amp;quot;, &amp;quot;B1&amp;quot;, &amp;quot;B2&amp;quot;, &amp;quot;B3&amp;quot;],
    }
)
left
&lt;/code&gt;&lt;/pre&gt;
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/style&gt;&lt;/p&gt;
&lt;table border=&#34;1&#34; class=&#34;dataframe&#34;&gt;
  &lt;thead&gt;
    &lt;tr style=&#34;text-align: right;&#34;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;key&lt;/th&gt;
      &lt;th&gt;A&lt;/th&gt;
      &lt;th&gt;B&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;td&gt;K0&lt;/td&gt;
      &lt;td&gt;A0&lt;/td&gt;
      &lt;td&gt;B0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1&lt;/th&gt;
      &lt;td&gt;K1&lt;/td&gt;
      &lt;td&gt;A1&lt;/td&gt;
      &lt;td&gt;B1&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2&lt;/th&gt;
      &lt;td&gt;K2&lt;/td&gt;
      &lt;td&gt;A2&lt;/td&gt;
      &lt;td&gt;B2&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;3&lt;/th&gt;
      &lt;td&gt;K3&lt;/td&gt;
      &lt;td&gt;A3&lt;/td&gt;
      &lt;td&gt;B3&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;right = pd.DataFrame(
    {
        &amp;quot;key&amp;quot;: [&amp;quot;K0&amp;quot;, &amp;quot;K1&amp;quot;, &amp;quot;K2&amp;quot;, &amp;quot;K3&amp;quot;],
        &amp;quot;C&amp;quot;: [&amp;quot;C0&amp;quot;, &amp;quot;C1&amp;quot;, &amp;quot;C2&amp;quot;, &amp;quot;C3&amp;quot;],
        &amp;quot;D&amp;quot;: [&amp;quot;D0&amp;quot;, &amp;quot;D1&amp;quot;, &amp;quot;D2&amp;quot;, &amp;quot;D3&amp;quot;],
    }
)
right
&lt;/code&gt;&lt;/pre&gt;
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/style&gt;&lt;/p&gt;
&lt;table border=&#34;1&#34; class=&#34;dataframe&#34;&gt;
  &lt;thead&gt;
    &lt;tr style=&#34;text-align: right;&#34;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;key&lt;/th&gt;
      &lt;th&gt;C&lt;/th&gt;
      &lt;th&gt;D&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;td&gt;K0&lt;/td&gt;
      &lt;td&gt;C0&lt;/td&gt;
      &lt;td&gt;D0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1&lt;/th&gt;
      &lt;td&gt;K1&lt;/td&gt;
      &lt;td&gt;C1&lt;/td&gt;
      &lt;td&gt;D1&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2&lt;/th&gt;
      &lt;td&gt;K2&lt;/td&gt;
      &lt;td&gt;C2&lt;/td&gt;
      &lt;td&gt;D2&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;3&lt;/th&gt;
      &lt;td&gt;K3&lt;/td&gt;
      &lt;td&gt;C3&lt;/td&gt;
      &lt;td&gt;D3&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;pd.merge(left, right, on=&#39;key&#39;)
&lt;/code&gt;&lt;/pre&gt;
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/style&gt;&lt;/p&gt;
&lt;table border=&#34;1&#34; class=&#34;dataframe&#34;&gt;
  &lt;thead&gt;
    &lt;tr style=&#34;text-align: right;&#34;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;key&lt;/th&gt;
      &lt;th&gt;A&lt;/th&gt;
      &lt;th&gt;B&lt;/th&gt;
      &lt;th&gt;C&lt;/th&gt;
      &lt;th&gt;D&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;td&gt;K0&lt;/td&gt;
      &lt;td&gt;A0&lt;/td&gt;
      &lt;td&gt;B0&lt;/td&gt;
      &lt;td&gt;C0&lt;/td&gt;
      &lt;td&gt;D0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1&lt;/th&gt;
      &lt;td&gt;K1&lt;/td&gt;
      &lt;td&gt;A1&lt;/td&gt;
      &lt;td&gt;B1&lt;/td&gt;
      &lt;td&gt;C1&lt;/td&gt;
      &lt;td&gt;D1&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2&lt;/th&gt;
      &lt;td&gt;K2&lt;/td&gt;
      &lt;td&gt;A2&lt;/td&gt;
      &lt;td&gt;B2&lt;/td&gt;
      &lt;td&gt;C2&lt;/td&gt;
      &lt;td&gt;D2&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;3&lt;/th&gt;
      &lt;td&gt;K3&lt;/td&gt;
      &lt;td&gt;A3&lt;/td&gt;
      &lt;td&gt;B3&lt;/td&gt;
      &lt;td&gt;C3&lt;/td&gt;
      &lt;td&gt;D3&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;h3 id=&#34;连接方式&#34;&gt;连接方式&lt;/h3&gt;
&lt;p&gt;&lt;code&gt;merge&lt;/code&gt; 可以实现关系代数当中的除自然连接和外连接更强大的连接操作。因此，它的 &lt;code&gt;how&lt;/code&gt; 参数支持如下五种运算：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;outer&lt;/code&gt;：外连接&lt;/li&gt;
&lt;li&gt;&lt;code&gt;inner&lt;/code&gt;：自然连接&lt;/li&gt;
&lt;li&gt;&lt;code&gt;left&lt;/code&gt;：左连接&lt;/li&gt;
&lt;li&gt;&lt;code&gt;right&lt;/code&gt;：右连接&lt;/li&gt;
&lt;li&gt;&lt;code&gt;cross&lt;/code&gt;：笛卡尔积&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;这种运算要求左表和右表有交叉点 &lt;code&gt;intersection&lt;/code&gt; 存在，因此连接方式默认值为 &lt;code&gt;inner&lt;/code&gt;。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;left = pd.DataFrame(
    {
        &amp;quot;key1&amp;quot;: [&amp;quot;K0&amp;quot;, &amp;quot;K0&amp;quot;, &amp;quot;K1&amp;quot;, &amp;quot;K2&amp;quot;],
        &amp;quot;key2&amp;quot;: [&amp;quot;K0&amp;quot;, &amp;quot;K1&amp;quot;, &amp;quot;K0&amp;quot;, &amp;quot;K1&amp;quot;],
        &amp;quot;A&amp;quot;: [&amp;quot;A0&amp;quot;, &amp;quot;A1&amp;quot;, &amp;quot;A2&amp;quot;, &amp;quot;A3&amp;quot;],
        &amp;quot;B&amp;quot;: [&amp;quot;B0&amp;quot;, &amp;quot;B1&amp;quot;, &amp;quot;B2&amp;quot;, &amp;quot;B3&amp;quot;],
    }
)
left
&lt;/code&gt;&lt;/pre&gt;
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/style&gt;&lt;/p&gt;
&lt;table border=&#34;1&#34; class=&#34;dataframe&#34;&gt;
  &lt;thead&gt;
    &lt;tr style=&#34;text-align: right;&#34;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;key1&lt;/th&gt;
      &lt;th&gt;key2&lt;/th&gt;
      &lt;th&gt;A&lt;/th&gt;
      &lt;th&gt;B&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;td&gt;K0&lt;/td&gt;
      &lt;td&gt;K0&lt;/td&gt;
      &lt;td&gt;A0&lt;/td&gt;
      &lt;td&gt;B0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1&lt;/th&gt;
      &lt;td&gt;K0&lt;/td&gt;
      &lt;td&gt;K1&lt;/td&gt;
      &lt;td&gt;A1&lt;/td&gt;
      &lt;td&gt;B1&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2&lt;/th&gt;
      &lt;td&gt;K1&lt;/td&gt;
      &lt;td&gt;K0&lt;/td&gt;
      &lt;td&gt;A2&lt;/td&gt;
      &lt;td&gt;B2&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;3&lt;/th&gt;
      &lt;td&gt;K2&lt;/td&gt;
      &lt;td&gt;K1&lt;/td&gt;
      &lt;td&gt;A3&lt;/td&gt;
      &lt;td&gt;B3&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;right = pd.DataFrame(
    {
        &amp;quot;key1&amp;quot;: [&amp;quot;K0&amp;quot;, &amp;quot;K1&amp;quot;, &amp;quot;K1&amp;quot;, &amp;quot;K2&amp;quot;],
        &amp;quot;key2&amp;quot;: [&amp;quot;K0&amp;quot;, &amp;quot;K0&amp;quot;, &amp;quot;K0&amp;quot;, &amp;quot;K0&amp;quot;],
        &amp;quot;C&amp;quot;: [&amp;quot;C0&amp;quot;, &amp;quot;C1&amp;quot;, &amp;quot;C2&amp;quot;, &amp;quot;C3&amp;quot;],
        &amp;quot;D&amp;quot;: [&amp;quot;D0&amp;quot;, &amp;quot;D1&amp;quot;, &amp;quot;D2&amp;quot;, &amp;quot;D3&amp;quot;],
    }
)
right
&lt;/code&gt;&lt;/pre&gt;
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/style&gt;&lt;/p&gt;
&lt;table border=&#34;1&#34; class=&#34;dataframe&#34;&gt;
  &lt;thead&gt;
    &lt;tr style=&#34;text-align: right;&#34;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;key1&lt;/th&gt;
      &lt;th&gt;key2&lt;/th&gt;
      &lt;th&gt;C&lt;/th&gt;
      &lt;th&gt;D&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;td&gt;K0&lt;/td&gt;
      &lt;td&gt;K0&lt;/td&gt;
      &lt;td&gt;C0&lt;/td&gt;
      &lt;td&gt;D0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1&lt;/th&gt;
      &lt;td&gt;K1&lt;/td&gt;
      &lt;td&gt;K0&lt;/td&gt;
      &lt;td&gt;C1&lt;/td&gt;
      &lt;td&gt;D1&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2&lt;/th&gt;
      &lt;td&gt;K1&lt;/td&gt;
      &lt;td&gt;K0&lt;/td&gt;
      &lt;td&gt;C2&lt;/td&gt;
      &lt;td&gt;D2&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;3&lt;/th&gt;
      &lt;td&gt;K2&lt;/td&gt;
      &lt;td&gt;K0&lt;/td&gt;
      &lt;td&gt;C3&lt;/td&gt;
      &lt;td&gt;D3&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;p&gt;这个例子是由两个字段组成主码的表的连接操作。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;pd.merge(left, right, on=[&amp;quot;key1&amp;quot;, &amp;quot;key2&amp;quot;])
&lt;/code&gt;&lt;/pre&gt;
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/style&gt;&lt;/p&gt;
&lt;table border=&#34;1&#34; class=&#34;dataframe&#34;&gt;
  &lt;thead&gt;
    &lt;tr style=&#34;text-align: right;&#34;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;key1&lt;/th&gt;
      &lt;th&gt;key2&lt;/th&gt;
      &lt;th&gt;A&lt;/th&gt;
      &lt;th&gt;B&lt;/th&gt;
      &lt;th&gt;C&lt;/th&gt;
      &lt;th&gt;D&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;td&gt;K0&lt;/td&gt;
      &lt;td&gt;K0&lt;/td&gt;
      &lt;td&gt;A0&lt;/td&gt;
      &lt;td&gt;B0&lt;/td&gt;
      &lt;td&gt;C0&lt;/td&gt;
      &lt;td&gt;D0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1&lt;/th&gt;
      &lt;td&gt;K1&lt;/td&gt;
      &lt;td&gt;K0&lt;/td&gt;
      &lt;td&gt;A2&lt;/td&gt;
      &lt;td&gt;B2&lt;/td&gt;
      &lt;td&gt;C1&lt;/td&gt;
      &lt;td&gt;D1&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2&lt;/th&gt;
      &lt;td&gt;K1&lt;/td&gt;
      &lt;td&gt;K0&lt;/td&gt;
      &lt;td&gt;A2&lt;/td&gt;
      &lt;td&gt;B2&lt;/td&gt;
      &lt;td&gt;C2&lt;/td&gt;
      &lt;td&gt;D2&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;h4 id=&#34;自然连接&#34;&gt;自然连接&lt;/h4&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;pd.merge(left, right, how=&amp;quot;inner&amp;quot;, on=[&amp;quot;key1&amp;quot;, &amp;quot;key2&amp;quot;])
&lt;/code&gt;&lt;/pre&gt;
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/style&gt;&lt;/p&gt;
&lt;table border=&#34;1&#34; class=&#34;dataframe&#34;&gt;
  &lt;thead&gt;
    &lt;tr style=&#34;text-align: right;&#34;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;key1&lt;/th&gt;
      &lt;th&gt;key2&lt;/th&gt;
      &lt;th&gt;A&lt;/th&gt;
      &lt;th&gt;B&lt;/th&gt;
      &lt;th&gt;C&lt;/th&gt;
      &lt;th&gt;D&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;td&gt;K0&lt;/td&gt;
      &lt;td&gt;K0&lt;/td&gt;
      &lt;td&gt;A0&lt;/td&gt;
      &lt;td&gt;B0&lt;/td&gt;
      &lt;td&gt;C0&lt;/td&gt;
      &lt;td&gt;D0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1&lt;/th&gt;
      &lt;td&gt;K1&lt;/td&gt;
      &lt;td&gt;K0&lt;/td&gt;
      &lt;td&gt;A2&lt;/td&gt;
      &lt;td&gt;B2&lt;/td&gt;
      &lt;td&gt;C1&lt;/td&gt;
      &lt;td&gt;D1&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2&lt;/th&gt;
      &lt;td&gt;K1&lt;/td&gt;
      &lt;td&gt;K0&lt;/td&gt;
      &lt;td&gt;A2&lt;/td&gt;
      &lt;td&gt;B2&lt;/td&gt;
      &lt;td&gt;C2&lt;/td&gt;
      &lt;td&gt;D2&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;h4 id=&#34;外连接&#34;&gt;外连接&lt;/h4&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;pd.merge(left, right, how=&amp;quot;outer&amp;quot;, on=[&amp;quot;key1&amp;quot;, &amp;quot;key2&amp;quot;])
&lt;/code&gt;&lt;/pre&gt;
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/style&gt;&lt;/p&gt;
&lt;table border=&#34;1&#34; class=&#34;dataframe&#34;&gt;
  &lt;thead&gt;
    &lt;tr style=&#34;text-align: right;&#34;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;key1&lt;/th&gt;
      &lt;th&gt;key2&lt;/th&gt;
      &lt;th&gt;A&lt;/th&gt;
      &lt;th&gt;B&lt;/th&gt;
      &lt;th&gt;C&lt;/th&gt;
      &lt;th&gt;D&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;td&gt;K0&lt;/td&gt;
      &lt;td&gt;K0&lt;/td&gt;
      &lt;td&gt;A0&lt;/td&gt;
      &lt;td&gt;B0&lt;/td&gt;
      &lt;td&gt;C0&lt;/td&gt;
      &lt;td&gt;D0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1&lt;/th&gt;
      &lt;td&gt;K0&lt;/td&gt;
      &lt;td&gt;K1&lt;/td&gt;
      &lt;td&gt;A1&lt;/td&gt;
      &lt;td&gt;B1&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2&lt;/th&gt;
      &lt;td&gt;K1&lt;/td&gt;
      &lt;td&gt;K0&lt;/td&gt;
      &lt;td&gt;A2&lt;/td&gt;
      &lt;td&gt;B2&lt;/td&gt;
      &lt;td&gt;C1&lt;/td&gt;
      &lt;td&gt;D1&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;3&lt;/th&gt;
      &lt;td&gt;K1&lt;/td&gt;
      &lt;td&gt;K0&lt;/td&gt;
      &lt;td&gt;A2&lt;/td&gt;
      &lt;td&gt;B2&lt;/td&gt;
      &lt;td&gt;C2&lt;/td&gt;
      &lt;td&gt;D2&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;4&lt;/th&gt;
      &lt;td&gt;K2&lt;/td&gt;
      &lt;td&gt;K1&lt;/td&gt;
      &lt;td&gt;A3&lt;/td&gt;
      &lt;td&gt;B3&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;5&lt;/th&gt;
      &lt;td&gt;K2&lt;/td&gt;
      &lt;td&gt;K0&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;C3&lt;/td&gt;
      &lt;td&gt;D3&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;h4 id=&#34;左连接&#34;&gt;左连接&lt;/h4&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;pd.merge(left, right, how=&amp;quot;left&amp;quot;, on=[&amp;quot;key1&amp;quot;, &amp;quot;key2&amp;quot;])
&lt;/code&gt;&lt;/pre&gt;
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/style&gt;&lt;/p&gt;
&lt;table border=&#34;1&#34; class=&#34;dataframe&#34;&gt;
  &lt;thead&gt;
    &lt;tr style=&#34;text-align: right;&#34;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;key1&lt;/th&gt;
      &lt;th&gt;key2&lt;/th&gt;
      &lt;th&gt;A&lt;/th&gt;
      &lt;th&gt;B&lt;/th&gt;
      &lt;th&gt;C&lt;/th&gt;
      &lt;th&gt;D&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;td&gt;K0&lt;/td&gt;
      &lt;td&gt;K0&lt;/td&gt;
      &lt;td&gt;A0&lt;/td&gt;
      &lt;td&gt;B0&lt;/td&gt;
      &lt;td&gt;C0&lt;/td&gt;
      &lt;td&gt;D0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1&lt;/th&gt;
      &lt;td&gt;K0&lt;/td&gt;
      &lt;td&gt;K1&lt;/td&gt;
      &lt;td&gt;A1&lt;/td&gt;
      &lt;td&gt;B1&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2&lt;/th&gt;
      &lt;td&gt;K1&lt;/td&gt;
      &lt;td&gt;K0&lt;/td&gt;
      &lt;td&gt;A2&lt;/td&gt;
      &lt;td&gt;B2&lt;/td&gt;
      &lt;td&gt;C1&lt;/td&gt;
      &lt;td&gt;D1&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;3&lt;/th&gt;
      &lt;td&gt;K1&lt;/td&gt;
      &lt;td&gt;K0&lt;/td&gt;
      &lt;td&gt;A2&lt;/td&gt;
      &lt;td&gt;B2&lt;/td&gt;
      &lt;td&gt;C2&lt;/td&gt;
      &lt;td&gt;D2&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;4&lt;/th&gt;
      &lt;td&gt;K2&lt;/td&gt;
      &lt;td&gt;K1&lt;/td&gt;
      &lt;td&gt;A3&lt;/td&gt;
      &lt;td&gt;B3&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;h4 id=&#34;右连接&#34;&gt;右连接&lt;/h4&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;pd.merge(left, right, how=&amp;quot;right&amp;quot;, on=[&amp;quot;key1&amp;quot;, &amp;quot;key2&amp;quot;])
&lt;/code&gt;&lt;/pre&gt;
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/style&gt;&lt;/p&gt;
&lt;table border=&#34;1&#34; class=&#34;dataframe&#34;&gt;
  &lt;thead&gt;
    &lt;tr style=&#34;text-align: right;&#34;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;key1&lt;/th&gt;
      &lt;th&gt;key2&lt;/th&gt;
      &lt;th&gt;A&lt;/th&gt;
      &lt;th&gt;B&lt;/th&gt;
      &lt;th&gt;C&lt;/th&gt;
      &lt;th&gt;D&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;td&gt;K0&lt;/td&gt;
      &lt;td&gt;K0&lt;/td&gt;
      &lt;td&gt;A0&lt;/td&gt;
      &lt;td&gt;B0&lt;/td&gt;
      &lt;td&gt;C0&lt;/td&gt;
      &lt;td&gt;D0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1&lt;/th&gt;
      &lt;td&gt;K1&lt;/td&gt;
      &lt;td&gt;K0&lt;/td&gt;
      &lt;td&gt;A2&lt;/td&gt;
      &lt;td&gt;B2&lt;/td&gt;
      &lt;td&gt;C1&lt;/td&gt;
      &lt;td&gt;D1&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2&lt;/th&gt;
      &lt;td&gt;K1&lt;/td&gt;
      &lt;td&gt;K0&lt;/td&gt;
      &lt;td&gt;A2&lt;/td&gt;
      &lt;td&gt;B2&lt;/td&gt;
      &lt;td&gt;C2&lt;/td&gt;
      &lt;td&gt;D2&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;3&lt;/th&gt;
      &lt;td&gt;K2&lt;/td&gt;
      &lt;td&gt;K0&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;C3&lt;/td&gt;
      &lt;td&gt;D3&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;h4 id=&#34;笛卡尔积&#34;&gt;笛卡尔积&lt;/h4&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;pd.merge(left, right, how=&amp;quot;cross&amp;quot;)
&lt;/code&gt;&lt;/pre&gt;
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/style&gt;&lt;/p&gt;
&lt;table border=&#34;1&#34; class=&#34;dataframe&#34;&gt;
  &lt;thead&gt;
    &lt;tr style=&#34;text-align: right;&#34;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;key1_x&lt;/th&gt;
      &lt;th&gt;key2_x&lt;/th&gt;
      &lt;th&gt;A&lt;/th&gt;
      &lt;th&gt;B&lt;/th&gt;
      &lt;th&gt;key1_y&lt;/th&gt;
      &lt;th&gt;key2_y&lt;/th&gt;
      &lt;th&gt;C&lt;/th&gt;
      &lt;th&gt;D&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;td&gt;K0&lt;/td&gt;
      &lt;td&gt;K0&lt;/td&gt;
      &lt;td&gt;A0&lt;/td&gt;
      &lt;td&gt;B0&lt;/td&gt;
      &lt;td&gt;K0&lt;/td&gt;
      &lt;td&gt;K0&lt;/td&gt;
      &lt;td&gt;C0&lt;/td&gt;
      &lt;td&gt;D0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1&lt;/th&gt;
      &lt;td&gt;K0&lt;/td&gt;
      &lt;td&gt;K0&lt;/td&gt;
      &lt;td&gt;A0&lt;/td&gt;
      &lt;td&gt;B0&lt;/td&gt;
      &lt;td&gt;K1&lt;/td&gt;
      &lt;td&gt;K0&lt;/td&gt;
      &lt;td&gt;C1&lt;/td&gt;
      &lt;td&gt;D1&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2&lt;/th&gt;
      &lt;td&gt;K0&lt;/td&gt;
      &lt;td&gt;K0&lt;/td&gt;
      &lt;td&gt;A0&lt;/td&gt;
      &lt;td&gt;B0&lt;/td&gt;
      &lt;td&gt;K1&lt;/td&gt;
      &lt;td&gt;K0&lt;/td&gt;
      &lt;td&gt;C2&lt;/td&gt;
      &lt;td&gt;D2&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;3&lt;/th&gt;
      &lt;td&gt;K0&lt;/td&gt;
      &lt;td&gt;K0&lt;/td&gt;
      &lt;td&gt;A0&lt;/td&gt;
      &lt;td&gt;B0&lt;/td&gt;
      &lt;td&gt;K2&lt;/td&gt;
      &lt;td&gt;K0&lt;/td&gt;
      &lt;td&gt;C3&lt;/td&gt;
      &lt;td&gt;D3&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;4&lt;/th&gt;
      &lt;td&gt;K0&lt;/td&gt;
      &lt;td&gt;K1&lt;/td&gt;
      &lt;td&gt;A1&lt;/td&gt;
      &lt;td&gt;B1&lt;/td&gt;
      &lt;td&gt;K0&lt;/td&gt;
      &lt;td&gt;K0&lt;/td&gt;
      &lt;td&gt;C0&lt;/td&gt;
      &lt;td&gt;D0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;5&lt;/th&gt;
      &lt;td&gt;K0&lt;/td&gt;
      &lt;td&gt;K1&lt;/td&gt;
      &lt;td&gt;A1&lt;/td&gt;
      &lt;td&gt;B1&lt;/td&gt;
      &lt;td&gt;K1&lt;/td&gt;
      &lt;td&gt;K0&lt;/td&gt;
      &lt;td&gt;C1&lt;/td&gt;
      &lt;td&gt;D1&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;6&lt;/th&gt;
      &lt;td&gt;K0&lt;/td&gt;
      &lt;td&gt;K1&lt;/td&gt;
      &lt;td&gt;A1&lt;/td&gt;
      &lt;td&gt;B1&lt;/td&gt;
      &lt;td&gt;K1&lt;/td&gt;
      &lt;td&gt;K0&lt;/td&gt;
      &lt;td&gt;C2&lt;/td&gt;
      &lt;td&gt;D2&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;7&lt;/th&gt;
      &lt;td&gt;K0&lt;/td&gt;
      &lt;td&gt;K1&lt;/td&gt;
      &lt;td&gt;A1&lt;/td&gt;
      &lt;td&gt;B1&lt;/td&gt;
      &lt;td&gt;K2&lt;/td&gt;
      &lt;td&gt;K0&lt;/td&gt;
      &lt;td&gt;C3&lt;/td&gt;
      &lt;td&gt;D3&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;8&lt;/th&gt;
      &lt;td&gt;K1&lt;/td&gt;
      &lt;td&gt;K0&lt;/td&gt;
      &lt;td&gt;A2&lt;/td&gt;
      &lt;td&gt;B2&lt;/td&gt;
      &lt;td&gt;K0&lt;/td&gt;
      &lt;td&gt;K0&lt;/td&gt;
      &lt;td&gt;C0&lt;/td&gt;
      &lt;td&gt;D0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;9&lt;/th&gt;
      &lt;td&gt;K1&lt;/td&gt;
      &lt;td&gt;K0&lt;/td&gt;
      &lt;td&gt;A2&lt;/td&gt;
      &lt;td&gt;B2&lt;/td&gt;
      &lt;td&gt;K1&lt;/td&gt;
      &lt;td&gt;K0&lt;/td&gt;
      &lt;td&gt;C1&lt;/td&gt;
      &lt;td&gt;D1&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;10&lt;/th&gt;
      &lt;td&gt;K1&lt;/td&gt;
      &lt;td&gt;K0&lt;/td&gt;
      &lt;td&gt;A2&lt;/td&gt;
      &lt;td&gt;B2&lt;/td&gt;
      &lt;td&gt;K1&lt;/td&gt;
      &lt;td&gt;K0&lt;/td&gt;
      &lt;td&gt;C2&lt;/td&gt;
      &lt;td&gt;D2&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;11&lt;/th&gt;
      &lt;td&gt;K1&lt;/td&gt;
      &lt;td&gt;K0&lt;/td&gt;
      &lt;td&gt;A2&lt;/td&gt;
      &lt;td&gt;B2&lt;/td&gt;
      &lt;td&gt;K2&lt;/td&gt;
      &lt;td&gt;K0&lt;/td&gt;
      &lt;td&gt;C3&lt;/td&gt;
      &lt;td&gt;D3&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;12&lt;/th&gt;
      &lt;td&gt;K2&lt;/td&gt;
      &lt;td&gt;K1&lt;/td&gt;
      &lt;td&gt;A3&lt;/td&gt;
      &lt;td&gt;B3&lt;/td&gt;
      &lt;td&gt;K0&lt;/td&gt;
      &lt;td&gt;K0&lt;/td&gt;
      &lt;td&gt;C0&lt;/td&gt;
      &lt;td&gt;D0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;13&lt;/th&gt;
      &lt;td&gt;K2&lt;/td&gt;
      &lt;td&gt;K1&lt;/td&gt;
      &lt;td&gt;A3&lt;/td&gt;
      &lt;td&gt;B3&lt;/td&gt;
      &lt;td&gt;K1&lt;/td&gt;
      &lt;td&gt;K0&lt;/td&gt;
      &lt;td&gt;C1&lt;/td&gt;
      &lt;td&gt;D1&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;14&lt;/th&gt;
      &lt;td&gt;K2&lt;/td&gt;
      &lt;td&gt;K1&lt;/td&gt;
      &lt;td&gt;A3&lt;/td&gt;
      &lt;td&gt;B3&lt;/td&gt;
      &lt;td&gt;K1&lt;/td&gt;
      &lt;td&gt;K0&lt;/td&gt;
      &lt;td&gt;C2&lt;/td&gt;
      &lt;td&gt;D2&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;15&lt;/th&gt;
      &lt;td&gt;K2&lt;/td&gt;
      &lt;td&gt;K1&lt;/td&gt;
      &lt;td&gt;A3&lt;/td&gt;
      &lt;td&gt;B3&lt;/td&gt;
      &lt;td&gt;K2&lt;/td&gt;
      &lt;td&gt;K0&lt;/td&gt;
      &lt;td&gt;C3&lt;/td&gt;
      &lt;td&gt;D3&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;h2 id=&#34;join-dataframe-对象的强大连接操作&#34;&gt;join: DataFrame 对象的强大连接操作&lt;/h2&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;left = pd.DataFrame(
    {&amp;quot;A&amp;quot;: [&amp;quot;A0&amp;quot;, &amp;quot;A1&amp;quot;, &amp;quot;A2&amp;quot;], &amp;quot;B&amp;quot;: [&amp;quot;B0&amp;quot;, &amp;quot;B1&amp;quot;, &amp;quot;B2&amp;quot;]}, index=[&amp;quot;K0&amp;quot;, &amp;quot;K1&amp;quot;, &amp;quot;K2&amp;quot;]
)
left
&lt;/code&gt;&lt;/pre&gt;
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/style&gt;&lt;/p&gt;
&lt;table border=&#34;1&#34; class=&#34;dataframe&#34;&gt;
  &lt;thead&gt;
    &lt;tr style=&#34;text-align: right;&#34;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;A&lt;/th&gt;
      &lt;th&gt;B&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;K0&lt;/th&gt;
      &lt;td&gt;A0&lt;/td&gt;
      &lt;td&gt;B0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;K1&lt;/th&gt;
      &lt;td&gt;A1&lt;/td&gt;
      &lt;td&gt;B1&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;K2&lt;/th&gt;
      &lt;td&gt;A2&lt;/td&gt;
      &lt;td&gt;B2&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;right = pd.DataFrame(
    {&amp;quot;C&amp;quot;: [&amp;quot;C0&amp;quot;, &amp;quot;C2&amp;quot;, &amp;quot;C3&amp;quot;], &amp;quot;D&amp;quot;: [&amp;quot;D0&amp;quot;, &amp;quot;D2&amp;quot;, &amp;quot;D3&amp;quot;]}, index=[&amp;quot;K0&amp;quot;, &amp;quot;K2&amp;quot;, &amp;quot;K3&amp;quot;]
)
right
&lt;/code&gt;&lt;/pre&gt;
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/style&gt;&lt;/p&gt;
&lt;table border=&#34;1&#34; class=&#34;dataframe&#34;&gt;
  &lt;thead&gt;
    &lt;tr style=&#34;text-align: right;&#34;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;C&lt;/th&gt;
      &lt;th&gt;D&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;K0&lt;/th&gt;
      &lt;td&gt;C0&lt;/td&gt;
      &lt;td&gt;D0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;K2&lt;/th&gt;
      &lt;td&gt;C2&lt;/td&gt;
      &lt;td&gt;D2&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;K3&lt;/th&gt;
      &lt;td&gt;C3&lt;/td&gt;
      &lt;td&gt;D3&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;left.join(right)
&lt;/code&gt;&lt;/pre&gt;
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/style&gt;&lt;/p&gt;
&lt;table border=&#34;1&#34; class=&#34;dataframe&#34;&gt;
  &lt;thead&gt;
    &lt;tr style=&#34;text-align: right;&#34;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;A&lt;/th&gt;
      &lt;th&gt;B&lt;/th&gt;
      &lt;th&gt;C&lt;/th&gt;
      &lt;th&gt;D&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;K0&lt;/th&gt;
      &lt;td&gt;A0&lt;/td&gt;
      &lt;td&gt;B0&lt;/td&gt;
      &lt;td&gt;C0&lt;/td&gt;
      &lt;td&gt;D0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;K1&lt;/th&gt;
      &lt;td&gt;A1&lt;/td&gt;
      &lt;td&gt;B1&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;K2&lt;/th&gt;
      &lt;td&gt;A2&lt;/td&gt;
      &lt;td&gt;B2&lt;/td&gt;
      &lt;td&gt;C2&lt;/td&gt;
      &lt;td&gt;D2&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;right.join(left)
&lt;/code&gt;&lt;/pre&gt;
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/style&gt;&lt;/p&gt;
&lt;table border=&#34;1&#34; class=&#34;dataframe&#34;&gt;
  &lt;thead&gt;
    &lt;tr style=&#34;text-align: right;&#34;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;C&lt;/th&gt;
      &lt;th&gt;D&lt;/th&gt;
      &lt;th&gt;A&lt;/th&gt;
      &lt;th&gt;B&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;K0&lt;/th&gt;
      &lt;td&gt;C0&lt;/td&gt;
      &lt;td&gt;D0&lt;/td&gt;
      &lt;td&gt;A0&lt;/td&gt;
      &lt;td&gt;B0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;K2&lt;/th&gt;
      &lt;td&gt;C2&lt;/td&gt;
      &lt;td&gt;D2&lt;/td&gt;
      &lt;td&gt;A2&lt;/td&gt;
      &lt;td&gt;B2&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;K3&lt;/th&gt;
      &lt;td&gt;C3&lt;/td&gt;
      &lt;td&gt;D3&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;p&gt;DataFrame 的 &lt;code&gt;join&lt;/code&gt; 默认值为 &lt;code&gt;left&lt;/code&gt;，可以设置为除笛卡尔积外的连接方式。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;left.join(right, how=&#39;inner&#39;)
&lt;/code&gt;&lt;/pre&gt;
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/style&gt;&lt;/p&gt;
&lt;table border=&#34;1&#34; class=&#34;dataframe&#34;&gt;
  &lt;thead&gt;
    &lt;tr style=&#34;text-align: right;&#34;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;A&lt;/th&gt;
      &lt;th&gt;B&lt;/th&gt;
      &lt;th&gt;C&lt;/th&gt;
      &lt;th&gt;D&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;K0&lt;/th&gt;
      &lt;td&gt;A0&lt;/td&gt;
      &lt;td&gt;B0&lt;/td&gt;
      &lt;td&gt;C0&lt;/td&gt;
      &lt;td&gt;D0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;K2&lt;/th&gt;
      &lt;td&gt;A2&lt;/td&gt;
      &lt;td&gt;B2&lt;/td&gt;
      &lt;td&gt;C2&lt;/td&gt;
      &lt;td&gt;D2&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;</description>
    </item>
    
    <item>
      <title>pandas 分类汇总</title>
      <link>https://bowenei.gitee.io/learn/pandas/groupby/</link>
      <pubDate>Sat, 19 Feb 2022 11:19:27 +0800</pubDate>
      <guid>https://bowenei.gitee.io/learn/pandas/groupby/</guid>
      <description>&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;import pandas as pd
import numpy as np
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;分类汇总 &lt;code&gt;group by&lt;/code&gt; 指的是如下的一个或多个步骤的数据分组：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Splitting&lt;/strong&gt;: 根据某些标准将数据分成若干组。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Applying&lt;/strong&gt;: 将一个函数独立应用于每个组。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Combining&lt;/strong&gt;: 将结果合并到数据结构中。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;其中，拆分步骤最简单。事实上，在许多情况下，我们可能希望将数据集分成若干组，并对这些组进行处理。&lt;/p&gt;
&lt;p&gt;在应用步骤中，我们可能希望执行以下操作之一：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Aggregation&lt;/strong&gt;: 计算每组的汇总统计数据。例如计算每组的和 &lt;code&gt;sum&lt;/code&gt; 以及平均值 &lt;code&gt;means&lt;/code&gt;，或者数每组记录的个数。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Transformation&lt;/strong&gt;: 执行一些特定于组的计算，并返回一个相似的索引对象。例如获得每组排序后的第一个数据。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Filtration&lt;/strong&gt;: 根据评估为真或假的分组计算，丢弃一些分组。例如丢弃属于只有少数成员的组的数据，或者根据组和或平均值过滤数据。&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;分组&#34;&gt;分组&lt;/h2&gt;
&lt;p&gt;pandas 对象可以在其任意轴上拆分。分组的抽象定义是提供标签到组名的映射。分组需要创建 &lt;code&gt;GroupBy&lt;/code&gt; 对象。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;df = pd.DataFrame(
    [
        (&amp;quot;bird&amp;quot;, &amp;quot;Falconiformes&amp;quot;, 389.0),
        (&amp;quot;bird&amp;quot;, &amp;quot;Psittaciformes&amp;quot;, 24.0),
        (&amp;quot;mammal&amp;quot;, &amp;quot;Carnivora&amp;quot;, 80.2),
        (&amp;quot;mammal&amp;quot;, &amp;quot;Primates&amp;quot;, np.nan),
        (&amp;quot;mammal&amp;quot;, &amp;quot;Carnivora&amp;quot;, 58),
    ],
    index=[&amp;quot;falcon&amp;quot;, &amp;quot;parrot&amp;quot;, &amp;quot;lion&amp;quot;, &amp;quot;monkey&amp;quot;, &amp;quot;leopard&amp;quot;],
    columns=(&amp;quot;class&amp;quot;, &amp;quot;order&amp;quot;, &amp;quot;max_speed&amp;quot;),
)
df
&lt;/code&gt;&lt;/pre&gt;
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/style&gt;&lt;/p&gt;
&lt;table border=&#34;1&#34; class=&#34;dataframe&#34;&gt;
  &lt;thead&gt;
    &lt;tr style=&#34;text-align: right;&#34;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;class&lt;/th&gt;
      &lt;th&gt;order&lt;/th&gt;
      &lt;th&gt;max_speed&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;falcon&lt;/th&gt;
      &lt;td&gt;bird&lt;/td&gt;
      &lt;td&gt;Falconiformes&lt;/td&gt;
      &lt;td&gt;389.0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;parrot&lt;/th&gt;
      &lt;td&gt;bird&lt;/td&gt;
      &lt;td&gt;Psittaciformes&lt;/td&gt;
      &lt;td&gt;24.0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;lion&lt;/th&gt;
      &lt;td&gt;mammal&lt;/td&gt;
      &lt;td&gt;Carnivora&lt;/td&gt;
      &lt;td&gt;80.2&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;monkey&lt;/th&gt;
      &lt;td&gt;mammal&lt;/td&gt;
      &lt;td&gt;Primates&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;leopard&lt;/th&gt;
      &lt;td&gt;mammal&lt;/td&gt;
      &lt;td&gt;Carnivora&lt;/td&gt;
      &lt;td&gt;58.0&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;df.groupby(&#39;class&#39;)
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;pandas.core.groupby.generic.DataFrameGroupBy object at 0x0000021B59E47F10&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;code&gt;axis&lt;/code&gt; 为 &lt;code&gt;1&lt;/code&gt; 或 &lt;code&gt;columns&lt;/code&gt; 表示按列分组，默认值为 &lt;code&gt;0&lt;/code&gt; 或 &lt;code&gt;index&lt;/code&gt; 即按行分组。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;df.groupby(&#39;order&#39;, axis=&#39;columns&#39;)
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;pandas.core.groupby.generic.DataFrameGroupBy object at 0x0000021B59E47BE0&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;df.groupby([&#39;class&#39;, &#39;order&#39;])
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;pandas.core.groupby.generic.DataFrameGroupBy object at 0x0000021B576F6BB0&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;应用与合并&#34;&gt;应用与合并&lt;/h2&gt;
&lt;h3 id=&#34;汇总&#34;&gt;汇总&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;df = pd.DataFrame(
    {
        &amp;quot;A&amp;quot;: [&amp;quot;foo&amp;quot;, &amp;quot;bar&amp;quot;, &amp;quot;foo&amp;quot;, &amp;quot;bar&amp;quot;, &amp;quot;foo&amp;quot;, &amp;quot;bar&amp;quot;, &amp;quot;foo&amp;quot;, &amp;quot;foo&amp;quot;],
        &amp;quot;B&amp;quot;: [&amp;quot;one&amp;quot;, &amp;quot;one&amp;quot;, &amp;quot;two&amp;quot;, &amp;quot;three&amp;quot;, &amp;quot;two&amp;quot;, &amp;quot;two&amp;quot;, &amp;quot;one&amp;quot;, &amp;quot;three&amp;quot;],
        &amp;quot;C&amp;quot;: np.random.randn(8),
        &amp;quot;D&amp;quot;: np.random.randn(8),
    }
)
df
&lt;/code&gt;&lt;/pre&gt;
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/style&gt;&lt;/p&gt;
&lt;table border=&#34;1&#34; class=&#34;dataframe&#34;&gt;
  &lt;thead&gt;
    &lt;tr style=&#34;text-align: right;&#34;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;A&lt;/th&gt;
      &lt;th&gt;B&lt;/th&gt;
      &lt;th&gt;C&lt;/th&gt;
      &lt;th&gt;D&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;td&gt;foo&lt;/td&gt;
      &lt;td&gt;one&lt;/td&gt;
      &lt;td&gt;-0.358296&lt;/td&gt;
      &lt;td&gt;2.330367&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1&lt;/th&gt;
      &lt;td&gt;bar&lt;/td&gt;
      &lt;td&gt;one&lt;/td&gt;
      &lt;td&gt;1.081549&lt;/td&gt;
      &lt;td&gt;-1.002115&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2&lt;/th&gt;
      &lt;td&gt;foo&lt;/td&gt;
      &lt;td&gt;two&lt;/td&gt;
      &lt;td&gt;-0.237551&lt;/td&gt;
      &lt;td&gt;0.510146&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;3&lt;/th&gt;
      &lt;td&gt;bar&lt;/td&gt;
      &lt;td&gt;three&lt;/td&gt;
      &lt;td&gt;-1.573979&lt;/td&gt;
      &lt;td&gt;-1.366482&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;4&lt;/th&gt;
      &lt;td&gt;foo&lt;/td&gt;
      &lt;td&gt;two&lt;/td&gt;
      &lt;td&gt;-0.146734&lt;/td&gt;
      &lt;td&gt;0.273849&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;5&lt;/th&gt;
      &lt;td&gt;bar&lt;/td&gt;
      &lt;td&gt;two&lt;/td&gt;
      &lt;td&gt;-1.927644&lt;/td&gt;
      &lt;td&gt;0.645096&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;6&lt;/th&gt;
      &lt;td&gt;foo&lt;/td&gt;
      &lt;td&gt;one&lt;/td&gt;
      &lt;td&gt;1.393947&lt;/td&gt;
      &lt;td&gt;-0.680186&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;7&lt;/th&gt;
      &lt;td&gt;foo&lt;/td&gt;
      &lt;td&gt;three&lt;/td&gt;
      &lt;td&gt;-0.036544&lt;/td&gt;
      &lt;td&gt;0.883412&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;p&gt;&lt;code&gt;GroupBy&lt;/code&gt; 对象后索引 column 表示需要汇总的属性，会返回一个新的 &lt;code&gt;GroupBy&lt;/code&gt; 对象。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;grouped = df.groupby(&#39;A&#39;)[[&#39;C&#39;, &#39;D&#39;]]
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&#34;求和&#34;&gt;求和&lt;/h4&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;grouped.sum()
&lt;/code&gt;&lt;/pre&gt;
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/style&gt;&lt;/p&gt;
&lt;table border=&#34;1&#34; class=&#34;dataframe&#34;&gt;
  &lt;thead&gt;
    &lt;tr style=&#34;text-align: right;&#34;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;C&lt;/th&gt;
      &lt;th&gt;D&lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;A&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;bar&lt;/th&gt;
      &lt;td&gt;-2.420074&lt;/td&gt;
      &lt;td&gt;-1.723502&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;foo&lt;/th&gt;
      &lt;td&gt;0.614822&lt;/td&gt;
      &lt;td&gt;3.317587&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;h4 id=&#34;平均值&#34;&gt;平均值&lt;/h4&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;grouped.mean()
&lt;/code&gt;&lt;/pre&gt;
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/style&gt;&lt;/p&gt;
&lt;table border=&#34;1&#34; class=&#34;dataframe&#34;&gt;
  &lt;thead&gt;
    &lt;tr style=&#34;text-align: right;&#34;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;C&lt;/th&gt;
      &lt;th&gt;D&lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;A&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;bar&lt;/th&gt;
      &lt;td&gt;-0.806691&lt;/td&gt;
      &lt;td&gt;-0.574501&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;foo&lt;/th&gt;
      &lt;td&gt;0.122964&lt;/td&gt;
      &lt;td&gt;0.663517&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;h4 id=&#34;中位数&#34;&gt;中位数&lt;/h4&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;grouped.median()
&lt;/code&gt;&lt;/pre&gt;
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/style&gt;&lt;/p&gt;
&lt;table border=&#34;1&#34; class=&#34;dataframe&#34;&gt;
  &lt;thead&gt;
    &lt;tr style=&#34;text-align: right;&#34;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;C&lt;/th&gt;
      &lt;th&gt;D&lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;A&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;bar&lt;/th&gt;
      &lt;td&gt;-1.573979&lt;/td&gt;
      &lt;td&gt;-1.002115&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;foo&lt;/th&gt;
      &lt;td&gt;-0.146734&lt;/td&gt;
      &lt;td&gt;0.510146&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;h4 id=&#34;最小值&#34;&gt;最小值&lt;/h4&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;grouped.min()
&lt;/code&gt;&lt;/pre&gt;
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/style&gt;&lt;/p&gt;
&lt;table border=&#34;1&#34; class=&#34;dataframe&#34;&gt;
  &lt;thead&gt;
    &lt;tr style=&#34;text-align: right;&#34;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;C&lt;/th&gt;
      &lt;th&gt;D&lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;A&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;bar&lt;/th&gt;
      &lt;td&gt;-1.927644&lt;/td&gt;
      &lt;td&gt;-1.366482&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;foo&lt;/th&gt;
      &lt;td&gt;-0.358296&lt;/td&gt;
      &lt;td&gt;-0.680186&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;h4 id=&#34;最大值&#34;&gt;最大值&lt;/h4&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;grouped.max()
&lt;/code&gt;&lt;/pre&gt;
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/style&gt;&lt;/p&gt;
&lt;table border=&#34;1&#34; class=&#34;dataframe&#34;&gt;
  &lt;thead&gt;
    &lt;tr style=&#34;text-align: right;&#34;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;C&lt;/th&gt;
      &lt;th&gt;D&lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;A&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;bar&lt;/th&gt;
      &lt;td&gt;1.081549&lt;/td&gt;
      &lt;td&gt;0.645096&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;foo&lt;/th&gt;
      &lt;td&gt;1.393947&lt;/td&gt;
      &lt;td&gt;2.330367&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;h4 id=&#34;标准差&#34;&gt;标准差&lt;/h4&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;grouped.std()
&lt;/code&gt;&lt;/pre&gt;
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/style&gt;&lt;/p&gt;
&lt;table border=&#34;1&#34; class=&#34;dataframe&#34;&gt;
  &lt;thead&gt;
    &lt;tr style=&#34;text-align: right;&#34;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;C&lt;/th&gt;
      &lt;th&gt;D&lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;A&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;bar&lt;/th&gt;
      &lt;td&gt;1.644797&lt;/td&gt;
      &lt;td&gt;1.071799&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;foo&lt;/th&gt;
      &lt;td&gt;0.720271&lt;/td&gt;
      &lt;td&gt;1.096317&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;p&gt;可以使用 &lt;code&gt;agg&lt;/code&gt; 来使用任何可以进行汇总和统计的函数，包括用户自定义的函数。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;grouped.agg([&#39;sum&#39;, &#39;mean&#39;])
&lt;/code&gt;&lt;/pre&gt;
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead tr th {
    text-align: left;
}

.dataframe thead tr:last-of-type th {
    text-align: right;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/style&gt;&lt;/p&gt;
&lt;table border=&#34;1&#34; class=&#34;dataframe&#34;&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th colspan=&#34;2&#34; halign=&#34;left&#34;&gt;C&lt;/th&gt;
      &lt;th colspan=&#34;2&#34; halign=&#34;left&#34;&gt;D&lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;sum&lt;/th&gt;
      &lt;th&gt;mean&lt;/th&gt;
      &lt;th&gt;sum&lt;/th&gt;
      &lt;th&gt;mean&lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;A&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;bar&lt;/th&gt;
      &lt;td&gt;-2.420074&lt;/td&gt;
      &lt;td&gt;-0.806691&lt;/td&gt;
      &lt;td&gt;-1.723502&lt;/td&gt;
      &lt;td&gt;-0.574501&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;foo&lt;/th&gt;
      &lt;td&gt;0.614822&lt;/td&gt;
      &lt;td&gt;0.122964&lt;/td&gt;
      &lt;td&gt;3.317587&lt;/td&gt;
      &lt;td&gt;0.663517&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;h3 id=&#34;次序&#34;&gt;次序&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;df = pd.DataFrame({
    &#39;Name&#39;: [&#39;Jim&#39;, &#39;Jim&#39;, &#39;Jim&#39;, &#39;Pam&#39;, &#39;Pam&#39;],
    &#39;Attempt&#39;: [&#39;First&#39;, &#39;Second&#39;, &#39;Third&#39;, &#39;First&#39;, &#39;Second&#39;],
    &#39;GRE Score&#39;: [298, 321, 314, 318, 330]
})
df
&lt;/code&gt;&lt;/pre&gt;
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/style&gt;&lt;/p&gt;
&lt;table border=&#34;1&#34; class=&#34;dataframe&#34;&gt;
  &lt;thead&gt;
    &lt;tr style=&#34;text-align: right;&#34;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;Name&lt;/th&gt;
      &lt;th&gt;Attempt&lt;/th&gt;
      &lt;th&gt;GRE Score&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;td&gt;Jim&lt;/td&gt;
      &lt;td&gt;First&lt;/td&gt;
      &lt;td&gt;298&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1&lt;/th&gt;
      &lt;td&gt;Jim&lt;/td&gt;
      &lt;td&gt;Second&lt;/td&gt;
      &lt;td&gt;321&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2&lt;/th&gt;
      &lt;td&gt;Jim&lt;/td&gt;
      &lt;td&gt;Third&lt;/td&gt;
      &lt;td&gt;314&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;3&lt;/th&gt;
      &lt;td&gt;Pam&lt;/td&gt;
      &lt;td&gt;First&lt;/td&gt;
      &lt;td&gt;318&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;4&lt;/th&gt;
      &lt;td&gt;Pam&lt;/td&gt;
      &lt;td&gt;Second&lt;/td&gt;
      &lt;td&gt;330&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;p&gt;返回每个人最后一次 GRE 考试成绩：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;df.groupby(&#39;Name&#39;)[&#39;GRE Score&#39;].last()
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;Name
Jim    314
Pam    330
Name: GRE Score, dtype: int64
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;返回每个人第一次 GRE 考试成绩：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;df.groupby(&#39;Name&#39;)[&#39;GRE Score&#39;].first()
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;Name
Jim    298
Pam    318
Name: GRE Score, dtype: int64
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;使用 &lt;code&gt;nth&lt;/code&gt; 可以返回第任意次 GRE 考试成绩：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;df.groupby(&#39;Name&#39;)[&#39;GRE Score&#39;].nth(1)
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;Name
Jim    321
Pam    330
Name: GRE Score, dtype: int64
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;排序&#34;&gt;排序&lt;/h3&gt;
&lt;p&gt;给每次 GRE 考试都加上名次。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;df[&#39;Rank&#39;] = df.groupby(&#39;Name&#39;)[&#39;GRE Score&#39;].rank(ascending=False).astype(int)
df
&lt;/code&gt;&lt;/pre&gt;
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/style&gt;&lt;/p&gt;
&lt;table border=&#34;1&#34; class=&#34;dataframe&#34;&gt;
  &lt;thead&gt;
    &lt;tr style=&#34;text-align: right;&#34;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;Name&lt;/th&gt;
      &lt;th&gt;Attempt&lt;/th&gt;
      &lt;th&gt;GRE Score&lt;/th&gt;
      &lt;th&gt;Rank&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;td&gt;Jim&lt;/td&gt;
      &lt;td&gt;First&lt;/td&gt;
      &lt;td&gt;298&lt;/td&gt;
      &lt;td&gt;3&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1&lt;/th&gt;
      &lt;td&gt;Jim&lt;/td&gt;
      &lt;td&gt;Second&lt;/td&gt;
      &lt;td&gt;321&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2&lt;/th&gt;
      &lt;td&gt;Jim&lt;/td&gt;
      &lt;td&gt;Third&lt;/td&gt;
      &lt;td&gt;314&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;3&lt;/th&gt;
      &lt;td&gt;Pam&lt;/td&gt;
      &lt;td&gt;First&lt;/td&gt;
      &lt;td&gt;318&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;4&lt;/th&gt;
      &lt;td&gt;Pam&lt;/td&gt;
      &lt;td&gt;Second&lt;/td&gt;
      &lt;td&gt;330&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;p&gt;如要给每组数据都排序，建议先对原 DataFrame 对象排序，再分组。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;df.sort_values(&#39;GRE Score&#39;, ascending=False).groupby(&#39;Name&#39;)[&#39;GRE Score&#39;].first()
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;Name
Jim    321
Pam    330
Name: GRE Score, dtype: int64
&lt;/code&gt;&lt;/pre&gt;</description>
    </item>
    
    <item>
      <title>pandas 输入输出</title>
      <link>https://bowenei.gitee.io/learn/pandas/io/</link>
      <pubDate>Sat, 19 Feb 2022 11:19:54 +0800</pubDate>
      <guid>https://bowenei.gitee.io/learn/pandas/io/</guid>
      <description>&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;import pandas as pd
import numpy as np
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;csv&#34;&gt;CSV&lt;/h2&gt;
&lt;h3 id=&#34;数据交互&#34;&gt;数据交互&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from io import StringIO
data = &amp;quot;col1,col2,col3\na,b,1\na,b,2\nc,d,3&amp;quot;
print(data)
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;col1,col2,col3
a,b,1
a,b,2
c,d,3
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;pd.read_csv(StringIO(data))
&lt;/code&gt;&lt;/pre&gt;
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/style&gt;&lt;/p&gt;
&lt;table border=&#34;1&#34; class=&#34;dataframe&#34;&gt;
  &lt;thead&gt;
    &lt;tr style=&#34;text-align: right;&#34;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;col1&lt;/th&gt;
      &lt;th&gt;col2&lt;/th&gt;
      &lt;th&gt;col3&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;td&gt;a&lt;/td&gt;
      &lt;td&gt;b&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1&lt;/th&gt;
      &lt;td&gt;a&lt;/td&gt;
      &lt;td&gt;b&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2&lt;/th&gt;
      &lt;td&gt;c&lt;/td&gt;
      &lt;td&gt;d&lt;/td&gt;
      &lt;td&gt;3&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;p&gt;可以仅指定部分列：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;pd.read_csv(StringIO(data), usecols=lambda x: x.upper() in [&amp;quot;COL1&amp;quot;, &amp;quot;COL3&amp;quot;])
&lt;/code&gt;&lt;/pre&gt;
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/style&gt;&lt;/p&gt;
&lt;table border=&#34;1&#34; class=&#34;dataframe&#34;&gt;
  &lt;thead&gt;
    &lt;tr style=&#34;text-align: right;&#34;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;col1&lt;/th&gt;
      &lt;th&gt;col3&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;td&gt;a&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1&lt;/th&gt;
      &lt;td&gt;a&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2&lt;/th&gt;
      &lt;td&gt;c&lt;/td&gt;
      &lt;td&gt;3&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;p&gt;也可以仅指定部分行：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;pd.read_csv(StringIO(data), skiprows=lambda x: x % 2 != 0)
&lt;/code&gt;&lt;/pre&gt;
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/style&gt;&lt;/p&gt;
&lt;table border=&#34;1&#34; class=&#34;dataframe&#34;&gt;
  &lt;thead&gt;
    &lt;tr style=&#34;text-align: right;&#34;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;col1&lt;/th&gt;
      &lt;th&gt;col2&lt;/th&gt;
      &lt;th&gt;col3&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;td&gt;a&lt;/td&gt;
      &lt;td&gt;b&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;p&gt;可以使用 &lt;code&gt;names&lt;/code&gt; 参数指定列名。如果希望替换原字符流第一行，则设置 &lt;code&gt;header=0&lt;/code&gt;。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;data = &amp;quot;a,b,c\n1,2,3\n4,5,6\n7,8,9&amp;quot;
print(data)
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;a,b,c
1,2,3
4,5,6
7,8,9
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;pd.read_csv(StringIO(data), names=[&amp;quot;foo&amp;quot;, &amp;quot;bar&amp;quot;, &amp;quot;baz&amp;quot;], header=0)
&lt;/code&gt;&lt;/pre&gt;
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/style&gt;&lt;/p&gt;
&lt;table border=&#34;1&#34; class=&#34;dataframe&#34;&gt;
  &lt;thead&gt;
    &lt;tr style=&#34;text-align: right;&#34;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;foo&lt;/th&gt;
      &lt;th&gt;bar&lt;/th&gt;
      &lt;th&gt;baz&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;3&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1&lt;/th&gt;
      &lt;td&gt;4&lt;/td&gt;
      &lt;td&gt;5&lt;/td&gt;
      &lt;td&gt;6&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2&lt;/th&gt;
      &lt;td&gt;7&lt;/td&gt;
      &lt;td&gt;8&lt;/td&gt;
      &lt;td&gt;9&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;p&gt;如果第一行也是数据，列名需要手动添加，则设置 &lt;code&gt;header=None&lt;/code&gt;。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;pd.read_csv(StringIO(data), names=[&amp;quot;foo&amp;quot;, &amp;quot;bar&amp;quot;, &amp;quot;baz&amp;quot;], header=None)
&lt;/code&gt;&lt;/pre&gt;
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/style&gt;&lt;/p&gt;
&lt;table border=&#34;1&#34; class=&#34;dataframe&#34;&gt;
  &lt;thead&gt;
    &lt;tr style=&#34;text-align: right;&#34;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;foo&lt;/th&gt;
      &lt;th&gt;bar&lt;/th&gt;
      &lt;th&gt;baz&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;td&gt;a&lt;/td&gt;
      &lt;td&gt;b&lt;/td&gt;
      &lt;td&gt;c&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1&lt;/th&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;3&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2&lt;/th&gt;
      &lt;td&gt;4&lt;/td&gt;
      &lt;td&gt;5&lt;/td&gt;
      &lt;td&gt;6&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;3&lt;/th&gt;
      &lt;td&gt;7&lt;/td&gt;
      &lt;td&gt;8&lt;/td&gt;
      &lt;td&gt;9&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;p&gt;还可以实现跳过前面若干行的功能，例如跳过第一行：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;data = &amp;quot;skip this skip it\na,b,c\n1,2,3\n4,5,6\n7,8,9&amp;quot;
print(data)
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;skip this skip it
a,b,c
1,2,3
4,5,6
7,8,9
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;pd.read_csv(StringIO(data), header=1)
&lt;/code&gt;&lt;/pre&gt;
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/style&gt;&lt;/p&gt;
&lt;table border=&#34;1&#34; class=&#34;dataframe&#34;&gt;
  &lt;thead&gt;
    &lt;tr style=&#34;text-align: right;&#34;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;a&lt;/th&gt;
      &lt;th&gt;b&lt;/th&gt;
      &lt;th&gt;c&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;3&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1&lt;/th&gt;
      &lt;td&gt;4&lt;/td&gt;
      &lt;td&gt;5&lt;/td&gt;
      &lt;td&gt;6&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2&lt;/th&gt;
      &lt;td&gt;7&lt;/td&gt;
      &lt;td&gt;8&lt;/td&gt;
      &lt;td&gt;9&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;p&gt;使用 &lt;code&gt;dtype=&#39;category&#39;&lt;/code&gt;，生成的类别将始终被解析为字符串。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;data = &amp;quot;col1,col2,col3\na,b,1\na,b,2\nc,d,3&amp;quot;
df = pd.read_csv(StringIO(data), dtype=&amp;quot;category&amp;quot;)
df.dtypes
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;col1    category
col2    category
col3    category
dtype: object
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;使用参数 &lt;code&gt;comment=#&lt;/code&gt; 来忽略以 &lt;code&gt;#&lt;/code&gt; 开头的注释。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;data = &amp;quot;\na,b,c\n  \n# commented line\n1,2,3\n\n4,5,6&amp;quot;
print(data)
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;a,b,c
  
# commented line
1,2,3

4,5,6
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;pd.read_csv(StringIO(data), comment=&amp;quot;#&amp;quot;)
&lt;/code&gt;&lt;/pre&gt;
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/style&gt;&lt;/p&gt;
&lt;table border=&#34;1&#34; class=&#34;dataframe&#34;&gt;
  &lt;thead&gt;
    &lt;tr style=&#34;text-align: right;&#34;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;a&lt;/th&gt;
      &lt;th&gt;b&lt;/th&gt;
      &lt;th&gt;c&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;3&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1&lt;/th&gt;
      &lt;td&gt;4&lt;/td&gt;
      &lt;td&gt;5&lt;/td&gt;
      &lt;td&gt;6&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;p&gt;使用参数 &lt;code&gt;skip_blank_lines&lt;/code&gt; 来指定是否跳过空行，默认值为 &lt;code&gt;True&lt;/code&gt;。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;data = &amp;quot;a,b,c\n\n1,2,3\n\n\n4,5,6&amp;quot;
pd.read_csv(StringIO(data), skip_blank_lines=False)
&lt;/code&gt;&lt;/pre&gt;
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/style&gt;&lt;/p&gt;
&lt;table border=&#34;1&#34; class=&#34;dataframe&#34;&gt;
  &lt;thead&gt;
    &lt;tr style=&#34;text-align: right;&#34;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;a&lt;/th&gt;
      &lt;th&gt;b&lt;/th&gt;
      &lt;th&gt;c&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1&lt;/th&gt;
      &lt;td&gt;1.0&lt;/td&gt;
      &lt;td&gt;2.0&lt;/td&gt;
      &lt;td&gt;3.0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2&lt;/th&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;3&lt;/th&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;4&lt;/th&gt;
      &lt;td&gt;4.0&lt;/td&gt;
      &lt;td&gt;5.0&lt;/td&gt;
      &lt;td&gt;6.0&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;h3 id=&#34;文件读写&#34;&gt;文件读写&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;df = pd.DataFrame(np.random.randint(0, 10, size=(3, 4)),
                  index=pd.date_range(&#39;2022/2/22&#39;, periods=3),
                  columns=list(&#39;ABCD&#39;))
df.to_csv(&#39;foo.csv&#39;, encoding=&#39;utf-8&#39;)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;参数 &lt;code&gt;index_col=0&lt;/code&gt; 指定 &lt;code&gt;csv&lt;/code&gt; 文件的第一列为 &lt;code&gt;index&lt;/code&gt;。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;pd.read_csv(&#39;foo.csv&#39;, index_col=0)
&lt;/code&gt;&lt;/pre&gt;
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/style&gt;&lt;/p&gt;
&lt;table border=&#34;1&#34; class=&#34;dataframe&#34;&gt;
  &lt;thead&gt;
    &lt;tr style=&#34;text-align: right;&#34;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;A&lt;/th&gt;
      &lt;th&gt;B&lt;/th&gt;
      &lt;th&gt;C&lt;/th&gt;
      &lt;th&gt;D&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;2022-02-22&lt;/th&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;9&lt;/td&gt;
      &lt;td&gt;6&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2022-02-23&lt;/th&gt;
      &lt;td&gt;5&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;9&lt;/td&gt;
      &lt;td&gt;9&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2022-02-24&lt;/th&gt;
      &lt;td&gt;6&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;7&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;h2 id=&#34;excel&#34;&gt;Excel&lt;/h2&gt;
&lt;p&gt;使用 &lt;strong&gt;pandas&lt;/strong&gt; 读写 Excel 文件需要安装 &lt;code&gt;openpyxl&lt;/code&gt; 包。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;df = pd.DataFrame(np.random.randint(0, 10, size=(3, 4)),
                  index=pd.date_range(&#39;2022/2/22&#39;, periods=3),
                  columns=list(&#39;ABCD&#39;))
df.to_excel(&#39;foo.xlsx&#39;, sheet_name=&#39;Sheet1&#39;)
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;pd.read_excel(&#39;foo.xlsx&#39;, sheet_name=&#39;Sheet1&#39;, index_col=0, na_values=[&#39;NA&#39;])
&lt;/code&gt;&lt;/pre&gt;
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/style&gt;&lt;/p&gt;
&lt;table border=&#34;1&#34; class=&#34;dataframe&#34;&gt;
  &lt;thead&gt;
    &lt;tr style=&#34;text-align: right;&#34;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;A&lt;/th&gt;
      &lt;th&gt;B&lt;/th&gt;
      &lt;th&gt;C&lt;/th&gt;
      &lt;th&gt;D&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;2022-02-22&lt;/th&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;5&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2022-02-23&lt;/th&gt;
      &lt;td&gt;6&lt;/td&gt;
      &lt;td&gt;5&lt;/td&gt;
      &lt;td&gt;9&lt;/td&gt;
      &lt;td&gt;5&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2022-02-24&lt;/th&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;5&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;df2 = pd.DataFrame(np.random.randint(0, 10, size=(3, 4)),
                   index=pd.date_range(&#39;2022/2/22&#39;, periods=3),
                   columns=list(&#39;ABCD&#39;))
df.to_excel(&#39;foo.xlsx&#39;, sheet_name=&#39;Sheet1&#39;)
df2.to_excel(&#39;foo.xlsx&#39;, sheet_name=&#39;Sheet2&#39;)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;如果要读取一个 Excel 文件的多个 Sheet，使用 &lt;code&gt;ExcelFile&lt;/code&gt; 对象。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;data = {}
with pd.ExcelFile(&amp;quot;foo.xlsx&amp;quot;) as xlsx:
    data[&amp;quot;Sheet1&amp;quot;] = pd.read_excel(xlsx, &amp;quot;Sheet1&amp;quot;, index_col=0, na_values=[&#39;NA&#39;])
    data[&amp;quot;Sheet2&amp;quot;] = pd.read_excel(xlsx, &amp;quot;Sheet2&amp;quot;, index_col=0, na_values=[&#39;NA&#39;])
&lt;/code&gt;&lt;/pre&gt;</description>
    </item>
    
  </channel>
</rss>
