<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>对偶 | Bowen&#39;s Academic Home</title>
    <link>https://bowenei.gitee.io/learn/convex-optimization/duality/</link>
      <atom:link href="https://bowenei.gitee.io/learn/convex-optimization/duality/index.xml" rel="self" type="application/rss+xml" />
    <description>对偶</description>
    <generator>Wowchemy (https://wowchemy.com)</generator><language>en-us</language><lastBuildDate>Sun, 07 Nov 2021 17:23:42 +0800</lastBuildDate>
    <image>
      <url>https://bowenei.gitee.io/media/icon_huc813daf5dbf7d2b27f0daba22fe1e0fb_68056_512x512_fill_lanczos_center_3.png</url>
      <title>对偶</title>
      <link>https://bowenei.gitee.io/learn/convex-optimization/duality/</link>
    </image>
    
    <item>
      <title>Lagrange 对偶函数</title>
      <link>https://bowenei.gitee.io/learn/convex-optimization/duality/the-lagrange-dual-function/</link>
      <pubDate>Fri, 01 Apr 2022 12:56:37 +0800</pubDate>
      <guid>https://bowenei.gitee.io/learn/convex-optimization/duality/the-lagrange-dual-function/</guid>
      <description>&lt;h2 id=&#34;lagrange-函数&#34;&gt;Lagrange 函数&lt;/h2&gt;
&lt;p&gt;考虑标准形式的优化问题&lt;/p&gt;



$$
\begin{aligned}
    \mathrm{minimize} \quad &amp; f_0(x) \\\\
    \mathrm{subject\ to} \quad &amp; f_i(x) \leqslant 0, \quad i=1,\cdots,m \\\\
    &amp; h_i(x) = 0, \quad i=1,\cdots,p
\end{aligned}
$$

&lt;p&gt;定义该问题的 &lt;strong&gt;Lagrange 函数&lt;/strong&gt; $L: \mathbf{R}^n \times \mathbf{R}^m \mathbf{R}^p \rightarrow \mathbf{R}$ 为&lt;/p&gt;



$$
L(x, \lambda, \nu) = f_0(x) + \sum_{i=1}^m \lambda_i f_i(x) + \sum_{i=1}^p \nu_i h_i(x)
$$

&lt;p&gt;其中定义域 $\operatorname{dom} L = \mathcal{D} \times \mathbf{R}^m \times \mathbf{R}^p$。$\lambda_i$ 称为第 $i$ 个不等式约束 $f_i(x) \leqslant 0$ 对应的 &lt;strong&gt;Lagrange 乘子&lt;/strong&gt;；类似地，$\nu_i$ 称为第 $i$ 个等式约束 $h_i(x) = 0$ 对应的 Lagrange 乘子。向量 $\lambda$ 和 $\nu$ 称为&lt;strong&gt;对偶变量&lt;/strong&gt;或者问题的 &lt;strong&gt;Lagrange 乘子向量&lt;/strong&gt;。&lt;/p&gt;
&lt;h2 id=&#34;lagrange-对偶函数&#34;&gt;Lagrange 对偶函数&lt;/h2&gt;
&lt;p&gt;定义 &lt;strong&gt;Lagrange 对偶函数&lt;/strong&gt; $g: \mathbf{R}^m \times \mathbf{R}^p \rightarrow \mathbf{R}$ 为 Lagrange 函数关于 $x$ 取得的最小值：即对 $\lambda \in \mathbf{R}^m$，$\nu \in \mathbf{R}^p$，有&lt;/p&gt;



$$
g(\lambda, \nu)=\inf_{x \in \mathcal{D}} L(x, \lambda, \nu)=\inf_{x \in \mathcal{D}}\left(f_0(x)+\sum_{i=1}^{m} \lambda_i f_i(x)+\sum_{i=1}^{p} \nu_i h_i(x)\right)
$$

&lt;p&gt;如果 Lagrange 函数关于 $x$ 无下界，则对偶函数取值为 $-\infty$。因为对偶函数是一族关于 $(\lambda, \nu)$ 的仿射函数的逐点下确界，所以即使原问题不是凸的，对偶函数也是凹函数。&lt;/p&gt;
&lt;h2 id=&#34;最优值的下界&#34;&gt;最优值的下界&lt;/h2&gt;
&lt;p&gt;对偶函数构成了原问题最优值 $p^{\star}$ 的下界：即对 $\forall \lambda, \nu \succeq 0$ 有&lt;/p&gt;



$$
g(\lambda, \nu) \leqslant p^{\star}
$$

&lt;h3 id=&#34;几何意义&#34;&gt;几何意义&lt;/h3&gt;
&lt;p&gt;为了便于理解，我们考虑只有一个变量 $x \in \mathbf{R}$ 并且只有一个不等式约束的简单情形。如下图所示：&lt;/p&gt;


















&lt;figure  &gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;&#34; srcset=&#34;
               /media/learn/convex-optimization/duality/5-1-1_hud81269e60a1137d69efa8d08366904ed_85944_a918b4b88d5812cfefc42db04525ca26.webp 400w,
               /media/learn/convex-optimization/duality/5-1-1_hud81269e60a1137d69efa8d08366904ed_85944_5600f80abedde6a9218f84aecab73f2c.webp 760w,
               /media/learn/convex-optimization/duality/5-1-1_hud81269e60a1137d69efa8d08366904ed_85944_1200x1200_fit_q75_h2_lanczos_3.webp 1200w&#34;
               src=&#34;https://bowenei.gitee.io/media/learn/convex-optimization/duality/5-1-1_hud81269e60a1137d69efa8d08366904ed_85944_a918b4b88d5812cfefc42db04525ca26.webp&#34;
               width=&#34;760&#34;
               height=&#34;460&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;/figure&gt;

&lt;p&gt;图中表示的是对偶可行点给出的下界。粗的实线表示目标函数 $f_0$，下方的虚线表示约束函数 $f_1$。可行集是图中两个红点之间的部分所在区间。细的点线表示一系列 Lagrange 函数 $L(x, \lambda)$，其中 $\lambda = \lambda_1, \lambda_2, \lambda_3, \cdots$。该问题的最优点是左边的红点所在位置，可以看到每个 Lagrange 函数的极小值均小于之。&lt;/p&gt;
&lt;h2 id=&#34;通过线性逼近来理解&#34;&gt;通过线性逼近来理解&lt;/h2&gt;
&lt;p&gt;可以通过对集合 ${0}$ 和 $-\mathbf{R}_+$ 的示性函数进行线性逼近来理解 Lagrange 函数和其给出下界的性质。首先将原问题重新描述成一个无约束问题&lt;/p&gt;



$$
\mathrm{minimize} \quad f_0(x) + \sum_{i=1}^m I_-(f_i(x)) + \sum_{i=1}^p I_0(h_i(x))
$$

&lt;p&gt;其中，$I_-: \mathbf{R} \rightarrow \mathbf{R}$ 是非正实数集的示性函数&lt;/p&gt;



$$
I_-(u) = \left\{
    \begin{matrix}
        0 &amp; u \leqslant 0 \\\\
        \infty &amp; u &gt; 0
    \end{matrix}
\right.
$$

&lt;p&gt;类似地，$I_0$ 是集合 ${0}$ 的示性函数。打一个形象的比喻，可以将函数 $I_-(u)$ 理解为我们对约束函数值 $u = f_i(x)$ 的一种恼怒或不满。类似地，$I_0(u)$ 表达了我们对等式约束值 $u = h_i(x)$ 的不满。&lt;/p&gt;
&lt;p&gt;如果我们用线性函数 $\lambda_i(u)$ 替代函数 $I_-(u)$，其中 $\lambda_i \geqslant 0$，用函数 $\nu_i u$ 替代 $I_0(u)$。那么，目标函数就变成了 Lagrange 函数 $L(x, \lambda, \nu)$，且对偶函数值是该问题的最优值。实际上，使用线性函数太“软”，没有示性函数“硬”。用线性函数去逼近示性函数是远远不够的，不过至少可以将线性函数看作是示性函数的一个下估计。&lt;/p&gt;
&lt;p&gt;用“软”约束代替“硬”约束的思想在后文考虑内点法时会再次提到。&lt;/p&gt;
&lt;h2 id=&#34;举例&#34;&gt;举例&lt;/h2&gt;
&lt;h3 id=&#34;线性方程组的最小二乘解&#34;&gt;线性方程组的最小二乘解&lt;/h3&gt;



$$
\begin{aligned}
    \mathrm{minimize} \quad &amp; x^Tx \\\\
    \mathrm{subject\ to} \quad &amp; Ax = b
\end{aligned}
$$

&lt;p&gt;其中 $A \in \mathbf{R}^{p \times n}$，说明这个问题共有 $p$ 个等式约束。其 Lagrange 函数和对偶函数分别为&lt;/p&gt;



$$
\begin{aligned}
    L(x, \nu) &amp;= x^Tx + \nu^T(Ax - b) \\\\
    g(\nu) &amp;= \inf_x L(x, \nu)
\end{aligned}
$$

&lt;p&gt;由于 $L(x, \nu)$ 是关于 $x$ 的二次凸函数，可以通过求解如下最优性条件得到函数的最小值&lt;/p&gt;



$$
\begin{aligned}
    \nabla_x L(x, \nu) = 2x + A^T \nu &amp;= 0 \\\\
    x &amp;= -\frac{1}{2} A^T \nu
\end{aligned}
$$

&lt;p&gt;因此，对偶函数为&lt;/p&gt;



$$
g(\nu) = -\frac{1}{4} \nu^T AA^T \nu - b^T \nu
$$

&lt;p&gt;它是一个二次凹函数，定义域为 $\mathbf{R}^p$。&lt;/p&gt;
&lt;h2 id=&#34;lagrange-对偶函数和共轭函数&#34;&gt;Lagrange 对偶函数和共轭函数&lt;/h2&gt;
&lt;p&gt;共轭函数和 Lagrange 对偶函数紧密相关。下面的问题说明了一个简单的联系。&lt;/p&gt;



$$
\begin{aligned}
    \mathrm{minimize} \quad &amp; f(x) \\\\
    \mathrm{subject\ to} \quad &amp; x = 0
\end{aligned}
$$

&lt;p&gt;虽然这个问题没有什么挑战性，但是我们还是可以很容易地得到 Lagrange 函数为 $L(x, \nu) = f(x) + \nu^T x$，则其对偶函数为&lt;/p&gt;



$$
g(\nu) = \inf_x (f(x) + \nu^T x) = -\sup_x ((-\nu)^Tx - f(x)) = -f^{*}(-\nu)
$$

&lt;p&gt;即，我们得到了结论&lt;/p&gt;



$$
g(\nu) = -f^{*}(-\nu)
$$</description>
    </item>
    
    <item>
      <title>Lagrange 对偶问题</title>
      <link>https://bowenei.gitee.io/learn/convex-optimization/duality/the-lagrange-dual-problem/</link>
      <pubDate>Sun, 03 Apr 2022 13:58:03 +0800</pubDate>
      <guid>https://bowenei.gitee.io/learn/convex-optimization/duality/the-lagrange-dual-problem/</guid>
      <description>&lt;h2 id=&#34;定义&#34;&gt;定义&lt;/h2&gt;
&lt;p&gt;Lagrange 对偶函数实际上给出了优化问题最优值的下界。也就是说，对于一对给定的 $\lambda$ 和 $\nu$，就有一个确定的下界值相对应。那么，一个自然的问题是：Lagrange 对偶函数的最优下界是什么？即如下的一个优化问题&lt;/p&gt;



$$
\begin{aligned}
    \mathrm{maximize} \quad &amp; g(\lambda, \nu) \\\\
    \mathrm{subject\ to} \quad &amp; \lambda \succeq 0
\end{aligned}
$$

&lt;p&gt;该问题被称为 Lagrange 对偶问题。称解 $(\lambda^{\star}, \nu^{\star})$ 为对偶最优解或者最优 Lagrange 乘子。&lt;/p&gt;
&lt;p&gt;Lagrange 对偶问题是一个凸优化问题，这是因为极大化的目标函数是凹函数，且约束集合是凸集。因此，对偶问题的凸性和原问题是否是凸优化问题无关。&lt;/p&gt;
&lt;h2 id=&#34;显式表达对偶约束&#34;&gt;显式表达对偶约束&lt;/h2&gt;
&lt;p&gt;下面我们以标准形式线性规划的 Lagrange 对偶为例，说明如何显式表达对偶约束。&lt;/p&gt;



$$
\begin{aligned}
    \mathrm{minimize} \quad &amp; c^Tx \\\\
    \mathrm{subject\ to} \quad &amp; Ax = b \\\\
    \quad &amp; x \succeq 0
\end{aligned}
$$

&lt;p&gt;其 Lagrange 对偶函数为&lt;/p&gt;



$$
g(\lambda, \nu) = \left\{
    \begin{matrix}
        -b^T \nu &amp; A^T \nu - \lambda + c = 0 \\\\
        -\infty &amp; \text{其他情况}
    \end{matrix}
\right.
$$

&lt;p&gt;严格来讲,标准形式线性规划的对偶问题是在满足约束 $\lambda \succeq 0$ 的条件下极大化对偶函数&lt;/p&gt;



$$
\begin{aligned}
    \mathrm{maximize} \quad &amp; g(\lambda, \nu) \\\\
    \mathrm{subject\ to} \quad &amp; \lambda \succeq 0
\end{aligned}
$$

&lt;p&gt;当且仅当 $A^T \nu - \lambda + c = 0$ 时对偶函数 $g$ 有界。我们看看可以通过将此“隐含”的等式约束“显式”化来得到一个等价的问题&lt;/p&gt;



$$
\begin{aligned}
    \mathrm{maximize} \quad &amp; -b^T \nu \\\\
    \mathrm{subject\ to} \quad &amp; A^T \nu - \lambda + c = 0 \\\\
    \quad &amp; \lambda \succeq 0
\end{aligned}
$$

&lt;p&gt;进一步地，这个问题可以描述为&lt;/p&gt;



$$
\begin{aligned}
    \mathrm{maximize} \quad &amp; -b^T \nu \\\\
    \mathrm{subject\ to} \quad &amp; A^T \nu + c \succeq 0 \\\\
\end{aligned}
$$

&lt;p&gt;这是一个不等式形式的线性规划。&lt;/p&gt;
&lt;h2 id=&#34;弱对偶性&#34;&gt;弱对偶性&lt;/h2&gt;
&lt;p&gt;Lagrange 对偶问题的最优值用 $d^{\star}$ 表示，这是通过 Lagrange 函数得到的原问题最优值 $p^{\star}$ 的最好下界。特别地，我们有下面虽然简单但是非常重要的不等式&lt;/p&gt;



$$
d^{\star} \leqslant p^{\star}
$$

&lt;p&gt;即使原问题不是凸问题，上述表达式亦成立。这个性质称为&lt;strong&gt;弱对偶性&lt;/strong&gt;。&lt;/p&gt;
&lt;p&gt;定义差值 $p^{\star} - d^{\star}$ 是原问题的最优对偶间隙。&lt;/p&gt;
&lt;p&gt;当原问题很难求解时，弱对偶不等式可以给出原问题最优值的一个下界，这是因为对偶问题总是凸问题，而且在很多情况下都可以进行有效的求解得到 $d^{\star}$。&lt;/p&gt;
&lt;h2 id=&#34;强对偶性和-slater-约束准则&#34;&gt;强对偶性和 Slater 约束准则&lt;/h2&gt;
&lt;p&gt;如果对偶间隙为零，即&lt;/p&gt;



$$
p^{\star} = d^{\star}
$$

&lt;p&gt;那么&lt;strong&gt;强对偶性&lt;/strong&gt;成立。这说明从 Lagrange 对偶函数得到的最好下界是紧的。&lt;/p&gt;
&lt;p&gt;如果原问题是凸优化问题，那么强对偶性通常（但不总是）成立。这意味着还需要满足一些额外条件，这些条件被称为约束准则。一个简单的约束准则是 Slater 条件：存在一点 $x \in \operatorname{relint} \mathcal{D}$ 使得&lt;/p&gt;



$$
f_i(x) &lt; 0, \quad i=1,\cdots,m, \quad Ax = b
$$

&lt;p&gt;满足上述条件的点被称为&lt;strong&gt;严格可行&lt;/strong&gt;，这是因为不等式约束严格成立。Slater 定理说明，当 Slater 条件成立（且原问题是凸问题）时，强对偶性成立。&lt;/p&gt;
&lt;h2 id=&#34;举例&#34;&gt;举例&lt;/h2&gt;
&lt;h3 id=&#34;线性方程组的最小二乘解&#34;&gt;线性方程组的最小二乘解&lt;/h3&gt;
&lt;p&gt;再次考虑问题&lt;/p&gt;



$$
\begin{aligned}
    \mathrm{minimize} \quad &amp; x^Tx \\\\
    \mathrm{subject\ to} \quad &amp; Ax = b
\end{aligned}
$$

&lt;p&gt;其相应的对偶问题为&lt;/p&gt;



$$
\mathrm{maximize} \quad -\frac{1}{4} \nu^T AA^T \nu - b^T \nu
$$

&lt;p&gt;它是一个凹二次函数的无约束极大化问题。Slater 条件此时即是原问题的可行性条件。&lt;/p&gt;
&lt;h3 id=&#34;线性规划的-lagrange-对偶&#34;&gt;线性规划的 Lagrange 对偶&lt;/h3&gt;
&lt;p&gt;对于任意线性规划问题，只要原问题可行，强对偶性都成立。&lt;/p&gt;
&lt;h3 id=&#34;二次约束二次规划的-lagrange-对偶&#34;&gt;二次约束二次规划的 Lagrange 对偶&lt;/h3&gt;
&lt;p&gt;考虑 QCQP，根据 Slater 条件，当二次不等式约束严格成立时，则强对偶成立。&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>几何解释</title>
      <link>https://bowenei.gitee.io/learn/convex-optimization/duality/geometric-interpretation/</link>
      <pubDate>Mon, 04 Apr 2022 09:36:14 +0800</pubDate>
      <guid>https://bowenei.gitee.io/learn/convex-optimization/duality/geometric-interpretation/</guid>
      <description>&lt;h2 id=&#34;通过函数值集合理解强弱对偶性&#34;&gt;通过函数值集合理解强弱对偶性&lt;/h2&gt;
&lt;p&gt;可以通过集合&lt;/p&gt;



$$
\begin{aligned}
    \mathcal{G}=\{(f_1(x), &amp;\cdots, f_m(x), \\\\
    h_1(x), &amp;\cdots, h_p(x), f_0(x)) \in \mathbf{R}^m \times \mathbf{R}^p \times \mathbf{R} \mid x \in \mathcal{D}\}
\end{aligned}
$$

&lt;p&gt;给出对偶函数的简单几何解释。事实上，此集合是约束函数和目标函数所取得的函数值。利用集合 $\mathcal{G}$，可以很容易地表达优化问题的最优值 $p^{\star}$。&lt;/p&gt;



$$
p^{\star} = \inf \{ t \mid (u, v, t) \in \mathcal{G}, u \preceq 0, v = 0 \}
$$

&lt;p&gt;求解以 $(\lambda, \nu)$ 为自变量的对偶函数，得到&lt;/p&gt;



$$
g(\lambda, \nu) = \inf \{ (\lambda, \nu, 1)^T(u, v, t) \mid (u, v, t) \in \mathcal{G} \}
$$

&lt;p&gt;如果下确界有界，则不等式&lt;/p&gt;



$$
(\lambda, \nu, 1)^T(u, v, t) \geqslant g(\lambda, \nu)
$$

&lt;p&gt;定义了集合 $\mathcal{G}$ 的一个支撑超平面。&lt;/p&gt;


















&lt;figure  &gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;&#34; srcset=&#34;
               /media/learn/convex-optimization/duality/5-3-1_hub2cda1f81cbc9b1816e8af29902fe725_79615_55c4e22195f22a27b12239561ddae683.webp 400w,
               /media/learn/convex-optimization/duality/5-3-1_hub2cda1f81cbc9b1816e8af29902fe725_79615_7ebcf33a8ab175ab3a210ab8a5178f3d.webp 760w,
               /media/learn/convex-optimization/duality/5-3-1_hub2cda1f81cbc9b1816e8af29902fe725_79615_1200x1200_fit_q75_h2_lanczos_3.webp 1200w&#34;
               src=&#34;https://bowenei.gitee.io/media/learn/convex-optimization/duality/5-3-1_hub2cda1f81cbc9b1816e8af29902fe725_79615_55c4e22195f22a27b12239561ddae683.webp&#34;
               width=&#34;760&#34;
               height=&#34;484&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;/figure&gt;

&lt;p&gt;针对只有一个（不等式）约束的简单问题，对偶函数和下界 $g(\lambda) \leqslant p^{\star}$ 的几何解释如图所示。给定 $\lambda$，在集合 $\mathcal{G} = { (f_1(x), f_0(x)) \mid x \in \mathcal{D} }$ 上极小化 $(\lambda, 1)^T(u, t)$，得到斜率为 $-\lambda$ 的支撑超平面。支撑超平面与坐标轴 $u = 0$ 的交点即为 $g(\lambda)$。&lt;/p&gt;


















&lt;figure  &gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;&#34; srcset=&#34;
               /media/learn/convex-optimization/duality/5-3-2_hu27d5e83b6f97c056047e29d2dcfc6341_116820_e177dc5af954b183568faefd7266f7cd.webp 400w,
               /media/learn/convex-optimization/duality/5-3-2_hu27d5e83b6f97c056047e29d2dcfc6341_116820_d1a65747040090b338668ed578cea1b4.webp 760w,
               /media/learn/convex-optimization/duality/5-3-2_hu27d5e83b6f97c056047e29d2dcfc6341_116820_1200x1200_fit_q75_h2_lanczos_3.webp 1200w&#34;
               src=&#34;https://bowenei.gitee.io/media/learn/convex-optimization/duality/5-3-2_hu27d5e83b6f97c056047e29d2dcfc6341_116820_e177dc5af954b183568faefd7266f7cd.webp&#34;
               width=&#34;760&#34;
               height=&#34;484&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;/figure&gt;

&lt;p&gt;如图所示，对偶可行的三个 $\lambda$ 值对应的支撑超平面，这三个值中包含最优值 $\lambda^{\star}$。强对偶性此时不成立，最优对偶间隙 $p^{\star} - d^{\star} &amp;gt; 0$。&lt;/p&gt;
&lt;h3 id=&#34;上镜图变化&#34;&gt;上镜图变化&lt;/h3&gt;
&lt;p&gt;通过下面的理解，我们就可以解释为什么对（大部分）凸问题，强对偶性总是成立。定义集合 $\mathcal{A} \subseteq \mathbf{R}^m \times \mathbf{R}^p \times \mathbf{R}$ 为&lt;/p&gt;



$$
\begin{aligned}
    \mathcal{A} &amp;= G + \{ \mathbf{R}^M_+ \times \{ 0 \} \times \mathbf{R}_+ \} \\\\
    &amp;= \{ (u, v, t) \mid \exists x \in \mathcal{D}, f_i(x) \leqslant u_i, i=1,\cdots,m, \\\\
    &amp; \qquad h_i(x) = v_i, i=1,\cdots,p, f_0(x) \leqslant t \}
\end{aligned}
$$

&lt;p&gt;我们可以认为 $\mathcal{A}$ 是 $\mathcal{G}$ 的一种上镜图形式，因为 $\mathcal{A}$ 包含了 $\mathcal{G}$ 中的所有点以及一些“较坏”的点，即目标函数值或者不等式约束函数值较大的点。&lt;/p&gt;
&lt;p&gt;可以用 $\mathcal{A}$ 来描述最优值&lt;/p&gt;



$$
p^{\star}=\inf \{t \mid (0,0,t) \in \mathcal{A}\}
$$

&lt;p&gt;同样的，我们可以通过极小化仿射函数得到关于 $(\lambda, \nu)$ 的对偶函数&lt;/p&gt;



$$
g(\lambda, \nu)=\inf \{(\lambda, \nu, 1)^{T}(u, v, t) \mid(u, v, t) \in \mathcal{A}\}
$$

&lt;p&gt;如果确定下确界有界，则&lt;/p&gt;



$$
(\lambda, \nu, 1)^{T}(u, v, t) \geqslant g(\lambda, \nu)
$$

&lt;p&gt;定义了 $\mathcal{A}$ 的一个非竖直的支撑超平面。&lt;/p&gt;
&lt;p&gt;特别地，由于 $(0, 0, p^{\star}) \in \operatorname{bd} \mathcal{A}$，我们有&lt;/p&gt;



$$
p^{\star} = (\lambda, \nu, 1)^T (0, 0, p^{\star}) \geqslant g(\lambda, \nu)
$$

&lt;p&gt;即弱对偶性成立。强对偶性成立，当且仅当存在某些对偶可行变量 $(\lambda, \nu)$，使得上式中的不等号取等号。从几何上看，对于集合 $\mathcal{A}$，存在一个边界点 $(0, 0, p^{\star})$ 处的非竖直的支撑超平面。&lt;/p&gt;


















&lt;figure  &gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;&#34; srcset=&#34;
               /media/learn/convex-optimization/duality/5-3-3_hu52fc544feec137ae5e56a4911ba039da_83554_0385ac8fbe84c49c81e2616224ecd732.webp 400w,
               /media/learn/convex-optimization/duality/5-3-3_hu52fc544feec137ae5e56a4911ba039da_83554_db5e670192d9649e51db9f65554d3e8d.webp 760w,
               /media/learn/convex-optimization/duality/5-3-3_hu52fc544feec137ae5e56a4911ba039da_83554_1200x1200_fit_q75_h2_lanczos_3.webp 1200w&#34;
               src=&#34;https://bowenei.gitee.io/media/learn/convex-optimization/duality/5-3-3_hu52fc544feec137ae5e56a4911ba039da_83554_0385ac8fbe84c49c81e2616224ecd732.webp&#34;
               width=&#34;760&#34;
               height=&#34;484&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;/figure&gt;

&lt;p&gt;针对具有一个（不等式）约束的问题，对偶函数和下界 $g(\lambda) \leqslant p^{\star}$ 的几何解释。给定 $\lambda$，在 $\mathcal{A}$ 上极小化 $(\lambda, 1)^T(u, t)$。这样可以得到斜率为 $-\lambda$ 的支撑超平面。此支撑超平面与坐标轴 $u = 0$ 的交点即为 $(0, g(\lambda))$。&lt;/p&gt;
&lt;h2 id=&#34;在约束规则下强对偶性成立的证明&#34;&gt;在约束规则下强对偶性成立的证明&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;本文从略&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&#34;多准则解释&#34;&gt;多准则解释&lt;/h2&gt;
&lt;p&gt;多准则凸优化问题的每个 Pareto 最优解都是给定某个非负权向量 $\tilde{\lambda}$ 时函数&lt;/p&gt;



$$
\tilde{\lambda}^{T} F(x)=f_{0}(x)+\sum_{i=1}^{m} \lambda_{i} f_{i}(x)
$$

&lt;p&gt;的最小点，我们考虑集合&lt;/p&gt;



$$
\mathcal{A}=\left\{ t \in \mathbf{R}^{m+1} \mid \exists x \in \mathcal{D}, f_{i}(x) \leqslant t_{i}, i=0, \cdots, m \right\}
$$

&lt;p&gt;这和研究 Lagrange 对偶问题时的定义一样，此时所需权向量也是集合在任意一个 Pareto 最优点处的支撑超平面。在多准则优化问题中，权向量的含义是目标函数的相对权重。当我们固定权向量的最后一个分量（和函数 $f_0$ 对应）为 $1$ 时，其他权向量分量的含义是相对 $f_0$ 的成本，即相对于目标函数的成本。&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>鞍点解释</title>
      <link>https://bowenei.gitee.io/learn/convex-optimization/duality/saddle-point-interpretation/</link>
      <pubDate>Mon, 04 Apr 2022 14:56:28 +0800</pubDate>
      <guid>https://bowenei.gitee.io/learn/convex-optimization/duality/saddle-point-interpretation/</guid>
      <description>&lt;blockquote&gt;
&lt;p&gt;本文从略&lt;/p&gt;
&lt;/blockquote&gt;</description>
    </item>
    
    <item>
      <title>最优性条件</title>
      <link>https://bowenei.gitee.io/learn/convex-optimization/duality/optimality-conditions/</link>
      <pubDate>Tue, 05 Apr 2022 11:37:45 +0800</pubDate>
      <guid>https://bowenei.gitee.io/learn/convex-optimization/duality/optimality-conditions/</guid>
      <description>&lt;h2 id=&#34;次优解认证和终止准则&#34;&gt;次优解认证和终止准则&lt;/h2&gt;
&lt;p&gt;如果能够找到一个对偶可行解 $(\lambda, \nu)$，就对原问题的最优值建立了一个下界：$p^{\star} \geqslant g(\lambda, \nu)$。因此，对偶可行点 $(\lambda, \nu)$ 为表达式 $p^{\star} \geqslant g(\lambda, \nu)$ 的成立提供了一个证明或认证。强对偶性意味着存在任意好的认证。&lt;/p&gt;
&lt;p&gt;对偶可行点可以让我们在不知道 $p^{\star}$ 的确切值的情况下界定给定可行点的次优程度。事实上，如果 $x$ 是原问题的可行解且 $(\lambda, \nu)$ 对偶可行，那么&lt;/p&gt;



$$
f(x) - p^{\star} \leqslant f_0(x) - g(\lambda, \nu)
$$

&lt;p&gt;特别地，上式说明了 $x$ 是 $\epsilon$- 次优，其中 $\epsilon = f_0(x) - g(\lambda, \nu)$。&lt;/p&gt;
&lt;p&gt;定义原问题和对偶问题目标函数的差值&lt;/p&gt;



$$
f_0(x) - g(\lambda, \nu)
$$

&lt;p&gt;为原问题可行解 $x$ 和对偶可行解 $(\lambda, \nu)$ 之间的对偶间隙。一对原对偶问题的可行点 $x, (\lambda, \nu)$ 将原问题（对偶问题）的最优值限制在一个区间上：&lt;/p&gt;



$$
p^{\star} \in\left[g(\lambda, \nu), f_0(x)\right], \quad d^{\star} \in\left[g(\lambda, \nu), f_0(x)\right]
$$

&lt;p&gt;区间的长度即为上面定义的对偶间隙。&lt;/p&gt;
&lt;p&gt;如果原对偶可行对 $x, (\lambda, \nu)$ 的对偶间隙为零，即 $f_0(x) = g(\lambda, \nu)$，那么 $x$ 是原问题的最优解且 $(\lambda, \nu)$ 是对偶问题的最优解。此时，我们可以认为 $(\lambda, \nu)$ 是证明 $x$ 为最优解的一个认证。（类似地，也可以认为 $x$ 是证明 $(\lambda, \nu)$ 为最优解的一个认证。）&lt;/p&gt;
&lt;p&gt;上述现象可以用在优化算法中给出非启发式停止准则。即令对偶间隙小于给定精度 $\epsilon_{\mathrm{abs}}$，这能够保证当算法终止的时候，问题的解可以达到 $\epsilon_{\mathrm{abs}}$- 最优。&lt;/p&gt;
&lt;h2 id=&#34;互补松驰性&#34;&gt;互补松驰性&lt;/h2&gt;
&lt;p&gt;设原问题和对偶问题的最优值都可以达到且相等（即强对偶性成立）。令 $x^{\star}$ 是原问题的最优解，$(\lambda^{\star}, \nu^{\star})$，这表明&lt;/p&gt;



$$
\begin{aligned}
f_0\left(x^{\star}\right) &amp;=g\left(\lambda^{\star}, \nu^{\star}\right) \\\\
&amp;=\inf_x \left(f_0(x)+\sum_{i=1}^{m} \lambda_i^{\star} f_i(x)+\sum_{i=1}^{p} \nu_i^{\star} h_i(x)\right) \\\\
&amp; \leqslant f_0\left(x^{\star}\right)+\sum_{i=1}^{m} \lambda_i^{\star} f_i\left(x^{\star}\right)+\sum_{i=1}^{p} \nu_i^{\star} h_i\left(x^{\star}\right) \\\\
&amp; \leqslant f_0\left(x^{\star}\right)
\end{aligned}
$$

&lt;p&gt;第一个等式说明最优对偶间隙为零，第二个等式是对偶函数的定义。第三个不等式是根据 Lagrange 函数关于 $x$ 求下确界小于等于其在 $x = x^{\star}$ 处得到。最后一个不等式成立是因为&lt;/p&gt;



$$
\left\{
    \begin{matrix}
        \lambda_i^{\star} \geqslant 0, &amp; i=1,\cdots,m \\\\
        f_i(x^{\star}) \leqslant 0, &amp; i=1,\cdots,m \\\\
        h_i(x^{\star}) = 0, &amp; i=1,\cdots,p
    \end{matrix}
\right.
$$

&lt;p&gt;因此，在上面的式子链中，两个不等式取等号。&lt;/p&gt;
&lt;p&gt;由此可以得出一些有意义的结论。其中一个特别重要的结论是&lt;/p&gt;



$$
\sum_{i=1}^m \lambda_i^{\star} f_i(x^{\star}) = 0
$$

&lt;p&gt;事实上，求和项的每一项都非正，因此有&lt;/p&gt;



$$
\lambda_i^{\star} f_i(x^{\star}) = 0, \quad i=1,\cdots,m
$$

&lt;p&gt;上述条件称为&lt;strong&gt;互补松弛性&lt;/strong&gt;。它对任意原问题的最优解 $x^{\star}$ 以及对偶问题的最优解 $(\lambda^{\star}, \nu^{\star})$ 都成立（当强对偶性成立时）。我们可以将互补松弛性条件写成&lt;/p&gt;



$$
\lambda_i^{\star} &gt; 0 \Longrightarrow f_i(x^{\star}) = 0
$$

&lt;p&gt;或者等价地&lt;/p&gt;



$$
f_i(x^{\star}) &lt; 0 \Longrightarrow \lambda_i^{\star} = 0
$$

&lt;p&gt;互补松弛性条件说明了在最优点处，除了第 $i$ 个约束起作用的情况，最优 Lagrange 乘子的第 $i$ 项都为零。&lt;/p&gt;
&lt;h2 id=&#34;kkt-最优性条件&#34;&gt;KKT 最优性条件&lt;/h2&gt;
&lt;h3 id=&#34;非凸问题的-kkt-条件&#34;&gt;非凸问题的 KKT 条件&lt;/h3&gt;
&lt;p&gt;由于 $L(x, \lambda^{\star}, \nu^{\star})$ 关于 $x$ 求极小在 $x^{\star}$ 处取得最小值，因此函数在 $x^{\star}$ 处的导数必须为零，即&lt;/p&gt;



$$
\nabla f_{0}\left(x^{\star}\right)+\sum_{i=1}^{m} \lambda_{i}^{\star} \nabla f_{i}\left(x^{\star}\right)+\sum_{i=1}^{p} \nu_{i}^{\star} \nabla h_{i}\left(x^{\star}\right)=0
$$

&lt;p&gt;因此，我们可以得到&lt;/p&gt;



$$
\begin{aligned}
    f_{i}\left(x^{\star}\right) &amp;\leqslant 0, &amp; i &amp;=1, \cdots, m \\\\
    h_{i}\left(x^{\star}\right) &amp;=0, &amp; i &amp;=1, \cdots, p \\\\
    \lambda_{i}^{\star} &amp; \geqslant 0, &amp; i &amp;=1, \cdots, m \\\\
    \lambda_{i}^{\star} f_{i}\left(x^{\star}\right) &amp;=0, &amp; i &amp;=1, \cdots, m \\\\
    \nabla f_{0}\left(x^{\star}\right)+\sum_{i=1}^{m} \lambda_{i}^{\star} \nabla f_{i}\left(x^{\star}\right)+\sum_{i=1}^{p} \nu_{i}^{\star} \nabla h_{i}    \left(x^{\star}\right) &amp;=0 &amp; &amp;
\end{aligned}
$$

&lt;p&gt;我们称上式为 &lt;strong&gt;Karush-Kuhn-Tucker (KKT)&lt;/strong&gt; 条件。&lt;/p&gt;
&lt;p&gt;总之，只要强对偶性成立，那么任何一对原问题的最优解和对偶问题的最优解必须满足 KKT 条件。&lt;/p&gt;
&lt;h3 id=&#34;凸问题的-kkt-条件&#34;&gt;凸问题的 KKT 条件&lt;/h3&gt;



$$
\begin{aligned}
    f_i(\tilde{x}) &amp; \leqslant 0, &amp; i &amp;=1, \cdots, m \\\\
    h_i(\tilde{x}) &amp;=0, &amp; i &amp;=1, \cdots, p \\\\
    \tilde{\lambda}\_i &amp; \geqslant 0, &amp; i &amp;=1, \cdots, m \\\\
    \tilde{\lambda}\_i f_i(\tilde{x}) &amp;=0, &amp; i &amp;=1, \cdots, m \\\\
    \nabla f_0(\tilde{x})+\sum_{i=1}^{m} \tilde{\lambda}\_i \nabla f_i(\tilde{x})+\sum_{i=1}^{p} \tilde{\nu}\_i \nabla h_i(\tilde{x}) &amp;=0, &amp; &amp;
\end{aligned}
$$

&lt;p&gt;从凸问题的 KKT 条件中，我们可以得出结论&lt;/p&gt;



$$
\begin{aligned}
    g(\tilde{\lambda}, \tilde{\nu}) &amp;=L(\tilde{x}, \tilde{\lambda}, \tilde{\nu}) \\\\
    &amp;=f_{0}(\tilde{x})+\sum_{i=1}^{m} \tilde{\lambda}\_{i} f\_{i}(\tilde{x})+\sum_{i=1}^{p} \tilde{\nu}\_{i} h_{i}(\tilde{x}) \\\\
    &amp;=f_{0}(\tilde{x})
\end{aligned}
$$

&lt;p&gt;推导过程的最后一步成立是因为 $h_i(\tilde{x}) = 0$ 以及 $\tilde{\lambda}_i f_i(\tilde{x}) = 0$。这说明原问题的解 $\tilde{x}$ 和对偶问题的解 $(\tilde{\lambda}, \tilde{\nu})$ 之间的对偶间隙为零，因此分别是原、对偶问题的最优解。总之，对目标函数和约束函数可微的任意凸优化问题，任意满足 KKT 条件的点分别是原、对偶问题的最优解，对偶间隙为零。&lt;/p&gt;
&lt;p&gt;KKT 条件在优化领域有着重要作用。在一些特殊的情形下，是可以解析求解 KKT 条件的（因此可以求解优化问题）。更一般地，很多求解凸优化问题的方法可以认为或者理解为求解 KKT 条件的方法。&lt;/p&gt;


&lt;div class=&#34;alert alert-note&#34;&gt;
  &lt;div&gt;
    关于 KKT 条件的深入理解与分析，详见下一小节&lt;a href=&#34;../going-deeper-into-kkt&#34;&gt;深入理解 KKT 条件&lt;/a&gt;。
  &lt;/div&gt;
&lt;/div&gt;</description>
    </item>
    
    <item>
      <title>深入理解 KKT 条件</title>
      <link>https://bowenei.gitee.io/learn/convex-optimization/duality/going-deeper-into-kkt/</link>
      <pubDate>Tue, 05 Apr 2022 15:54:49 +0800</pubDate>
      <guid>https://bowenei.gitee.io/learn/convex-optimization/duality/going-deeper-into-kkt/</guid>
      <description>&lt;div class=&#34;alert alert-note&#34;&gt;
  &lt;div&gt;
    本节将对上一小节&lt;a href=&#34;../optimality-conditions&#34;&gt;最优性条件&lt;/a&gt;中提出的 KKT 条件进行深入的理解和分析。
  &lt;/div&gt;
&lt;/div&gt;

&lt;p&gt;KKT 条件究其本质，是优化问题取得最优解的必要条件。下面我们首先从我们最熟悉的知识开始。&lt;/p&gt;
&lt;h2 id=&#34;等式约束优化问题&#34;&gt;等式约束优化问题&lt;/h2&gt;
&lt;p&gt;我们在《高等数学》课程中学习过多元函数的极值问题，其中提到了 Lagrange 乘子法。其本质就是运用《凸优化》课程当中讲的 Lagrange 函数，求解等式优化问题。只不过《高等数学》课程中不涉及不等式约束，仅仅只有等式约束。为了更贴近也更容易回忆起《高等数学》所学内容，我们在这里仅考虑二元函数，并且只有一个等式约束。此时，这个约束优化问题记为&lt;/p&gt;



$$
\begin{aligned}
    \mathrm{min} \quad &amp; f(x, y) \\\\
    \mathrm{s.t.} \quad &amp; g(x, y) = 0
\end{aligned}
$$

&lt;p&gt;这里只有一个等式约束，因此只需要引入一个 Lagrange 乘子 $\lambda$ 即可&lt;/p&gt;



$$
L(x, y, \lambda) = f(x, y) + \lambda g(x, y)
$$

&lt;p&gt;计算 $L$ 对 $x$、$y$ 和 $\lambda$ 的偏导数，并令它们都等于零，就可以得到最优解的必要条件&lt;/p&gt;



$$
\left\{
    \begin{aligned}
        \frac{\partial L}{\partial x} &amp;= f_x(x, y) + \lambda g_x(x, y) = 0 \\\\
        \frac{\partial L}{\partial y} &amp;= f_y(x, y) + \lambda g_y(x, y) = 0 \\\\
        \frac{\partial L}{\partial \lambda} &amp;= g(x, y) = 0
    \end{aligned}
\right.
$$

&lt;p&gt;解上面的方程组就可以得到最优解 $(x^{\star}, y^{\star})$。&lt;/p&gt;
&lt;h2 id=&#34;不等式约束优化问题&#34;&gt;不等式约束优化问题&lt;/h2&gt;
&lt;p&gt;我们注意到，在刚才在求解的过程中，我们其实一点也不关心 $\lambda$ 的取值，因为那是我们引入的新变量，我们只关心原问题当中 $(x, y)$ 的取值。实际上，按照《高等数学》当中的方法求解出的 $\lambda$ 是无法判断其符号的。对于只含有等式约束的问题，这个问题并不重要。但是，对于含有不等式约束的问题来说，不等号的方向和引入的 Lagrange 乘子之间则是具有一定联系的。&lt;/p&gt;
&lt;p&gt;我们先考虑仅含有一个不等式的约束的二元函数优化问题&lt;/p&gt;



$$
\begin{aligned}
    \mathrm{min} \quad &amp; f(x, y) \\\\
    \mathrm{s.t.} \quad &amp; g(x, y) \leqslant 0
\end{aligned}
$$

&lt;p&gt;我们先来讨论最优解 $(x^{\star}, y^{\star})$ 的情况，它应该有且仅有如下两种：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;$g(x^{\star}, y^{\star}) &amp;lt; 0$，说明最优解位于可行域的内部，称为内部解。此时约束条件是&lt;strong&gt;无效&lt;/strong&gt;的。&lt;/li&gt;
&lt;li&gt;$g(x^{\star}, y^{\star}) = 0$，说明最优解位于可行域的边界，称为边界解。此时约束条件是&lt;strong&gt;有效&lt;/strong&gt;的。&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;这两种情况的最优解具有不同的必要条件：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;内部解：原问题退化为无约束优化问题，只要驻点 $(x^{\star}, y^{\star})$ 满足 $\nabla f=0$ 且 $\lambda = 0$。&lt;/li&gt;
&lt;li&gt;边界解：原问题转变为等式约束优化问题，这与之前讨论的情况相同。可以证明的一点是，最优解处的 $f$ 和 $g$ 的梯度方向是反向，即 $\exists \lambda$ 使得 $\nabla f = - \lambda \nabla g$。这里 $\lambda$ 的正负性是有意义的。由于我们希望最小化 $f$，梯度 $\nabla f$ 的值表示函数值上升最快的方向，因而负梯度方向 $-\nabla f$ 应该指向可行域的内部。$\nabla g$ 指向可行域的外部，即 $g(x, y) &amp;gt; 0$ 的区域，因为约束 $g(x, y) \leqslant 0$。因此这里的 $\lambda \geqslant 0$，这就是之前几节讲的对偶可行性。&lt;/li&gt;
&lt;/ol&gt;


















&lt;figure  &gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;&#34; srcset=&#34;
               /media/learn/convex-optimization/duality/5-5-1_hubbf0e61e6b3fbda1e727b98e7eab9f01_52679_1f15e548591edbfe7d588b7570d3103e.webp 400w,
               /media/learn/convex-optimization/duality/5-5-1_hubbf0e61e6b3fbda1e727b98e7eab9f01_52679_65eda8bec320c866bbcc0ad78251663e.webp 760w,
               /media/learn/convex-optimization/duality/5-5-1_hubbf0e61e6b3fbda1e727b98e7eab9f01_52679_1200x1200_fit_q75_h2_lanczos_3.webp 1200w&#34;
               src=&#34;https://bowenei.gitee.io/media/learn/convex-optimization/duality/5-5-1_hubbf0e61e6b3fbda1e727b98e7eab9f01_52679_1f15e548591edbfe7d588b7570d3103e.webp&#34;
               width=&#34;760&#34;
               height=&#34;760&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;/figure&gt;

&lt;p&gt;边界解的情况可以通过上图加深理解。图中表示的是二元函数 $f(x, y)$ 在不等式约束 $g(x, y) \leqslant 0$ 下的优化问题，并且最优解在边界的情况。如图所示，最优点即为平面 $\pi$（方程 $z = f(x, y)$）和平面 $\sigma$（方程 $g(x, y) = 0$）的交点。约束 $g(x, y) \leqslant 0$ 说明了可行域在平面 $\sigma$ 的下侧。梯度 $\nabla f$ 指向上方，负梯度 $-\nabla f$ 指向下方可行域内部。在最优解 $(x^{\star}, y^{\star})$ 处，$\nabla f$ 和 $\nabla g$ 共线。&lt;/p&gt;
&lt;p&gt;更一般地，如果有多个不等式约束，对应到上图中就是有若干平面 $\sigma_1,\cdots,\sigma_p$，并且在最优点处 $\nabla f(x^{\star}, y^{\star})$ 可由有效约束对应的平面的支撑超平面的法向量的线性表示。即 $\exists \mu_1,\cdots,\mu_p \geqslant 0$，使得&lt;/p&gt;



$$
\nabla f(x^{\star}, y^{\star}) = -(\mu_1 \nabla g_1(x^{\star}, y^{\star}) + \cdots + \mu_p \nabla g_p(x^{\star}, y^{\star}))
$$

&lt;p&gt;而不论是内部解还是边界解，$\lambda g(x, y) = 0$ 恒成立，这就是互补松弛性。&lt;/p&gt;
&lt;h2 id=&#34;小结&#34;&gt;小结&lt;/h2&gt;
&lt;p&gt;回顾了等式约束优化和不等式约束优化之后，我们可以从中提炼出一种转化的思想：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;无约束优化问题：令梯度向量为零即可。&lt;/li&gt;
&lt;li&gt;等式约束优化问题：引入 Lagrange 乘子，将原目标函数转化为 Lagrange 函数，将原问题转化为无约束优化问题。&lt;/li&gt;
&lt;li&gt;不等式约束优化问题：引入松弛变量，将原不等式约束函数转化为等式约束函数，将原问题转化为等式约束优化问题。&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;kkt-条件的本质&#34;&gt;KKT 条件的本质&lt;/h2&gt;
&lt;p&gt;综合上面的讨论与分析，我们再来看看 KKT 条件：&lt;/p&gt;



$$
\begin{aligned}
    f_{i}\left(x^{\star}\right) &amp;\leqslant 0, &amp; i &amp;=1, \cdots, m \\\\
    h_{i}\left(x^{\star}\right) &amp;=0, &amp; i &amp;=1, \cdots, p \\\\
    \lambda_{i}^{\star} &amp; \geqslant 0, &amp; i &amp;=1, \cdots, m \\\\
    \lambda_{i}^{\star} f_{i}\left(x^{\star}\right) &amp;=0, &amp; i &amp;=1, \cdots, m \\\\
    \nabla f_{0}\left(x^{\star}\right)+\sum_{i=1}^{m} \lambda_{i}^{\star} \nabla f_{i}\left(x^{\star}\right)+\sum_{i=1}^{p} \nu_{i}^{\star} \nabla h_{i}    \left(x^{\star}\right) &amp;=0 &amp; &amp;
\end{aligned}
$$

&lt;p&gt;其中一个包含了四个条件，它们分别是：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Lagrange 函数的定常方程式：上式最后一行 $\nabla L = 0$。&lt;/li&gt;
&lt;li&gt;原始可行性：即满足等式约束和不等式约束，上式第一行 $f_{i}\left(x^{\star}\right) \leqslant 0$ 和第二行 $h_{i}\left(x^{\star}\right) =0$。&lt;/li&gt;
&lt;li&gt;对偶可行性：即上式第三行 $\lambda_{i}^{\star} \geqslant 0$。&lt;/li&gt;
&lt;li&gt;互补松弛性：即上式第四行 $\lambda_{i}^{\star} f_{i}\left(x^{\star}\right) =0$。&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;简单的例子&#34;&gt;简单的例子&lt;/h2&gt;
&lt;p&gt;考虑下面的问题&lt;/p&gt;



$$
\begin{aligned}
    \mathrm{min} \quad &amp; x^2 + y^2 \\\\
    \mathrm{s.t.} \quad &amp; x + y = 1 \\\\
    \quad &amp; y \leqslant \alpha
\end{aligned}
$$

&lt;p&gt;写出 Lagrange 函数&lt;/p&gt;



$$
L(x, y, \lambda, \nu) = x^2 + y^2 + \lambda(1 - x - y) + \nu(y - \alpha)
$$

&lt;p&gt;KKT 条件方程组如下&lt;/p&gt;



$$
\left\{\begin{aligned}
    2x - \lambda &amp;= 0 &amp; (1) \\\\
    2y - \lambda + \nu &amp;= 0 &amp; (2) \\\\
    \nu &amp;\geqslant 0 &amp; (3) \\\\
    \nu(y - \alpha) &amp;= 0 &amp; (4)
\end{aligned}\right.
$$

&lt;p&gt;分别由 (1) 式和 (2) 式求出&lt;/p&gt;



$$
\left\{\begin{aligned}
    x &amp;= \frac{1}{2} \lambda &amp; (5) \\\\
    y &amp;= \frac{1}{2} \lambda - \frac{1}{2} \nu &amp; (6)
\end{aligned}\right.
$$

&lt;p&gt;代入等式约束 $x+y=1$，得到 $\lambda$ 和 $\nu$ 的函数关系&lt;/p&gt;



$$
\lambda = \frac{1}{2} \nu + 1
$$

&lt;p&gt;再代入式 (5) 和 (6) 中，消去 $\lambda$&lt;/p&gt;



$$
\left\{\begin{aligned}
    x &amp;= \frac{1}{4} \nu + \frac{1}{2} &amp; (7) \\\\
    y &amp;= -\frac{1}{4} \nu + \frac{1}{2} &amp; (8)
\end{aligned}\right.
$$

&lt;p&gt;最后再加入不等式约束，得到&lt;/p&gt;



$$
\left\{\begin{aligned}
    \nu &amp; \geqslant 2 - 4 \alpha \\\\
    \nu &amp; \geqslant 0
\end{aligned}\right.
$$

&lt;p&gt;下面对参数 $\alpha$ 进行分类讨论：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;若 $\alpha &amp;gt; \frac{1}{2}$，不难验证 $\nu = 0 &amp;gt; 2 - 4 \alpha$。此时满足所有的 KKT 条件，约束不等式是无效的。$x^{\star} = y^{\star} = \frac{1}{2}$ 是内部解。&lt;/li&gt;
&lt;li&gt;若 $\alpha = \frac{1}{2}$，$\nu = 0 = 2 - 4 \alpha$。此时满足所有的 KKT 条件，约束不等式是有效的。$x^{\star} = y^{\star} = \frac{1}{2}$ 是边界解。&lt;/li&gt;
&lt;li&gt;若 $\alpha &amp;lt; \frac{1}{2}$，$\nu = 2 - 4 \alpha &amp;gt; 0$。此时约束不等式是有效的。$x^{\star} = 1 - \alpha$，$y^{\star} = \alpha$。&lt;/li&gt;
&lt;/ol&gt;


















&lt;figure  &gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;&#34; srcset=&#34;
               /media/learn/convex-optimization/duality/5-5-2_hu280ce75c2f830aeaea4f221af7328dde_66452_5a8bad3471d1643808b701727bb6d78a.webp 400w,
               /media/learn/convex-optimization/duality/5-5-2_hu280ce75c2f830aeaea4f221af7328dde_66452_f41f85ae2e9345242fddfde3e46cbb78.webp 760w,
               /media/learn/convex-optimization/duality/5-5-2_hu280ce75c2f830aeaea4f221af7328dde_66452_1200x1200_fit_q75_h2_lanczos_3.webp 1200w&#34;
               src=&#34;https://bowenei.gitee.io/media/learn/convex-optimization/duality/5-5-2_hu280ce75c2f830aeaea4f221af7328dde_66452_5a8bad3471d1643808b701727bb6d78a.webp&#34;
               width=&#34;760&#34;
               height=&#34;720&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;/figure&gt;

&lt;p&gt;本题的几何意义如图所示。目标函数对应的曲面 $\Gamma$ 是（椭）圆抛物面，等式约束对应平面 $\pi$，不等式约束对应以平面 $\sigma$ 为边界的左半空间。曲面 $\Gamma$ 和平面 $\pi$ 的交线为图中的红色曲线（该曲线实际上是一个抛物线）。不考虑不等式约束，该优化问题的最优解为 $(x^{\star}, y^{\star}) = (\frac{1}{2}, \frac{1}{2})$，最优值为 $f(x^{\star}, y^{\star}) = \frac{1}{2}$，对应图中红点的坐标 $(\frac{1}{2}, \frac{1}{2}, \frac{1}{2})$。不等式约束实际上是让平面 $\alpha$ 沿 $y$ 轴方向平移，以 $\alpha = \frac{1}{2}$ 为界，可以分三种情况讨论。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;参考&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://zhuanlan.zhihu.com/p/38163970&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Karush-Kuhn-Tucker (KKT) 条件&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://zhuanlan.zhihu.com/p/26514613&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;浅谈最优化问题的KKT条件&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</description>
    </item>
    
    <item>
      <title>扰动和灵敏度分析</title>
      <link>https://bowenei.gitee.io/learn/convex-optimization/duality/perturbation-and-sensitivity-analysis/</link>
      <pubDate>Wed, 06 Apr 2022 09:53:04 +0800</pubDate>
      <guid>https://bowenei.gitee.io/learn/convex-optimization/duality/perturbation-and-sensitivity-analysis/</guid>
      <description>&lt;h2 id=&#34;扰动问题&#34;&gt;扰动问题&lt;/h2&gt;
&lt;p&gt;考虑下面的问题&lt;/p&gt;



$$
\begin{aligned}
    \mathrm{minimize} \quad &amp; f_0(x) \\\\
    \mathrm{subject\ to} \quad &amp; f_i(x) \leqslant u_i, \quad i=1,\cdots,m \\\\
    \quad &amp; h_i(x) = v_i, \quad i=1,\cdots,p
\end{aligned}
$$

&lt;p&gt;当 $u=0, v=0$ 时，该问题与原始的优化问题一致。而当 $u_i &amp;gt; 0$ 时，意味着第 $i$ 个不等式约束放松了；当 $u_i &amp;lt; 0$ 时，意味着第 $i$ 个不等式约束收紧了。这就是&lt;strong&gt;扰动问题&lt;/strong&gt;，它通过 $u_i$ 放松或收紧每个不等式约束，并且通过 $v_i$ 改变等式约束的右端得到。&lt;/p&gt;
&lt;h2 id=&#34;一个全局不等式&#34;&gt;一个全局不等式&lt;/h2&gt;
&lt;p&gt;假设强对偶性成立且对偶问题最优值可以达到。（当原问题是凸问题且 Slater 条件满足时这种情形将会发生。）设 $(\lambda^{\star}, \nu^{\star})$ 是未被扰动的问题的对偶问题的最优解，则对所有的 $u$ 和 $v$，有&lt;/p&gt;



$$
p^{\star}(u, v) \geqslant p^{\star}(0,0)-\lambda^{\star T} u-\nu^{\star T} v
$$

&lt;h3 id=&#34;灵敏度解释&#34;&gt;灵敏度解释&lt;/h3&gt;
&lt;p&gt;当强对偶性成立时，可以根据上述不等式直接得到很多有关最优 Lagrange 变量的灵敏度解释。有如下结论成立：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;如果 $\lambda_i^{\star}$ 比较大，我们加强第 $i$ 个约束（即选择 $u_i &amp;lt; 0$），则最优值 $p^{\star}(u, v)$ 必会大幅增加。&lt;/li&gt;
&lt;li&gt;如果 $\nu_i^{\star}$ 较大且大于零，我们选择 $v_i &amp;lt; 0$；或者如果 $\nu_i^{\star}$ 较大且小于零，我们选择 $v_i &amp;gt; 0$，在这两种情况下最优值 $p^{\star}(u, v)$ 必会大幅增加。&lt;/li&gt;
&lt;li&gt;如果 $\lambda_i^{\star}$ 较小，我们放松第 $i$ 个约束（$u_i &amp;gt; 0$），那么最优值 $p^{\star}(u, v)$ 不会减小太多。&lt;/li&gt;
&lt;li&gt;如果 $\nu_i^{\star}$ 较小且大于零，$v_i &amp;gt; 0$；或者如果 $\nu_i^{\star}$ 较小且小于零，$v_i &amp;lt; 0$，那么最优值 $p^{\star}(u, v)$ 不会减小太多。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;实际上，上述不等式以及上述结论仅仅只是给出了扰动之后最优值的一个下界，但是没有给出上界。因此，放松或者加强一个约束，上述结论并不对称。&lt;/p&gt;


















&lt;figure  &gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;&#34; srcset=&#34;
               /media/learn/convex-optimization/duality/5-6-1_hub81f9571a74d984984ae6c6e1f4e3f18_23124_c97e12d150231d9a9ffacd797708fde9.webp 400w,
               /media/learn/convex-optimization/duality/5-6-1_hub81f9571a74d984984ae6c6e1f4e3f18_23124_ebc5b24b03d962c8eaab508dbd71cfc3.webp 760w,
               /media/learn/convex-optimization/duality/5-6-1_hub81f9571a74d984984ae6c6e1f4e3f18_23124_1200x1200_fit_q75_h2_lanczos_3.webp 1200w&#34;
               src=&#34;https://bowenei.gitee.io/media/learn/convex-optimization/duality/5-6-1_hub81f9571a74d984984ae6c6e1f4e3f18_23124_c97e12d150231d9a9ffacd797708fde9.webp&#34;
               width=&#34;760&#34;
               height=&#34;401&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;/figure&gt;

&lt;p&gt;上述不等式的几何意义如图所示，这是一个具有一个不等式约束的凸问题。图中蓝色曲线表示具有一个约束 $f_1(x) \leqslant u$ 的凸问题的最优值 $p^{\star}(u)$ 的图像，它是 $u$ 的函数。当 $u = 0$ 时，对应原始未被扰动的问题；当 $u &amp;lt; 0$ 时，约束加强了；当 $u &amp;gt; 0$ 时，约束放松了。仿射函数 $p^{\star}(0) - \lambda^{\star}u$（图中紫色直线）给出了最优值 $p^{\star}$ 的一个下界。从图中可以看到，紫色直线在蓝色曲线的下方，它们相切的切点对应的横坐标就是 $u = 0$，即原始未被扰动的问题。&lt;/p&gt;
&lt;h2 id=&#34;局部灵敏度分析&#34;&gt;局部灵敏度分析&lt;/h2&gt;
&lt;p&gt;假设 $p^{\star}(u, v)$ 在 $u = 0$ 和 $v = 0$ 处可微，并且强对偶性成立，那么最优变量 $\lambda^{\star}, \nu^{\star}$ 可以和 $p^{\star}$ 在 $u = 0$ 和 $v = 0$ 处的梯度联系起来：&lt;/p&gt;



$$
\begin{aligned}
    \lambda_i^{\star} &amp;= -\frac{\partial p^{\star}(0, 0)}{\partial u_i} \\\\
    \nu_i^{\star} &amp;= -\frac{\partial p^{\star}(0, 0)}{\partial v_i}
\end{aligned}
$$

&lt;p&gt;可以从之前的图中看出此性质，因为 $-\lambda$ 是 $p^{\star}$ 在 $u = 0$ 处的斜率。&lt;/p&gt;
&lt;p&gt;因此，若 $p^{\star}(u, v)$ 在 $u = 0$ 和 $v = 0$ 处可微，且强对偶性成立，那么最优 Lagrange 乘子就是最优值关于约束扰动的局部灵敏度。和不可微的情况不同，这种解释的对称的：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;稍稍加强第 $i$ 个不等式约束（即选择一数值较小且小于零的 $u_i$）会使得 $p^{\star}$ 增加大约 $-\lambda_i^{\star}u_i$。&lt;/li&gt;
&lt;li&gt;稍稍放松第 $i$ 个约束（即选择以数值较小且大于零的 $u_i$）会使得 $p^{\star}$ 减小大约 $\lambda_i^{\star}u_i$。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;局部灵敏度结论给出了最优解 $x^{\star}$ 附近的约束起作用的一种定量描述。如果 $f_i(x^{\star}) &amp;lt; 0$，那么此约束不起作用，因此可以稍稍加强约束或者放松约束而不影响最优值。根据互补松弛性，相应的最优 Lagrange 乘子必然为零。考虑 $f_i(x^{\star}) = 0$ 的情况，即第 $i$ 个约束在最优解处起作用。那么，通过最优 Lagrange 乘子的第 $i$ 个分量可以知道此约束起作用的程度：如果 $\lambda_i^{\star}$ 较小，那么我们可以稍稍放松或者加强此约束而对最优值没有大的影响；如果 $\lambda_i^{\star}$ 较大，那么即使稍稍放松或者加强此约束，最优值都会受到很大的影响。&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>等价的对偶问题</title>
      <link>https://bowenei.gitee.io/learn/convex-optimization/duality/equivalent-dual-problems/</link>
      <pubDate>Thu, 07 Apr 2022 09:05:09 +0800</pubDate>
      <guid>https://bowenei.gitee.io/learn/convex-optimization/duality/equivalent-dual-problems/</guid>
      <description>&lt;p&gt;本小节的例子将说明，对一个问题进行简单的等价变形有可能得到非常不一样的对偶问题。&lt;/p&gt;
&lt;h2 id=&#34;引入新的变量以及相应的等式约束&#34;&gt;引入新的变量以及相应的等式约束&lt;/h2&gt;



$$
\mathrm{minimize} \quad f_0(Ax+b)
$$

&lt;p&gt;该问题的 Lagrange 对偶函数是常数 $p^{\star}$。即使强对偶性成立，但其 Lagrange 对偶问题没有什么意义和用途。&lt;/p&gt;
&lt;p&gt;现在我们对原问题作等价变形&lt;/p&gt;



$$
\begin{aligned}
    \mathrm{minimize} \quad &amp; f_0(y) \\\\
    \mathrm{subject\ to} \quad &amp; Ax+b = y
\end{aligned}
$$

&lt;p&gt;我们引入了新的变量 $y$，并且增加了新的等式约束，将原来作为目标函数的复合函数拆开了。这样，变换之后的问题的 Lagrange 函数为&lt;/p&gt;



$$
L(x, y, \nu) = f_0(y) + \nu^T(Ax+b-y)
$$

&lt;p&gt;求解 Lagrange 对偶函数&lt;/p&gt;



$$
g(\nu) = b^T \nu + \inf_y (f_0(y) - \nu^T y) = b^T - f_0^{\star}(\nu)
$$

&lt;p&gt;于是对偶问题可以描述为&lt;/p&gt;



$$
\begin{aligned}
    \mathrm{minimize} \quad &amp; b^T \nu - f_0^{\star}(\nu) \\\\
    \mathrm{subject\ to} \quad &amp; A^T \nu = 0
\end{aligned}
$$

&lt;p&gt;显然，变换后的问题的对偶问题要比原问题的对偶问题更有意义。&lt;/p&gt;
&lt;p&gt;引入新的等式约束的思想同样可以用在约束函数上面。例如，考虑问题&lt;/p&gt;



$$
\begin{aligned}
    \mathrm{minimize} \quad &amp; f_0(A_0x + b_0) \\\\
    \mathrm{subject\ to} \quad &amp; f_i(A_ix+ b_i) \leqslant 0, \quad i=1,\cdots,m
\end{aligned}
$$

&lt;p&gt;其中 $A_i \in \mathbf{R}^{k_i \times n}$，函数 $f_i: \mathbf{R}^{k_i} \rightarrow \mathbf{R}$ 是凸函数。对 $i=0,\cdots,m$，引入新的变量 $y_i \in \mathbf{R}^{k_i}$，将原问题重新描述为&lt;/p&gt;



$$
\begin{aligned}
    \mathrm{minimize} \quad &amp; f_0(y_0) \\\\
    \mathrm{subject\ to} \quad &amp; f_i(y_i) \leqslant 0, \quad i=1,\cdots,m \\\\
    \quad &amp; A_ix + b_i = y_i, i=0,\cdots,m
\end{aligned}
$$

&lt;p&gt;后面的步骤与之前类似，同样也是求解 Lagrange 对偶函数，并描述对偶问题。&lt;/p&gt;
&lt;h2 id=&#34;变换目标函数&#34;&gt;变换目标函数&lt;/h2&gt;
&lt;p&gt;如果我们将目标函数 $f_0$ 替换为 $f_0$ 的增函数，得到的问题与原问题显然是等价的。但是，等价问题的对偶问题可能和原问题的对偶问题大不相同。&lt;/p&gt;
&lt;p&gt;考虑最小范数问题&lt;/p&gt;



$$
\mathrm{minimize} \quad \| Ax-b \|
$$

&lt;p&gt;我们将问题重新描述为&lt;/p&gt;



$$
\begin{aligned}
    \mathrm{minimize} \quad &amp; \frac{1}{2} \| y \|^2 \\\\
    \mathrm{subject\ to} \quad &amp; Ax-b = y
\end{aligned}
$$

&lt;h2 id=&#34;隐式约束&#34;&gt;隐式约束&lt;/h2&gt;
&lt;p&gt;接下来考虑一个简单的重新描述问题的方式，通过修改目标函数将约束包含到目标函数中，当约束被违背时，目标函数为无穷大。&lt;/p&gt;
&lt;p&gt;考虑下列具有框约束的线性规划问题&lt;/p&gt;



$$
\begin{aligned}
    \mathrm{minimize} \quad &amp; c^Tx \\\\
    \mathrm{subject\ to} \quad &amp; Ax=b \\\\
    \quad &amp; l \preceq x \preceq u
\end{aligned}
$$

&lt;p&gt;原问题的对偶问题很容易就能够得到，但是特别复杂。我们换一种做法，将原问题重新描述为&lt;/p&gt;



$$
\begin{aligned}
    \mathrm{minimize} \quad &amp; f_0(x) \\\\
    \mathrm{subject\ to} \quad &amp; Ax = b
\end{aligned}
$$

&lt;p&gt;其中 $f_0(x)$ 定义为&lt;/p&gt;



$$
f_0(x) = \left\{\begin{matrix}
    c^Tx &amp; l \preceq x \preceq u \\\\
    \infty &amp; \text{otherwise}
\end{matrix}\right.
$$

&lt;p&gt;这样一来新问题的对偶问题则是一个更为简单的无约束问题。&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>择一定理</title>
      <link>https://bowenei.gitee.io/learn/convex-optimization/duality/theorems-of-alternatives/</link>
      <pubDate>Fri, 08 Apr 2022 13:50:28 +0800</pubDate>
      <guid>https://bowenei.gitee.io/learn/convex-optimization/duality/theorems-of-alternatives/</guid>
      <description>&lt;h2 id=&#34;通过对偶函数建立弱择一性&#34;&gt;通过对偶函数建立弱择一性&lt;/h2&gt;
&lt;p&gt;对约束系统的定义如下&lt;/p&gt;



$$
\begin{aligned}
    f_i(x) &amp; \leqslant 0, \quad i=1,\cdots,m \\\\
    h_i(x) &amp; = 0, \quad i=1,\cdots,p
\end{aligned}
$$

&lt;p&gt;考虑不等式和等式约束的系统的可行性，即求解如下优化问题&lt;/p&gt;



$$
\begin{aligned}
    \mathrm{minimize} \quad &amp; 0 \\\\
    \mathrm{subject\ to} \quad &amp; f_i(x) \leqslant 0, \quad i=1,\cdots,m \\\\
    \quad &amp; h_i(x) = 0, \quad i=1,\cdots,p
\end{aligned}
$$

&lt;p&gt;此问题的最优值显然只有两种情况：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;$p^{\star} = 0$：约束是可行的。&lt;/li&gt;
&lt;li&gt;$p^{\star} = \infty$：约束是不可行的。&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;对偶函数&#34;&gt;对偶函数&lt;/h3&gt;



$$
g(\lambda, \nu)=\inf_{x \in \mathcal{D}}\left(\sum_{i=1}^{m} \lambda_{i} f_{i}(x)+\sum_{i=1}^{p} \nu_{i} h_{i}(x)\right)
$$

&lt;p&gt;同理，对偶问题的最优值同样也只有两种情况：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;$d^{\star} = \infty$：$\lambda \succeq 0, g(\lambda, \nu) &amp;gt; 0$ 可行。&lt;/li&gt;
&lt;li&gt;$d^{\star} = 0$：$\lambda \succeq 0, g(\lambda, \nu) &amp;gt; 0$ 不可行。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;也就是说，原问题和对偶问题关于约束是否可行的情况正好相反。事实上，可以将不等式&lt;/p&gt;



$$
\begin{aligned}
    \lambda &amp; \succeq 0 \\\\
    g(\lambda, \nu) &amp; &gt; 0
\end{aligned}
$$

&lt;p&gt;看作是系统不可行的证明或认证。&lt;/p&gt;
&lt;p&gt;如果两个不等式（等式）系统至多有一个可行，则称之为&lt;strong&gt;弱择一&lt;/strong&gt;的。无论不等式是否是凸的，上述结论都成立；此外，择一不等式系统总是凸的。&lt;/p&gt;
&lt;h3 id=&#34;严格不等式&#34;&gt;严格不等式&lt;/h3&gt;
&lt;p&gt;同样可以分析具有严格不等式系统的可行性，我们得到择一不等式系统如下&lt;/p&gt;



$$
\begin{aligned}
    \lambda &amp; \succeq 0 \\\\
    \lambda &amp; \ne 0 \\\\
    g(\lambda, \nu) &amp; \geqslant 0
\end{aligned}
$$

&lt;h2 id=&#34;强择一&#34;&gt;强择一&lt;/h2&gt;
&lt;p&gt;当原不等式系统是凸的，即函数 $f_i$ 是凸函数，$h_i$ 是仿射函数，且某些类型的约束准则成立是，那么上述描述的弱择一的两个系统是&lt;strong&gt;强择一&lt;/strong&gt;的，即恰有一个系统可行。换而言之，两个不等式系统中的任意一个可行，当且仅当另一个不可行。&lt;/p&gt;
&lt;p&gt;不等式系统可以描述为&lt;/p&gt;



$$
\begin{aligned}
    f_i(x) &amp; \leqslant 0, \quad i=1,\cdots,m \\\\
    Ax &amp;= b
\end{aligned}
$$

&lt;h3 id=&#34;严格不等式-1&#34;&gt;严格不等式&lt;/h3&gt;
&lt;p&gt;严格不等式系统的强择一还需要满足：存在一点 $x \in \operatorname{relint} \mathcal{D}$ 使得 $Ax=b$。&lt;/p&gt;
&lt;p&gt;我们可以通过考虑相关的优化问题得到上述结论，即&lt;/p&gt;



$$
\begin{aligned}
    \mathrm{minimize} \quad &amp; s \\\\
    \mathrm{subject\ to} \quad &amp; f_i(x) - s \leqslant 0, \quad i=1,\cdots,m \\\\
    \quad &amp; Ax = b
\end{aligned}
$$

&lt;p&gt;优化变量为 $x, s$，定义域为 $\mathcal{D} \times \mathbf{R}$。当且仅当严格不等式系统有解时，上述优化问题的最优值 $p^{\star} &amp;lt; 0$。&lt;/p&gt;
&lt;p&gt;其对偶函数为&lt;/p&gt;



$$
\inf_{x \in \mathcal{D}, s}\left(s+\sum_{i=1}^{m} \lambda_{i}\left(f_{i}(x)-s\right)+\nu^{T}(A x-b)\right)=\left\{\begin{array}{ll}
g(\lambda, \nu) &amp; \mathbf{1}^{T} \lambda=1 \\\\
-\infty &amp; \text {otherwise}
\end{array}\right.
$$

&lt;p&gt;因此其对偶问题可以描述为&lt;/p&gt;



$$
\begin{aligned}
    \mathrm{maximize} \quad &amp; g(\lambda, \nu) \\\\
    \mathrm{subject\ to} \quad &amp; \lambda \succeq 0, \quad \mathbf{1}^T \lambda = 1
\end{aligned}
$$

&lt;p&gt;该问题满足 Slater 条件，即 $d^{\star} = p^{\star}$。&lt;/p&gt;
&lt;h3 id=&#34;非严格不等式&#34;&gt;非严格不等式&lt;/h3&gt;
&lt;p&gt;下面考虑非严格不等式系统&lt;/p&gt;



$$
\begin{aligned}
    f_i(x) &amp; \leqslant 0, \quad i=1,\cdots,m \\\\ 
    Ax &amp;= b
\end{aligned}
$$

&lt;p&gt;以及其择一系统&lt;/p&gt;



$$
\begin{aligned}
    \lambda &amp; \succeq 0 \\\\
    g(\lambda, \nu) &amp; &gt; 0
\end{aligned}
$$

&lt;p&gt;强择一成立的条件和严格不等式系统类似。&lt;/p&gt;
&lt;h2 id=&#34;举例&#34;&gt;举例&lt;/h2&gt;
&lt;h3 id=&#34;线性不等式&#34;&gt;线性不等式&lt;/h3&gt;
&lt;p&gt;考虑具有线性不等式 $Ax \preceq b$ 的系统。它的对偶函数为&lt;/p&gt;



$$
g(\lambda)=\inf _{x} \lambda^{T}(A x-b)=\left\{\begin{array}{ll}
-b^{T} \lambda &amp; A^{T} \lambda=0 \\\\
-\infty &amp; \text {otherwise}
\end{array}\right.
$$

&lt;p&gt;因此，其择一不等式系统为&lt;/p&gt;



$$
\begin{aligned}
    \lambda &amp; \succeq 0 \\\\
    A^T \lambda &amp; = 0 \\\\
    b^T \lambda &amp; &lt; 0
\end{aligned}
$$

&lt;p&gt;这两个系统是强择一的。&lt;/p&gt;
&lt;h3 id=&#34;farkas-引理&#34;&gt;Farkas 引理&lt;/h3&gt;
&lt;p&gt;Farkas 引理描述了一对强择一系统，它们是由严格和非严格线性不等式组成的混合系统。不等式系统&lt;/p&gt;



$$
\begin{aligned}
    Ax &amp; \preceq 0 \\\\
    c^Tx &amp; &lt; 0
\end{aligned}
$$

&lt;p&gt;其中 $A \in \mathbf{R}^{m \times n}, c \in \mathbf{R}^n$，以及不等式系统&lt;/p&gt;



$$
\begin{aligned}
    A^Ty + c &amp;= 0 \\\\
    y &amp; \succeq 0
\end{aligned}
$$

&lt;p&gt;是强择一的。&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>广义不等式</title>
      <link>https://bowenei.gitee.io/learn/convex-optimization/duality/generalized-inequalities/</link>
      <pubDate>Fri, 08 Apr 2022 15:12:16 +0800</pubDate>
      <guid>https://bowenei.gitee.io/learn/convex-optimization/duality/generalized-inequalities/</guid>
      <description>&lt;p&gt;本章讲授的 Lagrange 对偶理论可以推广至具有广义不等式约束的问题中，即&lt;/p&gt;



$$
\begin{aligned}
    \mathrm{minimize} \quad &amp; f_0(x) \\\\
    \mathrm{subject\ to} \quad &amp; f_i(x) \preceq_{K_i} 0, \quad i=1,\cdots,m \\\\
    \quad &amp; h_i(x) = 0, \quad i=1,\cdots,p
\end{aligned}
$$

&lt;p&gt;其中 $K_i \subseteq \mathbf{R}^{k_i}$ 是正常锥。&lt;/p&gt;
&lt;p&gt;Lagrange 对偶理论在具有广义不等式约束问题中的结论和普通的优化问题基本一致，因此本小节不再赘述。&lt;/p&gt;</description>
    </item>
    
  </channel>
</rss>
